‰
tC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\App_Start\BundleConfig.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
{ 
public 

class 
BundleConfig 
{ 
public		 
static		 
void		 
RegisterBundles		 *
(		* +
BundleCollection		+ ;
bundles		< C
)		C D
{

 	
bundles 
. 
Add 
( 
new 
ScriptBundle (
(( )
$str) ;
); <
.< =
Include= D
(D E
$str 7
)7 8
)8 9
;9 :
bundles 
. 
Add 
( 
new 
ScriptBundle (
(( )
$str) >
)> ?
.? @
Include@ G
(G H
$str 4
)4 5
)5 6
;6 7
bundles 
. 
Add 
( 
new 
ScriptBundle (
(( )
$str) >
)> ?
.? @
Include@ G
(G H
$str /
)/ 0
)0 1
;1 2
bundles 
. 
Add 
( 
new 
ScriptBundle (
(( )
$str) >
)> ?
.? @
Include@ G
(G H
$str .
). /
)/ 0
;0 1
bundles 
. 
Add 
( 
new 
StyleBundle '
(' (
$str( 7
)7 8
.8 9
Include9 @
(@ A
$str /
,/ 0
$str *
)* +
)+ ,
;, -
} 	
} 
} Æ
tC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\App_Start\FilterConfig.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
{ 
public 

class 
FilterConfig 
{ 
public 
static 
void !
RegisterGlobalFilters 0
(0 1"
GlobalFilterCollection1 G
filtersH O
)O P
{		 	
filters

 
.

 
Add

 
(

 
new

  
HandleErrorAttribute

 0
(

0 1
)

1 2
)

2 3
;

3 4
} 	
} 
} å	
sC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\App_Start\RouteConfig.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
{		 
public

 

class

 
RouteConfig

 
{ 
public 
static 
void 
RegisterRoutes )
() *
RouteCollection* 9
routes: @
)@ A
{ 	
routes 
. 
IgnoreRoute 
( 
$str ;
); <
;< =
routes 
. 
MapRoute 
( 
name 
: 
$str 
,  
url 
: 
$str 1
,1 2
defaults 
: 
new 
{ 

controller  *
=+ ,
$str- 3
,3 4
action5 ;
=< =
$str> E
,E F
idG I
=J K
UrlParameterL X
.X Y
OptionalY a
}b c
) 
; 
} 	
} 
} ê{
C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\ApelacionesController.cs
	namespace

 	#
Proyecto_Inge_Bases_Web


 !
.

! "
Controllers

" -
{ 
public 

class !
ApelacionesController &
:' (

Controller) 3
{ 
private 
TempPIEntities 
db !
=" #
new$ '
TempPIEntities( 6
(6 7
)7 8
;8 9
public 
ActionResult 
Index !
(! "
)" #
{ 	
string 
correo 
= 
( 
string #
)# $
HttpContext$ /
./ 0
Session0 7
[7 8
$str8 B
]B C
;C D
Administrador 
admin 
=  !
db" $
.$ %
Administradors% 3
.3 4
Find4 8
(8 9
correo9 ?
)? @
;@ A
if 
( 
admin 
== 
null 
) 
{ 
return 
RedirectToAction '
(' (
$str( 7
,7 8
$str9 E
)E F
;F G
} 
var 
	apelacion 
= 
from  
a! "
in# %
db& (
.( )

Apelacions) 3
select "
a# $
;$ %
	apelacion 
= 
	apelacion !
.! "
OrderBy" )
() *
a* +
=>, .
a/ 0
.0 1
FechaApelacion1 ?
)? @
;@ A
return 
View 
( 
	apelacion !
.! "
ToList" (
(( )
)) *
)* +
;+ ,
}   	
["" 	
HttpPost""	 
]"" 
public## 
ActionResult## 
Realizar_Apelacion## .
(##. /
[##/ 0
Bind##0 4
(##4 5
Include##5 <
=##= >
$str##? r
)##r s
]##s t
	Apelacion##u ~
	apelacion	## à
)
##à â
{$$ 	
if%% 
(%% 

ModelState%% 
.%% 
IsValid%% "
)%%" #
{&& 
db'' 
.'' 

Apelacions'' 
.'' 
Add'' !
(''! "
	apelacion''" +
)''+ ,
;'', -
db(( 
.(( 
SaveChanges(( 
((( 
)((  
;((  !
return)) 
RedirectToAction)) '
())' (
$str))( ;
))); <
;))< =
}** 
return,, 
View,, 
(,, 
	apelacion,, !
),,! "
;,," #
}-- 	
public// 
ActionResult// 
Apelacion_Exitosa// -
(//- .
)//. /
{00 	
return11 
View11 
(11 
$str11 +
)11+ ,
;11, -
}22 	
public44 
ActionResult44 
Error_Apelacion44 +
(44+ ,
)44, -
{55 	
return66 
View66 
(66 
$str66 )
)66) *
;66* +
}77 	
public:: 
ActionResult:: 
Realizar_Apelacion:: .
(::. /
string::/ 5
id::6 8
)::8 9
{;; 	
var<< 
id2<< 
=<< 
id<< 
.<< 
ToString<< !
(<<! "
)<<" #
;<<# $

Registrado== 

registrado== !
===" #
db==$ &
.==& '
Registradoes==' 3
.==3 4
Find==4 8
(==8 9
id2==9 <
)==< =
;=== >

Suspension>> 

suspension>> !
=>>" #
db>>$ &
.>>& '
Suspensions>>' 2
.>>2 3
Find>>3 7
(>>7 8
id2>>8 ;
)>>; <
;>>< =
List?? 
<?? 
Denuncia?? 
>?? 
denuncia?? #
=??$ %
new??& )
List??* .
<??. /
Denuncia??/ 7
>??7 8
(??8 9
)??9 :
;??: ;
foreachAA 
(AA 
varAA 
itemAA 
inAA  
dbAA! #
.AA# $
	DenunciasAA$ -
)AA- .
{BB 
ifCC 
(CC 
itemCC 
.CC 

DenunciadoCC #
==CC$ &
id2CC' *
&&CC+ -
itemCC. 2
.CC2 3
TipoCC3 7
>=CC8 :
$numCC; =
)CC= >
{CC? @
denunciaDD 
.DD 
AddDD  
(DD  !
itemDD! %
)DD% &
;DD& '
}EE 
}FF 
DenunciaHH 
	denuncia1HH 
;HH 
ifII 
(II 
denunciaII 
.II 
AnyII 
(II 
)II 
)II 
{JJ 
	denuncia1KK 
=KK 
denunciaKK $
.KK$ %
FirstKK% *
(KK* +
)KK+ ,
;KK, -
}LL 
elseMM 
{NN 
returnOO 
ViewOO 
(OO 
$strOO -
)OO- .
;OO. /
}PP 
	ApelacionRR 

apelacion1RR  
=RR! "
newRR# &
	ApelacionRR' 0
(RR0 1
)RR1 2
;RR2 3
varSS 
	apelacionSS 
=SS 
dbSS 
.SS 

ApelacionsSS )
.SS) *
FindSS* .
(SS. /
id2SS/ 2
)SS2 3
;SS3 4
intTT 
contadorTT 
=TT 
$numTT 
;TT 
foreachVV 
(VV 
varVV 
itemVV 
inVV  
dbVV! #
.VV# $
SuspensionsVV$ /
)VV/ 0
{WW 
ifXX 
(XX 
id2XX 
==XX 
itemXX 
.XX  
CorreoXX  &
)XX& '
{YY 
contadorZZ 
++ZZ 
;ZZ 
}\\ 
}__ 
if`` 
(`` 

registrado`` 
!=`` 
null`` "
&&``# %
	denuncia1``& /
!=``0 2
null``3 7
&&``8 :
contador``; C
!=``D F
$num``G H
&&``I K
	apelacion``L U
==``V X
null``Y ]
)``^ _
{aa 

apelacion1cc 
.cc 
Correocc !
=cc" #
id2cc$ '
;cc' (

apelacion1dd 
.dd 
FechaApelaciondd )
=dd* +
DateTimedd, 4
.dd4 5
Todaydd5 :
;dd: ;

apelacion1ee 
.ee 

Comentarioee %
=ee& '
$stree( +
;ee+ ,

apelacion1ff 
.ff 
FechaDenunciaff (
=ff) *
	denuncia1ff+ 4
.ff4 5
Fechaff5 :
;ff: ;
returngg 
Viewgg 
(gg 

apelacion1gg &
)gg& '
;gg' (
}hh 
elseii 
{jj 
returnkk 
Viewkk 
(kk 
$strkk -
)kk- .
;kk. /
}ll 
}nn 	
[pp 	
HttpPostpp	 
]pp 
publicqq 
ActionResultqq 
	Apelacionqq %
(qq% &
)qq& '
{rr 	
returntt 
Viewtt 
(tt 
)tt 
;tt 
}uu 	
publicww 
ActionResultww 
Aceptar_Apelacionww -
(ww- .
stringww. 4

denunciadoww5 ?
)ww? @
{xx 	

Suspensionyy 

suspensionyy !
=yy" #
dbyy$ &
.yy& '
Suspensionsyy' 2
.yy2 3
Findyy3 7
(yy7 8

denunciadoyy8 B
)yyB C
;yyC D
	Apelacionzz 
	apelacionzz 
=zz  !
dbzz" $
.zz$ %

Apelacionszz% /
.zz/ 0
Findzz0 4
(zz4 5

denunciadozz5 ?
)zz? @
;zz@ A
if{{ 
({{ 
	apelacion{{ 
!={{ 
null{{ !
){{! "
{|| 
Denuncia}} 
denuncia}} !
=}}" #
db}}$ &
.}}& '
	Denuncias}}' 0
.}}0 1
Find}}1 5
(}}5 6
	apelacion}}6 ?
.}}? @
FechaDenuncia}}@ M
)}}M N
;}}N O
if~~ 
(~~ 

suspension~~ 
!=~~ !
null~~" &
&&~~' )
denuncia~~* 2
!=~~3 5
null~~6 :
)~~: ;
{~~< =
db 
. 
Suspensions "
." #
Remove# )
() *

suspension* 4
)4 5
;5 6
db
ÄÄ 
.
ÄÄ 

Apelacions
ÄÄ !
.
ÄÄ! "
Remove
ÄÄ" (
(
ÄÄ( )
	apelacion
ÄÄ) 2
)
ÄÄ2 3
;
ÄÄ3 4
db
ÅÅ 
.
ÅÅ 
	Denuncias
ÅÅ  
.
ÅÅ  !
Remove
ÅÅ! '
(
ÅÅ' (
denuncia
ÅÅ( 0
)
ÅÅ0 1
;
ÅÅ1 2
db
ÇÇ 
.
ÇÇ 
SaveChanges
ÇÇ "
(
ÇÇ" #
)
ÇÇ# $
;
ÇÇ$ %

Registrado
ÑÑ 

registrado
ÑÑ )
=
ÑÑ* +
db
ÑÑ, .
.
ÑÑ. /
Registradoes
ÑÑ/ ;
.
ÑÑ; <
Find
ÑÑ< @
(
ÑÑ@ A

denunciado
ÑÑA K
)
ÑÑK L
;
ÑÑL M
string
ÖÖ 
mensaje
ÖÖ "
=
ÖÖ# $

registrado
ÖÖ% /
.
ÖÖ/ 0
Nombre
ÖÖ0 6
+
ÖÖ7 8
$strÖÖ9 ñ
;ÖÖñ ó
EnviarCorreo
ÜÜ  
(
ÜÜ  !

denunciado
ÜÜ! +
,
ÜÜ+ ,
mensaje
ÜÜ- 4
,
ÜÜ4 5
$str
ÜÜ6 J
)
ÜÜJ K
;
ÜÜK L
}
áá 
}
àà 
return
ãã 
RedirectToAction
ãã #
(
ãã# $
$str
ãã$ +
)
ãã+ ,
;
ãã, -
}
åå 	
public
éé 
ActionResult
éé  
Rechazar_Apelacion
éé .
(
éé. /
string
éé/ 5

denunciado
éé6 @
)
éé@ A
{
èè 	
	Apelacion
êê 
	apelacion
êê 
=
êê  !
db
êê" $
.
êê$ %

Apelacions
êê% /
.
êê/ 0
Find
êê0 4
(
êê4 5

denunciado
êê5 ?
)
êê? @
;
êê@ A
if
ëë 
(
ëë 
	apelacion
ëë 
!=
ëë 
null
ëë !
)
ëë! "
{
íí 
Denuncia
ìì 
denuncia
ìì !
=
ìì" #
db
ìì$ &
.
ìì& '
	Denuncias
ìì' 0
.
ìì0 1
Find
ìì1 5
(
ìì5 6
	apelacion
ìì6 ?
.
ìì? @
FechaDenuncia
ìì@ M
)
ììM N
;
ììN O
if
îî 
(
îî 
denuncia
îî 
!=
îî 
null
îî  $
)
îî$ %
{
îî& '
db
ïï 
.
ïï 

Apelacions
ïï !
.
ïï! "
Remove
ïï" (
(
ïï( )
	apelacion
ïï) 2
)
ïï2 3
;
ïï3 4
db
ññ 
.
ññ 
	Denuncias
ññ  
.
ññ  !
Remove
ññ! '
(
ññ' (
denuncia
ññ( 0
)
ññ0 1
;
ññ1 2
db
óó 
.
óó 
SaveChanges
óó "
(
óó" #
)
óó# $
;
óó$ %

Registrado
ôô 

registrado
ôô )
=
ôô* +
db
ôô, .
.
ôô. /
Registradoes
ôô/ ;
.
ôô; <
Find
ôô< @
(
ôô@ A

denunciado
ôôA K
)
ôôK L
;
ôôL M
string
õõ 
mensaje
õõ "
=
õõ# $

registrado
õõ% /
.
õõ/ 0
Nombre
õõ0 6
+
õõ7 8
$strõõ9 â
;õõâ ä
EnviarCorreo
úú  
(
úú  !

denunciado
úú! +
,
úú+ ,
mensaje
úú- 4
,
úú4 5
$str
úú6 K
)
úúK L
;
úúL M
}
ùù 
}
ûû 
return
°° 
RedirectToAction
°° #
(
°°# $
$str
°°$ +
)
°°+ ,
;
°°, -
}
¢¢ 	
[
•• 	
HttpPost
••	 
]
•• 
public
¶¶ 
void
¶¶ 
EnviarCorreo
¶¶  
(
¶¶  !
string
¶¶! '
correo
¶¶( .
,
¶¶. /
string
¶¶0 6
mensaje
¶¶7 >
,
¶¶> ?
string
¶¶@ F
asunto
¶¶G M
)
¶¶M N
{
ßß 	
var
®® 
fromAddress
®® 
=
®® 
new
®® !
MailAddress
®®" -
(
®®- .
$str
®®. I
,
®®I J
$str
®®K Y
)
®®Y Z
;
®®Z [
var
©© 
	toAddress
©© 
=
©© 
new
©© 
MailAddress
©©  +
(
©©+ ,
correo
©©, 2
,
©©2 3
$str
©©4 F
)
©©F G
;
©©G H
const
™™ 
string
™™ 
fromPassword
™™ %
=
™™& '
$str
™™( 4
;
™™4 5
string
´´ 
subject
´´ 
=
´´ 
asunto
´´ #
;
´´# $
string
¨¨ 
body
¨¨ 
=
¨¨ 
mensaje
¨¨ !
;
¨¨! "
var
ÆÆ 
smtp
ÆÆ 
=
ÆÆ 
new
ÆÆ 

SmtpClient
ÆÆ %
{
ØØ 
Host
∞∞ 
=
∞∞ 
$str
∞∞ '
,
∞∞' (
Port
±± 
=
±± 
$num
±± 
,
±± 
	EnableSsl
≤≤ 
=
≤≤ 
true
≤≤  
,
≤≤  !
DeliveryMethod
≥≥ 
=
≥≥   
SmtpDeliveryMethod
≥≥! 3
.
≥≥3 4
Network
≥≥4 ;
,
≥≥; <
Credentials
¥¥ 
=
¥¥ 
new
¥¥ !
NetworkCredential
¥¥" 3
(
¥¥3 4
fromAddress
¥¥4 ?
.
¥¥? @
Address
¥¥@ G
,
¥¥G H
fromPassword
¥¥I U
)
¥¥U V
,
¥¥V W
Timeout
∂∂ 
=
∂∂ 
$num
∂∂ 
}
∑∑ 
;
∑∑ 
using
∏∏ 
(
∏∏ 
var
∏∏ 
message
∏∏ 
=
∏∏  
new
∏∏! $
MailMessage
∏∏% 0
(
∏∏0 1
fromAddress
∏∏1 <
,
∏∏< =
	toAddress
∏∏> G
)
∏∏G H
{
ππ 
Subject
∫∫ 
=
∫∫ 
subject
∫∫ !
,
∫∫! "
Body
ªª 
=
ªª 
body
ªª 
}
ºº 
)
ºº 
{
ΩΩ 
smtp
ææ 
.
ææ 
Send
ææ 
(
ææ 
message
ææ !
)
ææ! "
;
ææ" #
}
øø 
}
¿¿ 	
public
√√ 
ActionResult
√√ 
DetallesProducto
√√ ,
(
√√, -
int
√√- 0
id
√√1 3
,
√√3 4
string
√√5 ;
correo
√√< B
)
√√B C
{
ƒƒ 	
return
≈≈ 
RedirectToAction
≈≈ #
(
≈≈# $
$str
≈≈$ -
,
≈≈- .
$str
≈≈/ @
,
≈≈@ A
new
≈≈B E
{
≈≈F G
id
≈≈H J
=
≈≈K L
id
≈≈M O
,
≈≈O P
correo
≈≈Q W
=
≈≈X Y
correo
≈≈Z `
}
≈≈a b
)
≈≈b c
;
≈≈c d
}
∆∆ 	
}
…… 
}   ñõ
~C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\CategoriasController.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Controllers" -
{ 
public 

class  
CategoriasController %
:& '

Controller( 2
{ 
private 
TempPIEntities 
db !
=" #
new$ '
TempPIEntities( 6
(6 7
)7 8
;8 9
public 
ActionResult 
Index !
(! "
)" #
{ 	
List 
< 
	Categoria 
> 
ListaCategorias +
=, -
db. 0
.0 1

Categorias1 ;
.; <
ToList< B
(B C
)C D
;D E
string 
correo 
= 
( 
string #
)# $
HttpContext$ /
./ 0
Session0 7
[7 8
$str8 B
]B C
;C D
Administrador 
admin 
=  !
db" $
.$ %
Administradors% 3
.3 4
Find4 8
(8 9
correo9 ?
)? @
;@ A
if 
( 
admin 
== 
null 
) 
{ 
return 
RedirectToAction '
(' (
$str( 7
,7 8
$str9 E
)E F
;F G
} 
return 
View 
( 
ListaCategorias '
)' (
;( )
}   	
public## 
ActionResult## 
Create## "
(##" #
int### &
?##& '
id##( *
)##* +
{$$ 	
string%% 
correo%% 
=%% 
(%% 
string%% #
)%%# $
HttpContext%%$ /
.%%/ 0
Session%%0 7
[%%7 8
$str%%8 B
]%%B C
;%%C D
Administrador&& 
admin&& 
=&&  !
db&&" $
.&&$ %
Administradors&&% 3
.&&3 4
Find&&4 8
(&&8 9
correo&&9 ?
)&&? @
;&&@ A
if(( 
((( 
admin(( 
==(( 
null(( 
)(( 
{)) 
return** 
RedirectToAction** '
(**' (
$str**( 7
,**7 8
$str**9 E
)**E F
;**F G
}++ 
if,, 
(,, 
id,, 
==,, 
null,, 
),, 
{-- 
return.. 
new..  
HttpStatusCodeResult.. /
(../ 0
HttpStatusCode..0 >
...> ?

BadRequest..? I
)..I J
;..J K
}// 
	Categoria00 
	categoria00 
=00  !
db00" $
.00$ %

Categorias00% /
.00/ 0
Find000 4
(004 5
id005 7
)007 8
;008 9
if11 
(11 
	categoria11 
==11 
null11 !
)11! "
{22 
return33 
HttpNotFound33 #
(33# $
)33$ %
;33% &
}44 
	Categoria55 
subcategoria55 "
=55# $
new55% (
	Categoria55) 2
(552 3
)553 4
;554 5
subcategoria66 
.66 #
CorreoUsuarioRegistrado66 0
=661 2
	categoria663 <
.66< =#
CorreoUsuarioRegistrado66= T
;66T U
subcategoria77 
.77 
CategoriaPadreID77 )
=77* +
	categoria77, 5
.775 6
CategoriaID776 A
;77A B
subcategoria88 
.88 
Nombre88 
=88  !
null88" &
;88& '
subcategoria99 
.99 
EsCategoriaFisica99 *
=99+ ,
true99- 1
;991 2
subcategoria:: 
.:: #
CorreoUsuarioRegistrado:: 0
=::1 2
admin::3 8
.::8 9
Correo::9 ?
;::? @
ViewBag<< 
.<< 
CategoriaPadreID<< $
=<<% &
new<<' *

SelectList<<+ 5
(<<5 6
db<<6 8
.<<8 9

Categorias<<9 C
,<<C D
$str<<E R
,<<R S
$str<<T \
,<<\ ]
	categoria<<^ g
.<<g h
CategoriaPadreID<<h x
)<<x y
;<<y z
ViewBag== 
.== #
CorreoUsuarioRegistrado== +
===, -
new==. 1

SelectList==2 <
(==< =
db=== ?
.==? @
Registradoes==@ L
,==L M
$str==N V
,==V W
$str==X `
)==` a
;==a b
ViewBag>> 
.>> 
	CrearPara>> 
=>> 
	categoria>>  )
.>>) *
Nombre>>* 0
;>>0 1
return?? 
View?? 
(?? 
subcategoria?? $
)??$ %
;??% &
}@@ 	
[EE 	
HttpPostEE	 
]EE 
publicGG 
ActionResultGG 
CreateGG "
(GG" #
[GG# $
BindGG$ (
(GG( )
IncludeGG) 0
=GG1 2
$str	GG3 Ç
)
GGÇ É
]
GGÉ Ñ
	Categoria
GGÖ é
	categoria
GGè ò
)
GGò ô
{HH 	
stringII 
correoII 
=II 
(II 
stringII #
)II# $
HttpContextII$ /
.II/ 0
SessionII0 7
[II7 8
$strII8 B
]IIB C
;IIC D
AdministradorJJ 
adminJJ 
=JJ  !
dbJJ" $
.JJ$ %
AdministradorsJJ% 3
.JJ3 4
FindJJ4 8
(JJ8 9
correoJJ9 ?
)JJ? @
;JJ@ A
ifLL 
(LL 
adminLL 
==LL 
nullLL 
)LL 
{MM 
returnNN 
RedirectToActionNN '
(NN' (
$strNN( 7
,NN7 8
$strNN9 E
)NNE F
;NNF G
}OO 
voidPP 
guardarCambiosPP 
(PP  
)PP  !
{QQ 
tryRR 
{SS 
dbTT 
.TT 

CategoriasTT !
.TT! "
AddTT" %
(TT% &
	categoriaTT& /
)TT/ 0
;TT0 1
dbUU 
.UU 
SaveChangesUU "
(UU" #
)UU# $
;UU$ %
}VV 
catchWW 
(WW 
SystemWW 
.WW 
DataWW "
.WW" #
EntityWW# )
.WW) *
InfrastructureWW* 8
.WW8 9
DbUpdateExceptionWW9 J
eWWK L
)WWL M
{XX 
	categoriaYY 
.YY 
CategoriaIDYY )
++YY) +
;YY+ ,
guardarCambiosZZ "
(ZZ" #
)ZZ# $
;ZZ$ %
}\\ 
}]] 
ifaa 
(aa 

ModelStateaa 
.aa 
IsValidaa "
)aa" #
{bb 
ifdd 
(dd 
Regexdd 
.dd 
IsMatchdd !
(dd! "
	categoriadd" +
.dd+ ,
Nombredd, 2
,dd2 3
$strdd4 K
)ddK L
)ddL M
{ee 
guardarCambiosff "
(ff" #
)ff# $
;ff$ %
}gg 
elsehh 
{ii 
TempDatajj 
[jj 
$strjj )
]jj) *
=jj+ ,
$strjj- T
;jjT U
}kk 
returnnn 
RedirectToActionnn '
(nn' (
$strnn( /
)nn/ 0
;nn0 1
}oo 
ViewBagpp 
.pp 
CategoriaPadreIDpp $
=pp% &
newpp' *

SelectListpp+ 5
(pp5 6
dbpp6 8
.pp8 9

Categoriaspp9 C
,ppC D
$strppE R
,ppR S
$strppT \
,pp\ ]
	categoriapp^ g
.ppg h
CategoriaPadreIDpph x
)ppx y
;ppy z
ViewBagqq 
.qq #
CorreoUsuarioRegistradoqq +
=qq, -
newqq. 1

SelectListqq2 <
(qq< =
dbqq= ?
.qq? @
Registradoesqq@ L
,qqL M
$strqqN V
,qqV W
$strqqX `
,qq` a
	categoriaqqb k
.qqk l$
CorreoUsuarioRegistrado	qql É
)
qqÉ Ñ
;
qqÑ Ö
returnrr 
Viewrr 
(rr 
	categoriarr !
)rr! "
;rr" #
}ss 	
publicuu 
ActionResultuu 
Edituu  
(uu  !
intuu! $
?uu$ %
iduu& (
)uu( )
{vv 	
stringww 
correoww 
=ww 
(ww 
stringww #
)ww# $
HttpContextww$ /
.ww/ 0
Sessionww0 7
[ww7 8
$strww8 B
]wwB C
;wwC D
Administradorxx 
adminxx 
=xx  !
dbxx" $
.xx$ %
Administradorsxx% 3
.xx3 4
Findxx4 8
(xx8 9
correoxx9 ?
)xx? @
;xx@ A
ifzz 
(zz 
adminzz 
==zz 
nullzz 
)zz 
{{{ 
return|| 
RedirectToAction|| '
(||' (
$str||( 7
,||7 8
$str||9 E
)||E F
;||F G
}}} 
if~~ 
(~~ 
id~~ 
==~~ 
null~~ 
)~~ 
{ 
return
ÄÄ 
new
ÄÄ "
HttpStatusCodeResult
ÄÄ /
(
ÄÄ/ 0
HttpStatusCode
ÄÄ0 >
.
ÄÄ> ?

BadRequest
ÄÄ? I
)
ÄÄI J
;
ÄÄJ K
}
ÅÅ 
	Categoria
ÇÇ 
	categoria
ÇÇ 
=
ÇÇ  !
db
ÇÇ" $
.
ÇÇ$ %

Categorias
ÇÇ% /
.
ÇÇ/ 0
Find
ÇÇ0 4
(
ÇÇ4 5
id
ÇÇ5 7
)
ÇÇ7 8
;
ÇÇ8 9
if
ÉÉ 
(
ÉÉ 
	categoria
ÉÉ 
==
ÉÉ 
null
ÉÉ !
)
ÉÉ! "
{
ÑÑ 
return
ÖÖ 
HttpNotFound
ÖÖ #
(
ÖÖ# $
)
ÖÖ$ %
;
ÖÖ% &
}
ÜÜ 
ViewBag
áá 
.
áá 
CategoriaPadreID
áá $
=
áá% &
new
áá' *

SelectList
áá+ 5
(
áá5 6
db
áá6 8
.
áá8 9

Categorias
áá9 C
,
ááC D
$str
ááE R
,
ááR S
$str
ááT \
,
áá\ ]
	categoria
áá^ g
.
áág h
CategoriaPadreID
ááh x
)
ááx y
;
ááy z
ViewBag
àà 
.
àà %
CorreoUsuarioRegistrado
àà +
=
àà, -
new
àà. 1

SelectList
àà2 <
(
àà< =
db
àà= ?
.
àà? @
Registradoes
àà@ L
,
ààL M
$str
ààN V
,
ààV W
$str
ààX `
,
àà` a
	categoria
ààb k
.
ààk l&
CorreoUsuarioRegistradoààl É
)ààÉ Ñ
;ààÑ Ö
return
ââ 
View
ââ 
(
ââ 
	categoria
ââ !
)
ââ! "
;
ââ" #
}
ää 	
[
èè 	
HttpPost
èè	 
]
èè 
public
ëë 
ActionResult
ëë 
Edit
ëë  
(
ëë  !
[
ëë! "
Bind
ëë" &
(
ëë& '
Include
ëë' .
=
ëë/ 0
$strëë1 Ä
)ëëÄ Å
]ëëÅ Ç
	CategoriaëëÉ å
	categoriaëëç ñ
)ëëñ ó
{
íí 	
string
ìì 
correo
ìì 
=
ìì 
(
ìì 
string
ìì #
)
ìì# $
HttpContext
ìì$ /
.
ìì/ 0
Session
ìì0 7
[
ìì7 8
$str
ìì8 B
]
ììB C
;
ììC D
Administrador
îî 
admin
îî 
=
îî  !
db
îî" $
.
îî$ %
Administradors
îî% 3
.
îî3 4
Find
îî4 8
(
îî8 9
correo
îî9 ?
)
îî? @
;
îî@ A
if
ññ 
(
ññ 
admin
ññ 
==
ññ 
null
ññ 
)
ññ 
{
óó 
return
òò 
RedirectToAction
òò '
(
òò' (
$str
òò( 7
,
òò7 8
$str
òò9 E
)
òòE F
;
òòF G
}
ôô 
if
öö 
(
öö 

ModelState
öö 
.
öö 
IsValid
öö "
)
öö" #
{
õõ 
db
úú 
.
úú 
Entry
úú 
(
úú 
	categoria
úú "
)
úú" #
.
úú# $
State
úú$ )
=
úú* +
EntityState
úú, 7
.
úú7 8
Modified
úú8 @
;
úú@ A
db
ùù 
.
ùù 
SaveChanges
ùù 
(
ùù 
)
ùù  
;
ùù  !
return
ûû 
RedirectToAction
ûû '
(
ûû' (
$str
ûû( /
)
ûû/ 0
;
ûû0 1
}
üü 
ViewBag
†† 
.
†† 
CategoriaPadreID
†† $
=
††% &
new
††' *

SelectList
††+ 5
(
††5 6
db
††6 8
.
††8 9

Categorias
††9 C
,
††C D
$str
††E R
,
††R S
$str
††T \
,
††\ ]
	categoria
††^ g
.
††g h
CategoriaPadreID
††h x
)
††x y
;
††y z
ViewBag
°° 
.
°° %
CorreoUsuarioRegistrado
°° +
=
°°, -
new
°°. 1

SelectList
°°2 <
(
°°< =
db
°°= ?
.
°°? @
Registradoes
°°@ L
,
°°L M
$str
°°N V
,
°°V W
$str
°°X `
,
°°` a
	categoria
°°b k
.
°°k l&
CorreoUsuarioRegistrado°°l É
)°°É Ñ
;°°Ñ Ö
return
¢¢ 
View
¢¢ 
(
¢¢ 
	categoria
¢¢ !
)
¢¢! "
;
¢¢" #
}
££ 	
public
¶¶ 
ActionResult
¶¶ 
Delete
¶¶ "
(
¶¶" #
int
¶¶# &
?
¶¶& '
id
¶¶( *
)
¶¶* +
{
ßß 	
string
®® 
correo
®® 
=
®® 
(
®® 
string
®® #
)
®®# $
HttpContext
®®$ /
.
®®/ 0
Session
®®0 7
[
®®7 8
$str
®®8 B
]
®®B C
;
®®C D
Administrador
©© 
admin
©© 
=
©©  !
db
©©" $
.
©©$ %
Administradors
©©% 3
.
©©3 4
Find
©©4 8
(
©©8 9
correo
©©9 ?
)
©©? @
;
©©@ A
if
´´ 
(
´´ 
admin
´´ 
==
´´ 
null
´´ 
)
´´ 
{
¨¨ 
return
≠≠ 
RedirectToAction
≠≠ '
(
≠≠' (
$str
≠≠( 7
,
≠≠7 8
$str
≠≠9 E
)
≠≠E F
;
≠≠F G
}
ÆÆ 
if
ØØ 
(
ØØ 
id
ØØ 
==
ØØ 
null
ØØ 
)
ØØ 
{
∞∞ 
return
±± 
new
±± "
HttpStatusCodeResult
±± /
(
±±/ 0
HttpStatusCode
±±0 >
.
±±> ?

BadRequest
±±? I
)
±±I J
;
±±J K
}
≤≤ 
	Categoria
≥≥ 
	categoria
≥≥ 
=
≥≥  !
db
≥≥" $
.
≥≥$ %

Categorias
≥≥% /
.
≥≥/ 0
Find
≥≥0 4
(
≥≥4 5
id
≥≥5 7
)
≥≥7 8
;
≥≥8 9
if
¥¥ 
(
¥¥ 
	categoria
¥¥ 
==
¥¥ 
null
¥¥ !
)
¥¥! "
{
µµ 
return
∂∂ 
HttpNotFound
∂∂ #
(
∂∂# $
)
∂∂$ %
;
∂∂% &
}
∑∑ 
void
ππ 
borrarCategoria
ππ  
(
ππ  !
	Categoria
ππ! *
categoriaABorrar
ππ+ ;
)
ππ; <
{
∫∫ 
var
ªª $
listaCategoriasABorrar
ªª *
=
ªª+ ,
db
ªª- /
.
ªª/ 0

Categorias
ªª0 :
.
ªª: ;
Where
ªª; @
(
ªª@ A
c
ªªA B
=>
ªªC E
c
ªªF G
.
ªªG H
CategoriaPadreID
ªªH X
==
ªªY [
categoriaABorrar
ªª\ l
.
ªªl m
CategoriaID
ªªm x
)
ªªx y
;
ªªy z
db
ºº 
.
ºº 

Categorias
ºº 
.
ºº 
Remove
ºº $
(
ºº$ %
categoriaABorrar
ºº% 5
)
ºº5 6
;
ºº6 7
foreach
ΩΩ 
(
ΩΩ 
var
ΩΩ 
cat
ΩΩ 
in
ΩΩ  "$
listaCategoriasABorrar
ΩΩ# 9
)
ΩΩ9 :
{
ææ 
borrarCategoria
øø #
(
øø# $
cat
øø$ '
)
øø' (
;
øø( )
}
¿¿ 
}
¡¡ 
borrarCategoria
¬¬ 
(
¬¬ 
	categoria
¬¬ %
)
¬¬% &
;
¬¬& '
db
√√ 
.
√√ 
SaveChanges
√√ 
(
√√ 
)
√√ 
;
√√ 
return
ƒƒ 
RedirectToAction
ƒƒ #
(
ƒƒ# $
$str
ƒƒ$ +
)
ƒƒ+ ,
;
ƒƒ, -
}
∆∆ 	
[
…… 	
HttpPost
……	 
,
…… 

ActionName
…… 
(
…… 
$str
…… &
)
……& '
]
……' (
public
ÃÃ 
ActionResult
ÃÃ 
DeleteConfirmed
ÃÃ +
(
ÃÃ+ ,
int
ÃÃ, /
?
ÃÃ/ 0
id
ÃÃ1 3
)
ÃÃ3 4
{
ÕÕ 	
string
ŒŒ 
correo
ŒŒ 
=
ŒŒ 
(
ŒŒ 
string
ŒŒ #
)
ŒŒ# $
HttpContext
ŒŒ$ /
.
ŒŒ/ 0
Session
ŒŒ0 7
[
ŒŒ7 8
$str
ŒŒ8 B
]
ŒŒB C
;
ŒŒC D
Administrador
œœ 
admin
œœ 
=
œœ  !
db
œœ" $
.
œœ$ %
Administradors
œœ% 3
.
œœ3 4
Find
œœ4 8
(
œœ8 9
correo
œœ9 ?
)
œœ? @
;
œœ@ A
if
—— 
(
—— 
admin
—— 
==
—— 
null
—— 
)
—— 
{
““ 
return
”” 
RedirectToAction
”” '
(
””' (
$str
””( 7
,
””7 8
$str
””9 E
)
””E F
;
””F G
}
‘‘ 
	Categoria
’’ 
	categoria
’’ 
=
’’  !
db
’’" $
.
’’$ %

Categorias
’’% /
.
’’/ 0
Find
’’0 4
(
’’4 5
id
’’5 7
)
’’7 8
;
’’8 9
db
‰‰ 
.
‰‰ 

Categorias
‰‰ 
.
‰‰ 
Remove
‰‰  
(
‰‰  !
	categoria
‰‰! *
)
‰‰* +
;
‰‰+ ,
db
ÂÂ 
.
ÂÂ 
SaveChanges
ÂÂ 
(
ÂÂ 
)
ÂÂ 
;
ÂÂ 
return
ÊÊ 
RedirectToAction
ÊÊ #
(
ÊÊ# $
$str
ÊÊ$ +
)
ÊÊ+ ,
;
ÊÊ, -
}
ÈÈ 	
	protected
ÎÎ 
override
ÎÎ 
void
ÎÎ 
Dispose
ÎÎ  '
(
ÎÎ' (
bool
ÎÎ( ,
	disposing
ÎÎ- 6
)
ÎÎ6 7
{
ÏÏ 	
if
ÌÌ 
(
ÌÌ 
	disposing
ÌÌ 
)
ÌÌ 
{
ÓÓ 
db
ÔÔ 
.
ÔÔ 
Dispose
ÔÔ 
(
ÔÔ 
)
ÔÔ 
;
ÔÔ 
}
 
base
ÒÒ 
.
ÒÒ 
Dispose
ÒÒ 
(
ÒÒ 
	disposing
ÒÒ "
)
ÒÒ" #
;
ÒÒ# $
}
ÚÚ 	
}
ÛÛ 
}ÙÙ ÿ˜
{C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\ClienteController.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Controllers" -
{ 
public 

class 
ClienteController "
:# $

Controller% /
{   
private!! 
TempPIEntities!! 
db!! !
=!!" #
new!!$ '
TempPIEntities!!( 6
(!!6 7
)!!7 8
;!!8 9
public$$ 
ActionResult$$ 
Index$$ !
($$! "
)$$" #
{%% 	
var&& 
clientes&& 
=&& 
db&& 
.&& 
Clientes&& &
.&&& '
Include&&' .
(&&. /
c&&/ 0
=>&&1 3
c&&4 5
.&&5 6

Registrado&&6 @
)&&@ A
;&&A B
return'' 
View'' 
('' 
clientes''  
.''  !
ToList''! '
(''' (
)''( )
)'') *
;''* +
}(( 	
public-- 
byte-- 
[-- 
]-- 
ConvertToByte-- #
(--# $
HttpPostedFileBase--$ 6
file2--7 <
)--< =
{.. 	
byte// 
[// 
]// 
	imageByte// 
=// 
null// #
;//# $
BinaryReader00 
rdr00 
=00 
new00 "
BinaryReader00# /
(00/ 0
file2000 5
.005 6
InputStream006 A
)00A B
;00B C
	imageByte11 
=11 
rdr11 
.11 
	ReadBytes11 %
(11% &
(11& '
int11' *
)11* +
file211+ 0
.110 1
ContentLength111 >
)11> ?
;11? @
return22 
	imageByte22 
;22 
}33 	
[66 	
HttpPost66	 
]66 
public77 
ActionResult77 
EdicionPerfil77 )
(77) *
FormCollection77* 8
form779 =
)77= >
{88 	
CultureInfo99 
provider99  
=99! "
CultureInfo99# .
.99. /
InvariantCulture99/ ?
;99? @
string:: 
format:: 
=:: 
$str:: (
;::( )
string;; 
nombre;; 
=;; 
form;;  
[;;  !
$str;;! )
];;) *
.;;* +
ToString;;+ 3
(;;3 4
);;4 5
;;;5 6
string<< 
	apellido1<< 
=<< 
form<< #
[<<# $
$str<<$ /
]<</ 0
.<<0 1
ToString<<1 9
(<<9 :
)<<: ;
;<<; <
string== 
	apellido2== 
=== 
form== #
[==# $
$str==$ /
]==/ 0
.==0 1
ToString==1 9
(==9 :
)==: ;
;==; <
string>> 
edad>> 
=>> 
form>> 
[>> 
$str>> %
]>>% &
.>>& '
ToString>>' /
(>>/ 0
)>>0 1
;>>1 2
string?? 
	direccion?? 
=?? 
form?? #
[??# $
$str??$ /
]??/ 0
.??0 1
ToString??1 9
(??9 :
)??: ;
;??; <
DateTime@@ 
edad2@@ 
=@@ 
DateTime@@ %
.@@% &

ParseExact@@& 0
(@@0 1
edad@@1 5
,@@5 6
format@@7 =
,@@= >
provider@@? G
)@@G H
;@@H I

RegistradoDD 
usuarioDD 
=DD  
dbDD! #
.DD# $
RegistradoesDD$ 0
.DD0 1
FindDD1 5
(DD5 6
HttpContextDD6 A
.DDA B
SessionDDB I
[DDI J
$strDDJ T
]DDT U
)DDU V
;DDV W
ClienteEE 
cliente1EE 
=EE 
dbEE !
.EE! "
ClientesEE" *
.EE* +
FindEE+ /
(EE/ 0
HttpContextEE0 ;
.EE; <
SessionEE< C
[EEC D
$strEED N
]EEN O
)EEO P
;EEP Q
varHH 
cantonHH 
=HH 
formHH 
[HH 
$strHH &
]HH& '
;HH' (
CantonJJ 
canton1JJ 
=JJ 
dbJJ 
.JJ  
CantonsJJ  '
.JJ' (
SingleOrDefaultJJ( 7
(JJ7 8
cantonxJJ8 ?
=>JJ@ B
cantonxJJC J
.JJJ K
NombreJJK Q
==JJR T
cantonJJU [
)JJ[ \
;JJ\ ]
cliente1LL 
.LL 
CantonLL 
=LL 
canton1LL %
.LL% &
idLL& (
;LL( )
HttpPostedFileBaseNN 
fileNN #
=NN$ %
RequestNN& -
.NN- .
FilesNN. 3
[NN3 4
$strNN4 ;
]NN; <
;NN< =
byteOO 
[OO 
]OO 
imagen7OO 
=OO 
ConvertToByteOO *
(OO* +
fileOO+ /
)OO/ 0
;OO0 1
ifPP 
(PP 
imagen7PP 
.PP 
LengthPP 
==PP !
$numPP" #
)PP# $
{QQ 
}QQ 
elseRR 
{SS 
cliente1SS 
.SS 

FotoPerfilSS !
=SS" #
imagen7SS$ +
;SS+ ,
}SS- .
stringUU 
	checkRespUU 
=UU 
formUU #
[UU# $
$strUU$ /
]UU/ 0
;UU0 1
boolVV 

checkRespBVV 
=VV 
ConvertVV %
.VV% &
	ToBooleanVV& /
(VV/ 0
	checkRespVV0 9
)VV9 :
;VV: ;
cliente1WW 
.WW "
BloquearNotificacionesWW +
=WW, -

checkRespBWW. 8
;WW8 9
stringZZ 
[ZZ 
]ZZ 
arrayCategoriasZZ $
=ZZ% &
{ZZ' (
$strZZ) :
,ZZ: ;
$strZZ< G
,ZZG H
$strZZI Z
,ZZZ [
$strZZ\ f
,ZZf g
$strZZh t
,ZZt u
$strZZv }
,ZZ} ~
$str	ZZ ä
,
ZZä ã
$str
ZZå î
,
ZZî ï
$str
ZZñ û
,
ZZû ü
$str
ZZ† ¨
,
ZZ¨ ≠
$str
ZZÆ ¬
,
ZZ¬ √
$str
ZZƒ ⁄
,
ZZ⁄ €
$str
ZZ‹ ‰
,
ZZ‰ Â
$str
ZZÊ Ï
,
ZZÏ Ì
$str
ZZÓ ˜
,
ZZ˜ ¯
$str
ZZ˘ Ç
,
ZZÇ É
$str
ZZÑ å
,
ZZå ç
$str
ZZé ò
,
ZZò ô
$str
ZZö £
,
ZZ£ §
$str
ZZ• Ω
}
ZZæ ø
;
ZZø ¿
cliente1pp 
.pp 
FechaNacimientopp $
=pp% &
edad2pp' ,
;pp, -
cliente1qq 
.qq 
DireccionExactaqq $
=qq% &
	direccionqq' 0
;qq0 1
usuariorr 
.rr 
Nombrerr 
=rr 
nombrerr #
;rr# $
usuarioss 
.ss 
	Apellido1ss 
=ss 
	apellido1ss  )
;ss) *
usuariott 
.tt 
	Apellido2tt 
=tt 
	apellido2tt  )
;tt) *
dbuu 
.uu 
SaveChangesuu 
(uu 
)uu 
;uu 
@Sessionvv 
[vv 
$strvv 
]vv  
=vv! "
nombrevv# )
;vv) *
returnww 
RedirectToActionww #
(ww# $
$strww$ 4
,ww4 5
$strww6 B
)wwB C
;wwC D
}xx 	
publiczz 
ActionResultzz 
EditarPerfilzz (
(zz( )
stringzz) /
ChangeCantonIdzz0 >
)zz> ?
{{{ 	
Cliente|| 
cliente1|| 
=|| 
db|| !
.||! "
Clientes||" *
.||* +
Find||+ /
(||/ 0
HttpContext||0 ;
.||; <
Session||< C
[||C D
$str||D N
]||N O
)||O P
;||P Q

Registrado}} 
registrado2}} "
=}}# $
db}}% '
.}}' (
Registradoes}}( 4
.}}4 5
Find}}5 9
(}}9 :
HttpContext}}: E
.}}E F
Session}}F M
[}}M N
$str}}N X
]}}X Y
)}}Y Z
;}}Z [
if 
( 
cliente1 
. 
Canton 
!=  "
null# '
)' (
{
ÄÄ 
var
ÅÅ 
cantonid
ÅÅ 
=
ÅÅ 
cliente1
ÅÅ '
.
ÅÅ' (
Canton
ÅÅ( .
;
ÅÅ. /
Canton
ÇÇ 
cantonx
ÇÇ 
=
ÇÇ  
db
ÇÇ! #
.
ÇÇ# $
Cantons
ÇÇ$ +
.
ÇÇ+ ,
Find
ÇÇ, 0
(
ÇÇ0 1
cantonid
ÇÇ1 9
)
ÇÇ9 :
;
ÇÇ: ;
var
ÉÉ 
	cantoname
ÉÉ 
=
ÉÉ 
cantonx
ÉÉ  '
.
ÉÉ' (
Nombre
ÉÉ( .
;
ÉÉ. /
var
ÑÑ 
cantonprovincia
ÑÑ #
=
ÑÑ$ %
cantonx
ÑÑ& -
.
ÑÑ- .
NombreProvincia
ÑÑ. =
;
ÑÑ= >
var
ÜÜ 
pais
ÜÜ 
=
ÜÜ 
db
ÜÜ 
.
ÜÜ 
Pais
ÜÜ "
.
ÜÜ" #
Where
ÜÜ# (
(
ÜÜ( )
p
ÜÜ) *
=>
ÜÜ+ -
p
ÜÜ. /
.
ÜÜ/ 0
Nombre
ÜÜ0 6
!=
ÜÜ7 9
null
ÜÜ: >
)
ÜÜ> ?
.
áá 
Select
áá 
(
áá 
i
áá 
=>
áá 
i
áá  
.
áá  !
Nombre
áá! '
)
áá' (
;
áá( )
ViewBag
àà 
.
àà 
Pais
àà 
=
àà 
new
àà "

SelectList
àà# -
(
àà- .
pais
àà. 2
)
àà2 3
;
àà3 4
var
ää 
	provincia
ää 
=
ää 
db
ää  "
.
ää" #

Provincias
ää# -
.
ää- .
Where
ää. 3
(
ää3 4
p
ää4 5
=>
ää6 8
p
ää9 :
.
ää: ;
Nombre
ää; A
==
ääB D
cantonprovincia
ääE T
)
ääT U
.
ääU V
Concat
ääV \
(
ää\ ]
db
ää] _
.
ää_ `

Provincias
ää` j
.
ääj k
Where
ääk p
(
ääp q
p
ääq r
=>
ääs u
p
ääv w
.
ääw x
Nombre
ääx ~
!=ää Å
cantonprovinciaääÇ ë
)ääë í
)ääí ì
.
ãã 
Select
ãã 
(
ãã 
i
ãã 
=>
ãã  
i
ãã! "
.
ãã" #
Nombre
ãã# )
)
ãã) *
;
ãã* +
ViewBag
åå 
.
åå 
	Provincia
åå !
=
åå" #
new
åå$ '

SelectList
åå( 2
(
åå2 3
	provincia
åå3 <
)
åå< =
;
åå= >
var
éé 
canton
éé 
=
éé 
db
éé 
.
éé  
Cantons
éé  '
.
éé' (
Where
éé( -
(
éé- .
p
éé. /
=>
éé0 2
p
éé3 4
.
éé4 5
Nombre
éé5 ;
==
éé< >
	cantoname
éé? H
)
ééH I
.
ééI J
Concat
ééJ P
(
ééP Q
db
ééQ S
.
ééS T
Cantons
ééT [
.
éé[ \
Where
éé\ a
(
ééa b
p
ééb c
=>
ééd f
(
éég h
p
ééh i
.
ééi j
NombreProvincia
ééj y
==
ééz |
cantonprovinciaéé} å
&&ééç è
pééê ë
.ééë í
Nombreééí ò
!=ééô õ
	cantonameééú •
)éé• ¶
)éé¶ ß
)ééß ®
.
èè 
Select
èè 
(
èè 
i
èè 
=>
èè  
i
èè! "
.
èè" #
Nombre
èè# )
)
èè) *
;
èè* +
ViewBag
êê 
.
êê 
Canton
êê 
=
êê  
new
êê! $

SelectList
êê% /
(
êê/ 0
canton
êê0 6
)
êê6 7
;
êê7 8
}
íí 
else
ìì 
{
îî 
var
ïï 
pais
ïï 
=
ïï 
db
ïï 
.
ïï 
Pais
ïï "
.
ïï" #
Where
ïï# (
(
ïï( )
p
ïï) *
=>
ïï+ -
p
ïï. /
.
ïï/ 0
Nombre
ïï0 6
!=
ïï7 9
null
ïï: >
)
ïï> ?
.
ññ 
Select
ññ 
(
ññ 
i
ññ 
=>
ññ 
i
ññ  !
.
ññ! "
Nombre
ññ" (
)
ññ( )
;
ññ) *
ViewBag
óó 
.
óó 
Pais
óó 
=
óó 
new
óó "

SelectList
óó# -
(
óó- .
pais
óó. 2
)
óó2 3
;
óó3 4
var
ôô 
	provincia
ôô 
=
ôô 
db
ôô  "
.
ôô" #

Provincias
ôô# -
.
ôô- .
Where
ôô. 3
(
ôô3 4
p
ôô4 5
=>
ôô6 8
p
ôô9 :
.
ôô: ;
Nombre
ôô; A
!=
ôôB D
null
ôôE I
)
ôôI J
.
öö 
Select
öö 
(
öö 
i
öö 
=>
öö  
i
öö! "
.
öö" #
Nombre
öö# )
)
öö) *
;
öö* +
ViewBag
õõ 
.
õõ 
	Provincia
õõ !
=
õõ" #
new
õõ$ '

SelectList
õõ( 2
(
õõ2 3
	provincia
õõ3 <
)
õõ< =
;
õõ= >
var
ùù 
canton
ùù 
=
ùù 
db
ùù 
.
ùù  
Cantons
ùù  '
.
ùù' (
Where
ùù( -
(
ùù- .
p
ùù. /
=>
ùù0 2
p
ùù3 4
.
ùù4 5
NombreProvincia
ùù5 D
==
ùùE G
$str
ùùH R
)
ùùR S
.
ûû 
Select
ûû 
(
ûû 
i
ûû 
=>
ûû  
i
ûû! "
.
ûû" #
Nombre
ûû# )
)
ûû) *
;
ûû* +
ViewBag
üü 
.
üü 
Canton
üü 
=
üü  
new
üü! $

SelectList
üü% /
(
üü/ 0
canton
üü0 6
)
üü6 7
;
üü7 8
}
°° 
var
££ 
	categoria
££ 
=
££ 
db
££ 
.
££ 

Categorias
££ )
.
££) *
Where
££* /
(
££/ 0
p
££0 1
=>
££2 4
p
££5 6
.
££6 7
CategoriaID
££7 B
!=
££C E
$num
££F G
)
££G H
.
§§ 
Select
§§ 
(
§§ 
i
§§ 
=>
§§ 
i
§§ 
.
§§ 
Nombre
§§ #
)
§§# $
.
•• 
Distinct
•• 
(
•• 
)
•• 
;
•• 
ViewBag
¶¶ 
.
¶¶ 

Categorias
¶¶ 
=
¶¶  
new
¶¶! $

SelectList
¶¶% /
(
¶¶/ 0
	categoria
¶¶0 9
)
¶¶9 :
;
¶¶: ;
if
¨¨ 
(
¨¨ 
cliente1
¨¨ 
.
¨¨ 

FotoPerfil
¨¨ #
==
¨¨$ &
null
¨¨' +
)
¨¨+ ,
{
≠≠ 
byte
ÆÆ 
[
ÆÆ 
]
ÆÆ 
image
ÆÆ 
=
ÆÆ 
new
ÆÆ "
	WebClient
ÆÆ# ,
(
ÆÆ, -
)
ÆÆ- .
.
ÆÆ. /
DownloadData
ÆÆ/ ;
(
ÆÆ; <
$strÆÆ< ù
)ÆÆù û
;ÆÆû ü
var
ØØ 
base64Image
ØØ 
=
ØØ  !
Convert
ØØ" )
.
ØØ) *
ToBase64String
ØØ* 8
(
ØØ8 9
image
ØØ9 >
)
ØØ> ?
;
ØØ? @
TempData
∞∞ 
[
∞∞ 
$str
∞∞ 
]
∞∞ 
=
∞∞  !
base64Image
∞∞" -
;
∞∞- .
}
±± 
else
≤≤ 
{
≥≥ 
var
¥¥ 
base64Image
¥¥ 
=
¥¥  !
Convert
¥¥" )
.
¥¥) *
ToBase64String
¥¥* 8
(
¥¥8 9
cliente1
¥¥9 A
.
¥¥A B

FotoPerfil
¥¥B L
)
¥¥L M
;
¥¥M N
TempData
µµ 
[
µµ 
$str
µµ 
]
µµ 
=
µµ  !
base64Image
µµ" -
;
µµ- .
}
∂∂ 
string
ππ 
[
ππ 
]
ππ 
arrayCategorias
ππ $
=
ππ% &
{
ππ' (
$str
ππ) :
,
ππ: ;
$str
ππ< G
,
ππG H
$str
ππI Z
,
ππZ [
$str
ππ\ f
,
ππf g
$str
ππh t
,
ππt u
$str
ππv }
,
ππ} ~
$strππ ä
,ππä ã
$strππå î
,ππî ï
$strππñ û
,ππû ü
$strππ† ¨
,ππ¨ ≠
$strππÆ ¬
,ππ¬ √
$strππƒ ⁄
,ππ⁄ €
$strππ‹ ‰
,ππ‰ Â
$strππÊ Ï
,ππÏ Ì
$strππÓ ˜
,ππ˜ ¯
$strππ˘ Ç
,ππÇ É
$strππÑ å
,ππå ç
$strππé ò
,ππò ô
$strππö £
,ππ£ §
$strππ• Ω
}ππæ ø
;ππø ¿
string
∫∫ 
[
∫∫ 
]
∫∫ 
arrayTempdatas
∫∫ #
=
∫∫$ %
new
∫∫& )
string
∫∫* 0
[
∫∫0 1
$num
∫∫1 3
]
∫∫3 4
;
∫∫4 5
string
ªª %
nombrecategoriatemporal
ªª *
;
ªª* +
	Categoria
ºº 

categoria1
ºº  
;
ºº  !3
%Relacion_ClienteTieneInteresCategoria
ΩΩ 1
rtemp
ΩΩ2 7
;
ΩΩ7 8
for
ææ 
(
ææ 
int
ææ 
i
ææ 
=
ææ 
$num
ææ 
;
ææ 
i
ææ 
<
ææ 
arrayCategorias
ææ  /
.
ææ/ 0
Length
ææ0 6
;
ææ6 7
i
ææ8 9
++
ææ9 ;
)
ææ; <
{
ææ= >%
nombrecategoriatemporal
øø '
=
øø( )
arrayCategorias
øø* 9
[
øø9 :
i
øø: ;
]
øø; <
;
øø< =

categoria1
¿¿ 
=
¿¿ 
db
¿¿ 
.
¿¿  

Categorias
¿¿  *
.
¿¿* +
SingleOrDefault
¿¿+ :
(
¿¿: ;

categoriax
¿¿; E
=>
¿¿F H

categoriax
¿¿I S
.
¿¿S T
Nombre
¿¿T Z
==
¿¿[ ]%
nombrecategoriatemporal
¿¿^ u
)
¿¿u v
;
¿¿v w
rtemp
¡¡ 
=
¡¡ 
null
¡¡ 
;
¡¡ 
if
√√ 
(
√√ 
rtemp
√√ 
!=
√√ 
null
√√ !
)
√√! "
{
ƒƒ 
arrayTempdatas
≈≈ "
[
≈≈" #
i
≈≈# $
]
≈≈$ %
=
≈≈& '
$str
≈≈( .
;
≈≈. /
}
∆∆ 
else
«« 
{
»» 
arrayTempdatas
…… "
[
……" #
i
……# $
]
……$ %
=
……& '
$str
……( /
;
……/ 0
}
   
}
ÀÀ 
TempData
ÃÃ 
[
ÃÃ 
$str
ÃÃ -
]
ÃÃ- .
=
ÃÃ/ 0
arrayTempdatas
ÃÃ1 ?
[
ÃÃ? @
$num
ÃÃ@ A
]
ÃÃA B
;
ÃÃB C
TempData
ÕÕ 
[
ÕÕ 
$str
ÕÕ '
]
ÕÕ' (
=
ÕÕ) *
arrayTempdatas
ÕÕ+ 9
[
ÕÕ9 :
$num
ÕÕ: ;
]
ÕÕ; <
;
ÕÕ< =
TempData
ŒŒ 
[
ŒŒ 
$str
ŒŒ #
]
ŒŒ# $
=
ŒŒ% &
arrayTempdatas
ŒŒ' 5
[
ŒŒ5 6
$num
ŒŒ6 7
]
ŒŒ7 8
;
ŒŒ8 9
TempData
œœ 
[
œœ 
$str
œœ &
]
œœ& '
=
œœ( )
arrayTempdatas
œœ* 8
[
œœ8 9
$num
œœ9 :
]
œœ: ;
;
œœ; <
TempData
–– 
[
–– 
$str
–– (
]
––( )
=
––* +
arrayTempdatas
––, :
[
––: ;
$num
––; <
]
––< =
;
––= >
TempData
—— 
[
—— 
$str
—— #
]
——# $
=
——% &
arrayTempdatas
——' 5
[
——5 6
$num
——6 7
]
——7 8
;
——8 9
TempData
““ 
[
““ 
$str
““ '
]
““' (
=
““) *
arrayTempdatas
““+ 9
[
““9 :
$num
““: ;
]
““; <
;
““< =
TempData
”” 
[
”” 
$str
”” $
]
””$ %
=
””& '
arrayTempdatas
””( 6
[
””6 7
$num
””7 8
]
””8 9
;
””9 :
TempData
‘‘ 
[
‘‘ 
$str
‘‘ $
]
‘‘$ %
=
‘‘& '
arrayTempdatas
‘‘( 6
[
‘‘6 7
$num
‘‘7 8
]
‘‘8 9
;
‘‘9 :
TempData
’’ 
[
’’ 
$str
’’ (
]
’’( )
=
’’* +
arrayTempdatas
’’, :
[
’’: ;
$num
’’; <
]
’’< =
;
’’= >
TempData
÷÷ 
[
÷÷ 
$str
÷÷ (
]
÷÷( )
=
÷÷* +
arrayTempdatas
÷÷, :
[
÷÷: ;
$num
÷÷; =
]
÷÷= >
;
÷÷> ?
TempData
◊◊ 
[
◊◊ 
$str
◊◊ )
]
◊◊) *
=
◊◊+ ,
arrayTempdatas
◊◊- ;
[
◊◊; <
$num
◊◊< >
]
◊◊> ?
;
◊◊? @
TempData
ÿÿ 
[
ÿÿ 
$str
ÿÿ $
]
ÿÿ$ %
=
ÿÿ& '
arrayTempdatas
ÿÿ( 6
[
ÿÿ6 7
$num
ÿÿ7 9
]
ÿÿ9 :
;
ÿÿ: ;
TempData
ŸŸ 
[
ŸŸ 
$str
ŸŸ "
]
ŸŸ" #
=
ŸŸ$ %
arrayTempdatas
ŸŸ& 4
[
ŸŸ4 5
$num
ŸŸ5 7
]
ŸŸ7 8
;
ŸŸ8 9
TempData
⁄⁄ 
[
⁄⁄ 
$str
⁄⁄ %
]
⁄⁄% &
=
⁄⁄' (
arrayTempdatas
⁄⁄) 7
[
⁄⁄7 8
$num
⁄⁄8 :
]
⁄⁄: ;
;
⁄⁄; <
TempData
€€ 
[
€€ 
$str
€€ %
]
€€% &
=
€€' (
arrayTempdatas
€€) 7
[
€€7 8
$num
€€8 :
]
€€: ;
;
€€; <
TempData
‹‹ 
[
‹‹ 
$str
‹‹ $
]
‹‹$ %
=
‹‹& '
arrayTempdatas
‹‹( 6
[
‹‹6 7
$num
‹‹7 9
]
‹‹9 :
;
‹‹: ;
TempData
›› 
[
›› 
$str
›› &
]
››& '
=
››( )
arrayTempdatas
››* 8
[
››8 9
$num
››9 ;
]
››; <
;
››< =
TempData
ﬁﬁ 
[
ﬁﬁ 
$str
ﬁﬁ %
]
ﬁﬁ% &
=
ﬁﬁ' (
arrayTempdatas
ﬁﬁ) 7
[
ﬁﬁ7 8
$num
ﬁﬁ8 :
]
ﬁﬁ: ;
;
ﬁﬁ; <
TempData
ﬂﬂ 
[
ﬂﬂ 
$str
ﬂﬂ *
]
ﬂﬂ* +
=
ﬂﬂ, -
arrayTempdatas
ﬂﬂ. <
[
ﬂﬂ< =
$num
ﬂﬂ= ?
]
ﬂﬂ? @
;
ﬂﬂ@ A
if
ÂÂ 
(
ÂÂ 
cliente1
ÂÂ 
.
ÂÂ $
BloquearNotificaciones
ÂÂ /
==
ÂÂ0 2
true
ÂÂ3 7
)
ÂÂ7 8
{
ÊÊ 
TempData
ÁÁ 
[
ÁÁ 
$str
ÁÁ "
]
ÁÁ" #
=
ÁÁ$ %
$str
ÁÁ& /
;
ÁÁ/ 0
}
ËË 
else
ÈÈ 
{
ÍÍ 
TempData
ÎÎ 
[
ÎÎ 
$str
ÎÎ "
]
ÎÎ" #
=
ÎÎ$ %
$str
ÎÎ& (
;
ÎÎ( )
}
ÌÌ 
TempData
 
[
 
$str
 $
]
$ %
=
& '
registrado2
( 3
.
3 4
Nombre
4 :
;
: ;
TempData
ÒÒ 
[
ÒÒ 
$str
ÒÒ  
]
ÒÒ  !
=
ÒÒ" #
registrado2
ÒÒ$ /
.
ÒÒ/ 0
	Apellido1
ÒÒ0 9
;
ÒÒ9 :
TempData
ÚÚ 
[
ÚÚ 
$str
ÚÚ  
]
ÚÚ  !
=
ÚÚ" #
registrado2
ÚÚ$ /
.
ÚÚ/ 0
	Apellido2
ÚÚ0 9
;
ÚÚ9 :
TempData
ÛÛ 
[
ÛÛ 
$str
ÛÛ  
]
ÛÛ  !
=
ÛÛ" #
cliente1
ÛÛ$ ,
.
ÛÛ, -
DireccionExacta
ÛÛ- <
;
ÛÛ< =
TempData
ÙÙ 
[
ÙÙ 
$str
ÙÙ %
]
ÙÙ% &
=
ÙÙ' (
cliente1
ÙÙ) 1
.
ÙÙ1 2$
BloquearNotificaciones
ÙÙ2 H
;
ÙÙH I
string
ıı 
edadx
ıı 
=
ıı 
cliente1
ıı #
.
ıı# $
FechaNacimiento
ıı$ 3
.
ıı3 4
ToString
ıı4 <
(
ıı< =
)
ıı= >
;
ıı> ?
if
ˆˆ 
(
ˆˆ 
edadx
ˆˆ 
!=
ˆˆ 
$str
ˆˆ 
)
ˆˆ 
{
˜˜ 
string
¯¯ 
	edadtemp1
¯¯  
=
¯¯! "
$str
¯¯# %
;
¯¯% &
string
˘˘ 
	edadtemp2
˘˘  
=
˘˘! "
$str
˘˘# %
;
˘˘% &
string
˙˙ 
	edadtemp3
˙˙  
=
˙˙! "
$str
˙˙# %
;
˙˙% &
string
˚˚ 
	edadfinal
˚˚  
=
˚˚! "
$str
˚˚# %
;
˚˚% &
int
¸¸ 
x
¸¸ 
=
¸¸ 
edadx
¸¸ 
.
¸¸ 
Length
¸¸ $
;
¸¸$ %
if
˝˝ 
(
˝˝ 
edadx
˝˝ 
.
˝˝ 
Length
˝˝  
==
˝˝! #
$num
˝˝$ &
)
˝˝& '
{
˛˛ 
if
ˇˇ 
(
ˇˇ 
edadx
ˇˇ 
.
ˇˇ 
	Substring
ˇˇ '
(
ˇˇ' (
$num
ˇˇ( )
,
ˇˇ) *
$num
ˇˇ+ ,
)
ˇˇ, -
==
ˇˇ. 0
$str
ˇˇ1 4
)
ˇˇ4 5
{
ÄÄ 
edadx
ÅÅ 
=
ÅÅ 
$str
ÅÅ  #
+
ÅÅ$ %
edadx
ÅÅ& +
;
ÅÅ+ ,
}
ÇÇ 
else
ÉÉ 
{
ÑÑ 
	edadtemp1
ÖÖ !
=
ÖÖ" #
edadx
ÖÖ$ )
.
ÖÖ) *
	Substring
ÖÖ* 3
(
ÖÖ3 4
$num
ÖÖ4 5
,
ÖÖ5 6
$num
ÖÖ7 8
)
ÖÖ8 9
;
ÖÖ9 :
	edadtemp2
ÜÜ !
=
ÜÜ" #
edadx
ÜÜ$ )
.
ÜÜ) *
	Substring
ÜÜ* 3
(
ÜÜ3 4
$num
ÜÜ4 5
,
ÜÜ5 6
$num
ÜÜ7 8
)
ÜÜ8 9
;
ÜÜ9 :
	edadtemp2
áá !
=
áá" #
$str
áá$ '
+
áá( )
	edadtemp2
áá* 3
;
áá3 4
	edadtemp3
àà !
=
àà" #
edadx
àà$ )
.
àà) *
	Substring
àà* 3
(
àà3 4
$num
àà4 5
,
àà5 6
edadx
àà7 <
.
àà< =
Length
àà= C
-
ààD E
$num
ààF G
)
ààG H
;
ààH I
edadx
ââ 
=
ââ 
	edadtemp1
ââ  )
+
ââ* +
$str
ââ, /
+
ââ0 1
	edadtemp2
ââ2 ;
+
ââ< =
	edadtemp3
ââ> G
;
ââG H
}
ää 
}
ãã 
else
åå 
if
åå 
(
åå 
edadx
åå 
.
åå 
Length
åå %
==
åå& (
$num
åå) +
)
åå+ ,
{
çç 
edadx
éé 
=
éé 
$str
éé 
+
éé  !
edadx
éé" '
;
éé' (
	edadtemp1
èè 
=
èè 
edadx
èè  %
.
èè% &
	Substring
èè& /
(
èè/ 0
$num
èè0 1
,
èè1 2
$num
èè3 4
)
èè4 5
;
èè5 6
	edadtemp2
êê 
=
êê 
edadx
êê  %
.
êê% &
	Substring
êê& /
(
êê/ 0
$num
êê0 1
,
êê1 2
$num
êê3 4
)
êê4 5
;
êê5 6
	edadtemp2
ëë 
=
ëë 
$str
ëë  #
+
ëë$ %
	edadtemp2
ëë& /
;
ëë/ 0
	edadtemp3
íí 
=
íí 
edadx
íí  %
.
íí% &
	Substring
íí& /
(
íí/ 0
$num
íí0 1
,
íí1 2
edadx
íí3 8
.
íí8 9
Length
íí9 ?
-
íí@ A
$num
ííB C
)
ííC D
;
ííD E
edadx
ìì 
=
ìì 
	edadtemp1
ìì %
+
ìì& '
$str
ìì( +
+
ìì, -
	edadtemp2
ìì. 7
+
ìì8 9
	edadtemp3
ìì: C
;
ììC D
}
îî 
	edadtemp1
ïï 
=
ïï 
edadx
ïï !
.
ïï! "
	Substring
ïï" +
(
ïï+ ,
$num
ïï, -
,
ïï- .
$num
ïï/ 0
)
ïï0 1
;
ïï1 2
	edadtemp2
ññ 
=
ññ 
edadx
ññ !
.
ññ! "
	Substring
ññ" +
(
ññ+ ,
$num
ññ, -
,
ññ- .
$num
ññ/ 0
)
ññ0 1
;
ññ1 2
	edadtemp3
óó 
=
óó 
edadx
óó !
.
óó! "
	Substring
óó" +
(
óó+ ,
$num
óó, -
,
óó- .
edadx
óó/ 4
.
óó4 5
Length
óó5 ;
-
óó< =
$num
óó> ?
)
óó? @
;
óó@ A
	edadfinal
òò 
=
òò 
	edadtemp2
òò %
+
òò& '
$str
òò( +
+
òò, -
	edadtemp1
òò. 7
+
òò8 9
	edadtemp3
òò: C
;
òòC D
TempData
öö 
[
öö 
$str
öö 
]
öö  
=
öö! "
	edadfinal
öö# ,
;
öö, -
return
õõ 
View
õõ 
(
õõ 
)
õõ 
;
õõ 
}
úú 
else
ùù 
{
ûû 
TempData
üü 
[
üü 
$str
üü 
]
üü  
=
üü! "
$str
üü# /
;
üü/ 0
return
†† 
View
†† 
(
†† 
)
†† 
;
†† 
}
°° 
}
¢¢ 	
public
§§ 
ActionResult
§§ 
GetProvincia
§§ (
(
§§( )
string
§§) /

nombrePais
§§0 :
)
§§: ;
{
•• 	
var
¶¶ 
	provincia
¶¶ 
=
¶¶ 
db
¶¶ 
.
¶¶ 

Provincias
¶¶ )
.
¶¶) *
Where
¶¶* /
(
¶¶/ 0
p
¶¶0 1
=>
¶¶2 4
p
¶¶5 6
.
¶¶6 7

NombrePais
¶¶7 A
==
¶¶B D

nombrePais
¶¶E O
.
¶¶O P
Trim
¶¶P T
(
¶¶T U
)
¶¶U V
)
¶¶V W
.
ßß 
Select
ßß 
(
ßß 
i
ßß 
=>
ßß 
i
ßß 
.
ßß 
Nombre
ßß !
)
ßß! "
;
ßß" #
List
®® 
<
®® 
SelectListItem
®® 
>
®®  
items
®®! &
=
®®' (
new
®®) ,
List
®®- 1
<
®®1 2
SelectListItem
®®2 @
>
®®@ A
(
®®A B
)
®®B C
;
®®C D
foreach
©© 
(
©© 
string
©© 
pr
©© 
in
©© !
	provincia
©©" +
)
©©+ ,
{
™™ 
items
´´ 
.
´´ 
Add
´´ 
(
´´ 
new
´´ 
SelectListItem
´´ ,
(
´´, -
)
´´- .
{
´´/ 0
Text
´´1 5
=
´´6 7
pr
´´8 :
,
´´: ;
Value
´´< A
=
´´B C
pr
´´D F
}
´´G H
)
´´H I
;
´´I J
}
¨¨ 
return
≠≠ 
Json
≠≠ 
(
≠≠ 
items
≠≠ 
,
≠≠ !
JsonRequestBehavior
≠≠ 2
.
≠≠2 3
AllowGet
≠≠3 ;
)
≠≠; <
;
≠≠< =
}
ÆÆ 	
public
∞∞ 
ActionResult
∞∞ 
	GetCanton
∞∞ %
(
∞∞% &
string
∞∞& ,
nombreProvincia
∞∞- <
)
∞∞< =
{
±± 	
var
≤≤ 
canton
≤≤ 
=
≤≤ 
db
≤≤ 
.
≤≤ 
Cantons
≤≤ #
.
≤≤# $
Where
≤≤$ )
(
≤≤) *
p
≤≤* +
=>
≤≤, .
p
≤≤/ 0
.
≤≤0 1
NombreProvincia
≤≤1 @
==
≤≤A C
nombreProvincia
≤≤D S
.
≤≤S T
Trim
≤≤T X
(
≤≤X Y
)
≤≤Y Z
)
≤≤Z [
.
≥≥ 
Select
≥≥ 
(
≥≥ 
i
≥≥ 
=>
≥≥ 
i
≥≥ 
.
≥≥ 
Nombre
≥≥ !
)
≥≥! "
;
≥≥" #
List
¥¥ 
<
¥¥ 
SelectListItem
¥¥ 
>
¥¥  
items
¥¥! &
=
¥¥' (
new
¥¥) ,
List
¥¥- 1
<
¥¥1 2
SelectListItem
¥¥2 @
>
¥¥@ A
(
¥¥A B
)
¥¥B C
;
¥¥C D
Console
µµ 
.
µµ 
	WriteLine
µµ 
(
µµ 
canton
µµ $
)
µµ$ %
;
µµ% &
Console
∂∂ 
.
∂∂ 
	WriteLine
∂∂ 
(
∂∂ 
nombreProvincia
∂∂ -
)
∂∂- .
;
∂∂. /
foreach
∏∏ 
(
∏∏ 
string
∏∏ 
c
∏∏ 
in
∏∏  
canton
∏∏! '
)
∏∏' (
{
ππ 
Console
∫∫ 
.
∫∫ 
	WriteLine
∫∫ !
(
∫∫! "
c
∫∫" #
)
∫∫# $
;
∫∫$ %
items
ªª 
.
ªª 
Add
ªª 
(
ªª 
new
ªª 
SelectListItem
ªª ,
(
ªª, -
)
ªª- .
{
ªª/ 0
Text
ªª1 5
=
ªª6 7
c
ªª8 9
,
ªª9 :
Value
ªª; @
=
ªªA B
c
ªªC D
}
ªªE F
)
ªªF G
;
ªªG H
}
ºº 
return
ΩΩ 
Json
ΩΩ 
(
ΩΩ 
items
ΩΩ 
,
ΩΩ !
JsonRequestBehavior
ΩΩ 2
.
ΩΩ2 3
AllowGet
ΩΩ3 ;
)
ΩΩ; <
;
ΩΩ< =
}
ææ 	
public
¡¡ 
ActionResult
¡¡ '
EditarPerfilRegistrandose
¡¡ 5
(
¡¡5 6
)
¡¡6 7
{
¬¬ 	

Registrado
ƒƒ 
usuario
ƒƒ 
=
ƒƒ  
db
ƒƒ! #
.
ƒƒ# $
Registradoes
ƒƒ$ 0
.
ƒƒ0 1
Find
ƒƒ1 5
(
ƒƒ5 6
HttpContext
ƒƒ6 A
.
ƒƒA B
Session
ƒƒB I
[
ƒƒI J
$str
ƒƒJ U
]
ƒƒU V
)
ƒƒV W
;
ƒƒW X
usuario
≈≈ 
.
≈≈ 
EstadoCuenta
≈≈  
=
≈≈! "
true
≈≈# '
;
≈≈' (
db
∆∆ 
.
∆∆ 
SaveChanges
∆∆ 
(
∆∆ 
)
∆∆ 
;
∆∆ 
return
»» 
RedirectToAction
»» #
(
»»# $
$str
»»$ 3
,
»»3 4
$str
»»5 A
)
»»A B
;
»»B C
}
…… 	
public
   
ActionResult
   
PerfilCliente
   )
(
  ) *
int
  * -
?
  - .
page
  / 3
)
  3 4
{
ÀÀ 	
var
ÃÃ 
correoU
ÃÃ 
=
ÃÃ 
HttpContext
ÃÃ %
.
ÃÃ% &
Session
ÃÃ& -
[
ÃÃ- .
$str
ÃÃ. 8
]
ÃÃ8 9
;
ÃÃ9 :
string
ÕÕ 

correoUser
ÕÕ 
=
ÕÕ 
correoU
ÕÕ  '
.
ÕÕ' (
ToString
ÕÕ( 0
(
ÕÕ0 1
)
ÕÕ1 2
;
ÕÕ2 3
List
œœ 
<
œœ 
VistaMisProducto
œœ !
>
œœ! "
misProductos
œœ# /
=
œœ0 1
new
œœ2 5
List
œœ6 :
<
œœ: ;
VistaMisProducto
œœ; K
>
œœK L
(
œœL M
)
œœM N
;
œœN O
misProductos
–– 
=
–– 
db
–– 
.
–– 
VistaMisProductos
–– /
.
––/ 0
Where
––0 5
(
––5 6
c
––6 7
=>
––8 :
c
––; <
.
––< =
CorreoCliente
––= J
==
––K M

correoUser
––N X
)
––X Y
.
––Y Z
ToList
––Z `
(
––` a
)
––a b
;
––b c
var
““ 
	productos
““ 
=
““ 
from
““  
a
““! "
in
““# %
misProductos
““& 2
from
””  
p
””! "
in
””# %
db
””& (
.
””( )%
Productos_Info_Clientes
””) @
where
‘‘ !
p
‘‘" #
.
‘‘# $

ProductoID
‘‘$ .
==
‘‘/ 1
a
‘‘2 3
.
‘‘3 4

ProductoID
‘‘4 >
select
’’ "
p
’’# $
;
’’$ %
	productos
÷÷ 
=
÷÷ 
	productos
÷÷ !
.
÷÷! "
OrderBy
÷÷" )
(
÷÷) *
p
÷÷* +
=>
÷÷, .
p
÷÷/ 0
.
÷÷0 1
Nombre
÷÷1 7
)
÷÷7 8
;
÷÷8 9
int
⁄⁄ 
pageSize
⁄⁄ 
=
⁄⁄ 
$num
⁄⁄ 
;
⁄⁄ 
int
€€ 

pageNumber
€€ 
=
€€ 
(
€€ 
page
€€ "
??
€€# %
$num
€€& '
)
€€' (
;
€€( )
string
ﬁﬁ 
correo
ﬁﬁ 
=
ﬁﬁ 
(
ﬁﬁ 
string
ﬁﬁ #
)
ﬁﬁ# $
HttpContext
ﬁﬁ$ /
.
ﬁﬁ/ 0
Session
ﬁﬁ0 7
[
ﬁﬁ7 8
$str
ﬁﬁ8 B
]
ﬁﬁB C
;
ﬁﬁC D
Administrador
ﬂﬂ 
admin
ﬂﬂ 
=
ﬂﬂ  !
db
ﬂﬂ" $
.
ﬂﬂ$ %
Administradors
ﬂﬂ% 3
.
ﬂﬂ3 4
Find
ﬂﬂ4 8
(
ﬂﬂ8 9
correo
ﬂﬂ9 ?
)
ﬂﬂ? @
;
ﬂﬂ@ A
var
‡‡ 
view
‡‡ 
=
‡‡ 
View
‡‡ 
(
‡‡ 
	productos
‡‡ %
.
‡‡% &
ToPagedList
‡‡& 1
(
‡‡1 2

pageNumber
‡‡2 <
,
‡‡< =
pageSize
‡‡> F
)
‡‡F G
)
‡‡G H
;
‡‡H I
if
‚‚ 
(
‚‚ 
admin
‚‚ 
==
‚‚ 
null
‚‚ 
)
‚‚ 
{
„„ 
Cliente
‰‰ 
cliente
‰‰ 
=
‰‰  !
db
‰‰" $
.
‰‰$ %
Clientes
‰‰% -
.
‰‰- .
Find
‰‰. 2
(
‰‰2 3
correo
‰‰3 9
)
‰‰9 :
;
‰‰: ;
if
ÂÂ 
(
ÂÂ 
cliente
ÂÂ 
==
ÂÂ 
null
ÂÂ #
)
ÂÂ# $
{
ÊÊ 
return
ÁÁ 
view
ÁÁ 
;
ÁÁ  
}
ËË 
view
ÈÈ 
.
ÈÈ 

MasterName
ÈÈ 
=
ÈÈ  !
$str
ÈÈ" H
;
ÈÈH I
return
ÍÍ 
view
ÍÍ 
;
ÍÍ 
}
ÎÎ 
else
ÏÏ 
{
ÌÌ 
view
ÓÓ 
.
ÓÓ 

MasterName
ÓÓ 
=
ÓÓ  !
$str
ÓÓ" N
;
ÓÓN O
return
ÔÔ 
view
ÔÔ 
;
ÔÔ 
}
 
}
ÒÒ 	
public
ˆˆ 
ActionResult
ˆˆ 
ListaAmigos
ˆˆ '
(
ˆˆ' (
)
ˆˆ( )
{
˜˜ 	
var
˘˘ 
correoU
˘˘ 
=
˘˘ 
HttpContext
˘˘ %
.
˘˘% &
Session
˘˘& -
[
˘˘- .
$str
˘˘. 8
]
˘˘8 9
;
˘˘9 :
string
˙˙ 

correoUser
˙˙ 
=
˙˙ 
correoU
˙˙  '
.
˙˙' (
ToString
˙˙( 0
(
˙˙0 1
)
˙˙1 2
;
˙˙2 3
List
˚˚ 
<
˚˚ 

VistaAmigo
˚˚ 
>
˚˚ 
lista_A
˚˚ $
=
˚˚% &
db
˚˚' )
.
˚˚) *
VistaAmigos
˚˚* 5
.
˚˚5 6
Where
˚˚6 ;
(
˚˚; <
c
˚˚< =
=>
˚˚> @
c
˚˚A B
.
˚˚B C
CorreoDueno
˚˚C N
==
˚˚O Q

correoUser
˚˚R \
)
˚˚\ ]
.
˚˚] ^
ToList
˚˚^ d
(
˚˚d e
)
˚˚e f
;
˚˚f g
List
¸¸ 
<
¸¸ 
VistaNoAmigo
¸¸ 
>
¸¸ 
lista_B
¸¸ &
=
¸¸' (
db
¸¸) +
.
¸¸+ ,
VistaNoAmigoes
¸¸, :
.
¸¸: ;
Where
¸¸; @
(
¸¸@ A
c
¸¸A B
=>
¸¸C E
c
¸¸F G
.
¸¸G H
dueno
¸¸H M
==
¸¸N P

correoUser
¸¸Q [
)
¸¸[ \
.
¸¸\ ]
Distinct
¸¸] e
(
¸¸e f
)
¸¸f g
.
¸¸g h
ToList
¸¸h n
(
¸¸n o
)
¸¸o p
;
¸¸p q
ViewBag
˝˝ 
.
˝˝ 
Amigos
˝˝ 
=
˝˝ 
lista_A
˝˝ $
;
˝˝$ %
ViewBag
˛˛ 
.
˛˛ 
NoAmigos
˛˛ 
=
˛˛ 
lista_B
˛˛ &
;
˛˛& '
MostrarListas
ˇˇ 
listas
ˇˇ  
=
ˇˇ! "
new
ˇˇ# &
MostrarListas
ˇˇ' 4
(
ˇˇ4 5
)
ˇˇ5 6
;
ˇˇ6 7
listas
ÄÄ 
.
ÄÄ 
Amigos
ÄÄ 
=
ÄÄ 
lista_A
ÄÄ #
;
ÄÄ# $
listas
ÅÅ 
.
ÅÅ 
NoAmigos
ÅÅ 
=
ÅÅ 
lista_B
ÅÅ %
;
ÅÅ% &
return
ÑÑ 
View
ÑÑ 
(
ÑÑ 
listas
ÑÑ 
)
ÑÑ 
;
ÑÑ  
}
ÖÖ 	
public
ââ 
ActionResult
ââ 
EliminarAmigos
ââ *
(
ââ* +
string
ââ+ 1
correo
ââ2 8
)
ââ8 9
{
ââ: ;
var
ãã 
correoU
ãã 
=
ãã 
HttpContext
ãã %
.
ãã% &
Session
ãã& -
[
ãã- .
$str
ãã. 8
]
ãã8 9
;
ãã9 :
string
åå 

correoUser
åå 
=
åå 
correoU
åå  '
.
åå' (
ToString
åå( 0
(
åå0 1
)
åå1 2
;
åå2 3

ListaAmigo
éé 
amigo
éé 
=
éé 
db
éé !
.
éé! "
ListaAmigos
éé" -
.
éé- .
Find
éé. 2
(
éé2 3

correoUser
éé3 =
,
éé= >
correo
éé? E
)
ééE F
;
ééF G
db
èè 
.
èè 
ListaAmigos
èè 
.
èè 
Remove
èè !
(
èè! "
amigo
èè" '
)
èè' (
;
èè( )
db
êê 
.
êê 
SaveChanges
êê 
(
êê 
)
êê 
;
êê 
return
ëë 
RedirectToAction
ëë #
(
ëë# $
$str
ëë$ 1
)
ëë1 2
;
ëë2 3
}
ìì 	
public
ïï 
ActionResult
ïï 
AgregarAmigos
ïï )
(
ïï) *
string
ïï* 0
correo
ïï1 7
)
ïï7 8
{
ññ 	
var
óó 
correoU
óó 
=
óó 
HttpContext
óó %
.
óó% &
Session
óó& -
[
óó- .
$str
óó. 8
]
óó8 9
;
óó9 :
string
òò 

correoUser
òò 
=
òò 
correoU
òò  '
.
òò' (
ToString
òò( 0
(
òò0 1
)
òò1 2
;
òò2 3

ListaAmigo
öö 
amigo
öö 
=
öö 
new
öö "

ListaAmigo
öö# -
(
öö- .
)
öö. /
;
öö/ 0
amigo
õõ 
.
õõ 
CorreoDueno
õõ 
=
õõ 

correoUser
õõ  *
;
õõ* +
amigo
úú 
.
úú 
CorreoAmigo
úú 
=
úú 
correo
úú  &
;
úú& '
db
ùù 
.
ùù 
ListaAmigos
ùù 
.
ùù 
Add
ùù 
(
ùù 
amigo
ùù $
)
ùù$ %
;
ùù% &
db
ûû 
.
ûû 
SaveChanges
ûû 
(
ûû 
)
ûû 
;
ûû 
return
üü 
RedirectToAction
üü #
(
üü# $
$str
üü$ 1
)
üü1 2
;
üü2 3
}
°° 	
public
•• 
ActionResult
•• $
ListaDeAmigosSubListas
•• 2
(
••2 3
int
••3 6
?
••6 7
ide
••8 ;
)
••; <
{
¶¶ 	
var
®® 
correoU
®® 
=
®® 
HttpContext
®® %
.
®®% &
Session
®®& -
[
®®- .
$str
®®. 8
]
®®8 9
;
®®9 :
string
©© 

correoUser
©© 
=
©© 
correoU
©©  '
.
©©' (
ToString
©©( 0
(
©©0 1
)
©©1 2
;
©©2 3
List
™™ 
<
™™ 
PanelSublista
™™ 
>
™™ 
lista_S
™™  '
=
™™( )
db
™™* ,
.
™™, -
PanelSublistas
™™- ;
.
™™; <
Where
™™< A
(
™™A B
c
™™B C
=>
™™D F
c
™™G H
.
™™H I
CorreoDueno
™™I T
==
™™U W

correoUser
™™X b
)
™™b c
.
™™c d
ToList
™™d j
(
™™j k
)
™™k l
;
™™l m
MostrarListas
´´ 
listas
´´  
=
´´! "
new
´´# &
MostrarListas
´´' 4
(
´´4 5
)
´´5 6
;
´´6 7
listas
¨¨ 
.
¨¨ 
	Sublistas
¨¨ 
=
¨¨ 
lista_S
¨¨ &
;
¨¨& '
if
≠≠ 
(
≠≠ 
listas
≠≠ 
.
≠≠ 
EstaEnSublistas
≠≠ &
==
≠≠' )
null
≠≠* .
)
≠≠. /
{
ÆÆ 
List
ØØ 
<
ØØ !
VistaEstaEnSublista
ØØ (
>
ØØ( )
lista_E
ØØ* 1
=
ØØ2 3
new
ØØ4 7
List
ØØ8 <
<
ØØ< =!
VistaEstaEnSublista
ØØ= P
>
ØØP Q
(
ØØQ R
)
ØØR S
;
ØØS T
listas
∞∞ 
.
∞∞ 
EstaEnSublistas
∞∞ &
=
∞∞' (
lista_E
∞∞) 0
;
∞∞0 1
List
±± 
<
±± !
VistaEstaEnSublista
±± (
>
±±( )
lista_N
±±* 1
=
±±2 3
new
±±4 7
List
±±8 <
<
±±< =!
VistaEstaEnSublista
±±= P
>
±±P Q
(
±±Q R
)
±±R S
;
±±S T
listas
≤≤ 
.
≤≤ 
NoEsta
≤≤ 
=
≤≤ 
lista_N
≤≤  '
;
≤≤' (
}
≥≥ 
if
¥¥ 
(
¥¥ 
ide
¥¥ 
!=
¥¥ 
null
¥¥ 
)
¥¥ 
{
µµ 
List
∂∂ 
<
∂∂ !
VistaEstaEnSublista
∂∂ (
>
∂∂( )
lista_N
∂∂* 1
=
∂∂2 3
new
∂∂4 7
List
∂∂8 <
<
∂∂< =!
VistaEstaEnSublista
∂∂= P
>
∂∂P Q
(
∂∂Q R
)
∂∂R S
;
∂∂S T
List
∑∑ 
<
∑∑ !
VistaEstaEnSublista
∑∑ (
>
∑∑( )
lista_E
∑∑* 1
=
∑∑2 3
db
∑∑4 6
.
∑∑6 7"
VistaEstaEnSublistas
∑∑7 K
.
∑∑K L
Where
∑∑L Q
(
∑∑Q R
c
∑∑R S
=>
∑∑T V
c
∑∑W X
.
∑∑X Y

SublistaID
∑∑Y c
==
∑∑d f
ide
∑∑g j
)
∑∑j k
.
∑∑k l
ToList
∑∑l r
(
∑∑r s
)
∑∑s t
;
∑∑t u
List
∏∏ 
<
∏∏ !
VistaEstaEnSublista
∏∏ (
>
∏∏( )
lista_Todos
∏∏* 5
=
∏∏6 7
db
∏∏8 :
.
∏∏: ;"
VistaEstaEnSublistas
∏∏; O
.
∏∏O P
ToList
∏∏P V
(
∏∏V W
)
∏∏W X
;
∏∏X Y
List
ππ 
<
ππ 

VistaAmigo
ππ 
>
ππ  
lista_A
ππ! (
=
ππ) *
db
ππ+ -
.
ππ- .
VistaAmigos
ππ. 9
.
ππ9 :
Where
ππ: ?
(
ππ? @
c
ππ@ A
=>
ππB D
c
ππE F
.
ππF G
CorreoDueno
ππG R
==
ππS U

correoUser
ππV `
)
ππ` a
.
ππa b
ToList
ππb h
(
ππh i
)
ππi j
;
ππj k
foreach
∫∫ 
(
∫∫ 
var
∫∫ 
item
∫∫ !
in
∫∫" $
lista_A
∫∫% ,
)
∫∫, -
{
∫∫. /
ObjectParameter
ºº #
returnId
ºº$ ,
=
ºº- .
new
ºº/ 2
ObjectParameter
ºº3 B
(
ººB C
$str
ººC K
,
ººK L
typeof
ººM S
(
ººS T
int
ººT W
)
ººW X
)
ººX Y
;
ººY Z
int
ΩΩ 
esta
ΩΩ 
=
ΩΩ 
db
ΩΩ !
.
ΩΩ! "
ExisteEnSublista
ΩΩ" 2
(
ΩΩ2 3
ide
ΩΩ3 6
,
ΩΩ6 7
item
ΩΩ8 <
.
ΩΩ< =
CorreoAmigo
ΩΩ= H
,
ΩΩH I
returnId
ΩΩJ R
)
ΩΩR S
;
ΩΩS T
if
ææ 
(
ææ 
returnId
ææ  
.
ææ  !
Value
ææ! &
.
ææ& '
Equals
ææ' -
(
ææ- .
$num
ææ. /
)
ææ/ 0
)
ææ0 1
{
ææ2 3!
VistaEstaEnSublista
øø +
user
øø, 0
=
øø1 2
new
øø3 6!
VistaEstaEnSublista
øø7 J
(
øøJ K
)
øøK L
;
øøL M
user
¿¿ 
.
¿¿ 
CorreoDueno
¿¿ (
=
¿¿) *
item
¿¿+ /
.
¿¿/ 0
CorreoDueno
¿¿0 ;
;
¿¿; <
user
¡¡ 
.
¡¡ 
CorreoAmigo
¡¡ (
=
¡¡) *
item
¡¡+ /
.
¡¡/ 0
CorreoAmigo
¡¡0 ;
;
¡¡; <
user
¬¬ 
.
¬¬ 
Nombre
¬¬ #
=
¬¬$ %
item
¬¬& *
.
¬¬* +
Nombre
¬¬+ 1
;
¬¬1 2
user
√√ 
.
√√ 
	Apellido1
√√ &
=
√√' (
item
√√) -
.
√√- .
	Apellido1
√√. 7
;
√√7 8
user
ƒƒ 
.
ƒƒ 
	Apellido2
ƒƒ &
=
ƒƒ' (
item
ƒƒ) -
.
ƒƒ- .
	Apellido2
ƒƒ. 7
;
ƒƒ7 8
user
≈≈ 
.
≈≈ 

SublistaID
≈≈ '
=
≈≈( )
(
≈≈* +
int
≈≈+ .
)
≈≈. /
ide
≈≈/ 2
;
≈≈2 3
lista_N
∆∆ 
.
∆∆  
Add
∆∆  #
(
∆∆# $
user
∆∆$ (
)
∆∆( )
;
∆∆) *
}
«« 
}
»» 
listas
…… 
.
…… 
NoEsta
…… 
=
…… 
lista_N
……  '
;
……' (
listas
   
.
   
EstaEnSublistas
   &
=
  ' (
lista_E
  ) 0
;
  0 1
}
ÃÃ 
return
ÕÕ 
View
ÕÕ 
(
ÕÕ 
listas
ÕÕ 
)
ÕÕ 
;
ÕÕ  
}
ŒŒ 	
public
–– 
ActionResult
–– 
AgregarASublista
–– ,
(
––, -
string
––- 3
correo
––4 :
,
––: ;
int
––< ?
idSub
––@ E
)
––E F
{
—— 	
var
““ 
correoU
““ 
=
““ 
HttpContext
““ %
.
““% &
Session
““& -
[
““- .
$str
““. 8
]
““8 9
;
““9 :
string
”” 

correoUser
”” 
=
”” 
correoU
””  '
.
””' (
ToString
””( 0
(
””0 1
)
””1 2
;
””2 3&
Relacion_Sublista_Amigos
’’ $
amigo
’’% *
=
’’+ ,
new
’’- 0&
Relacion_Sublista_Amigos
’’1 I
(
’’I J
)
’’J K
;
’’K L
amigo
÷÷ 
.
÷÷ 
CorreoDueno
÷÷ 
=
÷÷ 

correoUser
÷÷  *
;
÷÷* +
amigo
◊◊ 
.
◊◊ 
CorreoAmigo
◊◊ 
=
◊◊ 
correo
◊◊  &
;
◊◊& '
amigo
ÿÿ 
.
ÿÿ !
CorreoDuenoSublista
ÿÿ %
=
ÿÿ& '

correoUser
ÿÿ( 2
;
ÿÿ2 3
amigo
ŸŸ 
.
ŸŸ 

SublistaID
ŸŸ 
=
ŸŸ 
idSub
ŸŸ $
;
ŸŸ$ %
db
⁄⁄ 
.
⁄⁄ &
Relacion_Sublista_Amigos
⁄⁄ '
.
⁄⁄' (
Add
⁄⁄( +
(
⁄⁄+ ,
amigo
⁄⁄, 1
)
⁄⁄1 2
;
⁄⁄2 3
db
€€ 
.
€€ 
SaveChanges
€€ 
(
€€ 
)
€€ 
;
€€ 
return
‹‹ 
RedirectToAction
‹‹ #
(
‹‹# $
$str
‹‹$ <
)
‹‹< =
;
‹‹= >
}
ﬁﬁ 	
public
‡‡ 
ActionResult
‡‡  
EliminarDeSublista
‡‡ .
(
‡‡. /
string
‡‡/ 5
correo
‡‡6 <
,
‡‡< =
int
‡‡> A
idSub
‡‡B G
)
‡‡G H
{
·· 	
var
‚‚ 
correoU
‚‚ 
=
‚‚ 
HttpContext
‚‚ %
.
‚‚% &
Session
‚‚& -
[
‚‚- .
$str
‚‚. 8
]
‚‚8 9
;
‚‚9 :
string
„„ 

correoUser
„„ 
=
„„ 
correoU
„„  '
.
„„' (
ToString
„„( 0
(
„„0 1
)
„„1 2
;
„„2 3&
Relacion_Sublista_Amigos
‰‰ $
amigo
‰‰% *
=
‰‰+ ,
db
‰‰- /
.
‰‰/ 0&
Relacion_Sublista_Amigos
‰‰0 H
.
‰‰H I
Find
‰‰I M
(
‰‰M N

correoUser
‰‰N X
,
‰‰X Y
correo
‰‰Z `
,
‰‰` a

correoUser
‰‰b l
,
‰‰l m
idSub
‰‰n s
)
‰‰s t
;
‰‰t u
db
ÂÂ 
.
ÂÂ &
Relacion_Sublista_Amigos
ÂÂ '
.
ÂÂ' (
Remove
ÂÂ( .
(
ÂÂ. /
amigo
ÂÂ/ 4
)
ÂÂ4 5
;
ÂÂ5 6
db
ÊÊ 
.
ÊÊ 
SaveChanges
ÊÊ 
(
ÊÊ 
)
ÊÊ 
;
ÊÊ 
return
ÁÁ 
RedirectToAction
ÁÁ #
(
ÁÁ# $
$str
ÁÁ$ <
)
ÁÁ< =
;
ÁÁ= >
}
ËË 	
[
ÈÈ 	
HttpPost
ÈÈ	 
]
ÈÈ 
public
ÍÍ 
ActionResult
ÍÍ 
CrearSublista
ÍÍ )
(
ÍÍ) *
FormCollection
ÍÍ* 8
form
ÍÍ9 =
)
ÍÍ= >
{
ÎÎ 	
var
ÏÏ 
correoU
ÏÏ 
=
ÏÏ 
HttpContext
ÏÏ %
.
ÏÏ% &
Session
ÏÏ& -
[
ÏÏ- .
$str
ÏÏ. 8
]
ÏÏ8 9
;
ÏÏ9 :
string
ÌÌ 

correoUser
ÌÌ 
=
ÌÌ 
correoU
ÌÌ  '
.
ÌÌ' (
ToString
ÌÌ( 0
(
ÌÌ0 1
)
ÌÌ1 2
;
ÌÌ2 3
string
ÓÓ 
nombreLista
ÓÓ 
=
ÓÓ  
form
ÓÓ! %
[
ÓÓ% &
$str
ÓÓ& 7
]
ÓÓ7 8
.
ÓÓ8 9
ToString
ÓÓ9 A
(
ÓÓA B
)
ÓÓB C
;
ÓÓC D
Sublista
ÔÔ 
nuevo
ÔÔ 
=
ÔÔ 
new
ÔÔ  
Sublista
ÔÔ! )
(
ÔÔ) *
)
ÔÔ* +
;
ÔÔ+ ,
nuevo
 
.
 
CorreoDueno
 
=
 

correoUser
  *
;
* +
nuevo
ÒÒ 
.
ÒÒ 
NombreSublista
ÒÒ  
=
ÒÒ! "
nombreLista
ÒÒ# .
;
ÒÒ. /
db
ÚÚ 
.
ÚÚ 
	Sublistas
ÚÚ 
.
ÚÚ 
Add
ÚÚ 
(
ÚÚ 
nuevo
ÚÚ "
)
ÚÚ" #
;
ÚÚ# $
db
ÛÛ 
.
ÛÛ 
SaveChanges
ÛÛ 
(
ÛÛ 
)
ÛÛ 
;
ÛÛ 
return
ÙÙ 
RedirectToAction
ÙÙ #
(
ÙÙ# $
$str
ÙÙ$ <
)
ÙÙ< =
;
ÙÙ= >
}
ıı 	
public
¯¯ 
ActionResult
¯¯ 
Details
¯¯  '
(
¯¯' (
string
¯¯( .
id
¯¯/ 1
)
¯¯1 2
{
˘˘ 	
if
˙˙ 
(
˙˙ 
id
˙˙ 
==
˙˙ 
null
˙˙ 
)
˙˙ 
{
˚˚ 
return
¸¸ 
new
¸¸ "
HttpStatusCodeResult
¸¸ /
(
¸¸/ 0
HttpStatusCode
¸¸0 >
.
¸¸> ?

BadRequest
¸¸? I
)
¸¸I J
;
¸¸J K
}
˝˝ 
Cliente
˛˛ 
cliente
˛˛ 
=
˛˛ 
db
˛˛  
.
˛˛  !
Clientes
˛˛! )
.
˛˛) *
Find
˛˛* .
(
˛˛. /
id
˛˛/ 1
)
˛˛1 2
;
˛˛2 3
if
ˇˇ 
(
ˇˇ 
cliente
ˇˇ 
==
ˇˇ 
null
ˇˇ 
)
ˇˇ  
{
ÄÄ 
return
ÅÅ 
HttpNotFound
ÅÅ #
(
ÅÅ# $
)
ÅÅ$ %
;
ÅÅ% &
}
ÇÇ 
return
ÉÉ 
View
ÉÉ 
(
ÉÉ 
cliente
ÉÉ 
)
ÉÉ  
;
ÉÉ  !
}
ÑÑ 	
public
áá 
ActionResult
áá 
Create
áá "
(
áá" #
)
áá# $
{
àà 	
ViewBag
ââ 
.
ââ 
Correo
ââ 
=
ââ 
new
ââ  

SelectList
ââ! +
(
ââ+ ,
db
ââ, .
.
ââ. /
Registradoes
ââ/ ;
,
ââ; <
$str
ââ= E
,
ââE F
$str
ââG S
)
ââS T
;
ââT U
return
ää 
View
ää 
(
ää 
)
ää 
;
ää 
}
ãã 	
[
êê 	
HttpPost
êê	 
]
êê 
public
íí 
ActionResult
íí 
Create
íí "
(
íí" #
[
íí# $
Bind
íí$ (
(
íí( )
Include
íí) 0
=
íí1 2
$stríí3 ¥
)íí¥ µ
]ííµ ∂
Clienteíí∑ æ
clienteííø ∆
)íí∆ «
{
ìì 	
if
îî 
(
îî 

ModelState
îî 
.
îî 
IsValid
îî "
)
îî" #
{
ïï 
db
ññ 
.
ññ 
Clientes
ññ 
.
ññ 
Add
ññ 
(
ññ  
cliente
ññ  '
)
ññ' (
;
ññ( )
db
óó 
.
óó 
SaveChanges
óó 
(
óó 
)
óó  
;
óó  !
return
òò 
RedirectToAction
òò '
(
òò' (
$str
òò( /
)
òò/ 0
;
òò0 1
}
ôô 
ViewBag
õõ 
.
õõ 
Correo
õõ 
=
õõ 
new
õõ  

SelectList
õõ! +
(
õõ+ ,
db
õõ, .
.
õõ. /
Registradoes
õõ/ ;
,
õõ; <
$str
õõ= E
,
õõE F
$str
õõG S
,
õõS T
cliente
õõU \
.
õõ\ ]
Correo
õõ] c
)
õõc d
;
õõd e
return
úú 
View
úú 
(
úú 
cliente
úú 
)
úú  
;
úú  !
}
ùù 	
public
†† 
ActionResult
†† 
Edit
††  
(
††  !
string
††! '
id
††( *
)
††* +
{
°° 	
if
¢¢ 
(
¢¢ 
id
¢¢ 
==
¢¢ 
null
¢¢ 
)
¢¢ 
{
££ 
return
§§ 
new
§§ "
HttpStatusCodeResult
§§ /
(
§§/ 0
HttpStatusCode
§§0 >
.
§§> ?

BadRequest
§§? I
)
§§I J
;
§§J K
}
•• 
Cliente
¶¶ 
cliente
¶¶ 
=
¶¶ 
db
¶¶  
.
¶¶  !
Clientes
¶¶! )
.
¶¶) *
Find
¶¶* .
(
¶¶. /
id
¶¶/ 1
)
¶¶1 2
;
¶¶2 3
if
ßß 
(
ßß 
cliente
ßß 
==
ßß 
null
ßß 
)
ßß  
{
®® 
return
©© 
HttpNotFound
©© #
(
©©# $
)
©©$ %
;
©©% &
}
™™ 
ViewBag
´´ 
.
´´ 
Correo
´´ 
=
´´ 
new
´´  

SelectList
´´! +
(
´´+ ,
db
´´, .
.
´´. /
Registradoes
´´/ ;
,
´´; <
$str
´´= E
,
´´E F
$str
´´G S
,
´´S T
cliente
´´U \
.
´´\ ]
Correo
´´] c
)
´´c d
;
´´d e
return
¨¨ 
View
¨¨ 
(
¨¨ 
cliente
¨¨ 
)
¨¨  
;
¨¨  !
}
≠≠ 	
[
≤≤ 	
HttpPost
≤≤	 
]
≤≤ 
public
¥¥ 
ActionResult
¥¥ 
Edit
¥¥  
(
¥¥  !
[
¥¥! "
Bind
¥¥" &
(
¥¥& '
Include
¥¥' .
=
¥¥/ 0
$str¥¥1 ≤
)¥¥≤ ≥
]¥¥≥ ¥
Cliente¥¥µ º
cliente¥¥Ω ƒ
)¥¥ƒ ≈
{
µµ 	
if
∂∂ 
(
∂∂ 

ModelState
∂∂ 
.
∂∂ 
IsValid
∂∂ "
)
∂∂" #
{
∑∑ 
db
∏∏ 
.
∏∏ 
Entry
∏∏ 
(
∏∏ 
cliente
∏∏  
)
∏∏  !
.
∏∏! "
State
∏∏" '
=
∏∏( )
EntityState
∏∏* 5
.
∏∏5 6
Modified
∏∏6 >
;
∏∏> ?
db
ππ 
.
ππ 
SaveChanges
ππ 
(
ππ 
)
ππ  
;
ππ  !
return
∫∫ 
RedirectToAction
∫∫ '
(
∫∫' (
$str
∫∫( /
)
∫∫/ 0
;
∫∫0 1
}
ªª 
ViewBag
ºº 
.
ºº 
Correo
ºº 
=
ºº 
new
ºº  

SelectList
ºº! +
(
ºº+ ,
db
ºº, .
.
ºº. /
Registradoes
ºº/ ;
,
ºº; <
$str
ºº= E
,
ººE F
$str
ººG S
,
ººS T
cliente
ººU \
.
ºº\ ]
Correo
ºº] c
)
ººc d
;
ººd e
return
ΩΩ 
View
ΩΩ 
(
ΩΩ 
cliente
ΩΩ 
)
ΩΩ  
;
ΩΩ  !
}
ææ 	
public
¡¡ 
ActionResult
¡¡ 
Delete
¡¡ "
(
¡¡" #
string
¡¡# )
id
¡¡* ,
)
¡¡, -
{
¬¬ 	
if
√√ 
(
√√ 
id
√√ 
==
√√ 
null
√√ 
)
√√ 
{
ƒƒ 
return
≈≈ 
new
≈≈ "
HttpStatusCodeResult
≈≈ /
(
≈≈/ 0
HttpStatusCode
≈≈0 >
.
≈≈> ?

BadRequest
≈≈? I
)
≈≈I J
;
≈≈J K
}
∆∆ 
Cliente
«« 
cliente
«« 
=
«« 
db
««  
.
««  !
Clientes
««! )
.
««) *
Find
««* .
(
««. /
id
««/ 1
)
««1 2
;
««2 3
if
»» 
(
»» 
cliente
»» 
==
»» 
null
»» 
)
»»  
{
…… 
return
   
HttpNotFound
   #
(
  # $
)
  $ %
;
  % &
}
ÀÀ 
return
ÃÃ 
View
ÃÃ 
(
ÃÃ 
cliente
ÃÃ 
)
ÃÃ  
;
ÃÃ  !
}
ÕÕ 	
[
–– 	
HttpPost
––	 
,
–– 

ActionName
–– 
(
–– 
$str
–– &
)
––& '
]
––' (
public
““ 
ActionResult
““ 
DeleteConfirmed
““ +
(
““+ ,
string
““, 2
id
““3 5
)
““5 6
{
”” 	
Cliente
‘‘ 
cliente
‘‘ 
=
‘‘ 
db
‘‘  
.
‘‘  !
Clientes
‘‘! )
.
‘‘) *
Find
‘‘* .
(
‘‘. /
id
‘‘/ 1
)
‘‘1 2
;
‘‘2 3
db
’’ 
.
’’ 
Clientes
’’ 
.
’’ 
Remove
’’ 
(
’’ 
cliente
’’ &
)
’’& '
;
’’' (
db
÷÷ 
.
÷÷ 
SaveChanges
÷÷ 
(
÷÷ 
)
÷÷ 
;
÷÷ 
return
◊◊ 
RedirectToAction
◊◊ #
(
◊◊# $
$str
◊◊$ +
)
◊◊+ ,
;
◊◊, -
}
ÿÿ 	
	protected
⁄⁄ 
override
⁄⁄ 
void
⁄⁄ 
Dispose
⁄⁄  '
(
⁄⁄' (
bool
⁄⁄( ,
	disposing
⁄⁄- 6
)
⁄⁄6 7
{
€€ 	
if
‹‹ 
(
‹‹ 
	disposing
‹‹ 
)
‹‹ 
{
›› 
db
ﬁﬁ 
.
ﬁﬁ 
Dispose
ﬁﬁ 
(
ﬁﬁ 
)
ﬁﬁ 
;
ﬁﬁ 
}
ﬂﬂ 
base
‡‡ 
.
‡‡ 
Dispose
‡‡ 
(
‡‡ 
	disposing
‡‡ "
)
‡‡" #
;
‡‡# $
}
·· 	
}
‚‚ 
}„„ éé
}C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\DashboardController.cs
	namespace

 	#
Proyecto_Inge_Bases_Web


 !
.

! "
Controllers

" -
{ 
public 

class 
DashboardController $
:% &

Controller' 1
{ 
private 
TempPIEntities 
db !
=" #
new$ '
TempPIEntities( 6
(6 7
)7 8
;8 9
public 
ActionResult 
Index !
(! "
)" #
{ 	
string 
correo 
= 
( 
string #
)# $
HttpContext$ /
./ 0
Session0 7
[7 8
$str8 B
]B C
;C D
Administrador 
admin 
=  !
db" $
.$ %
Administradors% 3
.3 4
Find4 8
(8 9
correo9 ?
)? @
;@ A
if 
( 
admin 
== 
null 
) 
{ 
return 
RedirectToAction '
(' (
$str( 7
,7 8
$str9 E
)E F
;F G
} 
var 
usuario 
= 
from 
u  
in! #
db$ &
.& '"
Calificaciones_Cliente' =
select  
u! "
;" #
usuario 
= 
usuario 
. 
OrderBy %
(% &
u& '
=>( *
u+ ,
., -
Nombre- 3
)3 4
;4 5
return!! 
View!! 
(!! 
usuario!! 
.!!  
ToList!!  &
(!!& '
)!!' (
)!!( )
;!!) *
}"" 	
public$$ 
ActionResult$$ 
EdadesClientes$$ *
($$* +
)$$+ ,
{%% 	
string)) 
correo)) 
=)) 
()) 
string)) #
)))# $
HttpContext))$ /
.))/ 0
Session))0 7
[))7 8
$str))8 B
]))B C
;))C D
Administrador** 
admin** 
=**  !
db**" $
.**$ %
Administradors**% 3
.**3 4
Find**4 8
(**8 9
correo**9 ?
)**? @
;**@ A
if,, 
(,, 
admin,, 
==,, 
null,, 
),, 
{-- 
return.. 
RedirectToAction.. '
(..' (
$str..( 7
,..7 8
$str..9 E
)..E F
;..F G
}// 
var11 
usuario11 
=11 
from11 
u11  
in11! #
db11$ &
.11& '"
Calificaciones_Cliente11' =
select22  
u22! "
;22" #
usuario33 
=33 
usuario33 
.33 
OrderBy33 %
(33% &
u33& '
=>33( *
u33+ ,
.33, -
Nombre33- 3
)333 4
;334 5
return55 
View55 
(55 
usuario55 
.55  
ToList55  &
(55& '
)55' (
)55( )
;55) *
}66 	
public77 
ActionResult77 "
CalificacionesUsuarios77 2
(772 3
)773 4
{88 	
string<< 
correo<< 
=<< 
(<< 
string<< #
)<<# $
HttpContext<<$ /
.<</ 0
Session<<0 7
[<<7 8
$str<<8 B
]<<B C
;<<C D
Administrador== 
admin== 
===  !
db==" $
.==$ %
Administradors==% 3
.==3 4
Find==4 8
(==8 9
correo==9 ?
)==? @
;==@ A
if?? 
(?? 
admin?? 
==?? 
null?? 
)?? 
{@@ 
returnAA 
RedirectToActionAA '
(AA' (
$strAA( 7
,AA7 8
$strAA9 E
)AAE F
;AAF G
}BB 
varDD 
usuarioDD 
=DD 
fromDD 
uDD  
inDD! #
dbDD$ &
.DD& '"
Calificaciones_ClienteDD' =
selectEE  
uEE! "
;EE" #
usuarioFF 
=FF 
usuarioFF 
.FF 
OrderByFF %
(FF% &
uFF& '
=>FF( *
uFF+ ,
.FF, -
NombreFF- 3
)FF3 4
;FF4 5
returnHH 
ViewHH 
(HH 
usuarioHH 
.HH  
ToListHH  &
(HH& '
)HH' (
)HH( )
;HH) *
}II 	
publicKK 
StringKK 
CategoriaLabelsKK %
(KK% &
intKK& )
raizKK* .
)KK. /
{LL 	
varMM 
	categoriaMM 
=MM 
dbMM 
.MM 

CategoriasMM )
.MM) *
WhereMM* /
(MM/ 0
catMM0 3
=>MM4 6
catMM7 :
.MM: ;
CategoriaPadreIDMM; K
==MML N
raizMMO S
)MMS T
;MMT U
	categoriaNN 
=NN 
	categoriaNN !
.NN! "
OrderByNN" )
(NN) *
uNN* +
=>NN, .
uNN/ 0
.NN0 1
NombreNN1 7
)NN7 8
;NN8 9
varPP  
ListaCategoriaNombrePP $
=PP% &
	categoriaPP' 0
.PP0 1
SelectPP1 7
(PP7 8
cPP8 9
=>PP: <
cPP= >
.PP> ?
NombrePP? E
)PPE F
.PPF G
ToListPPG M
(PPM N
)PPN O
;PPO P
StringQQ 
labelsOrdenadosQQ "
=QQ# $
stringQQ% +
.QQ+ ,
JoinQQ, 0
(QQ0 1
$strQQ1 4
,QQ4 5 
ListaCategoriaNombreQQ6 J
.QQJ K
SelectQQK Q
(QQQ R
xQQR S
=>QQT V
stringQQW ]
.QQ] ^
FormatQQ^ d
(QQd e
$strQQe l
,QQl m
xQQn o
)QQo p
)QQp q
)QQq r
.QQr s
TrimQQs w
(QQw x
)QQx y
;QQy z
returnTT 
labelsOrdenadosTT "
;TT" #
}VV 	
publicZZ 
intZZ +
CantidadProductosCategoriaPadreZZ 2
(ZZ2 3
intZZ3 6
idZZ7 9
)ZZ9 :
{[[ 	
var\\ 
	categoria\\ 
=\\ 
db\\ 
.\\ 

Categorias\\ )
.\\) *
Find\\* .
(\\. /
id\\/ 1
)\\1 2
;\\2 3
var]] 
subcategorias]] 
=]] 
db]]  "
.]]" #

Categorias]]# -
.]]- .
Where]]. 3
(]]3 4
cat]]4 7
=>]]8 :
cat]]; >
.]]> ?
CategoriaPadreID]]? O
==]]P R
id]]S U
)]]U V
;]]V W
int^^ 
cantidadProductos^^ !
=^^" #
	categoria^^$ -
.^^- .

Productoes^^. 8
.^^8 9
Count^^9 >
;^^> ?
foreach__ 
(__ 
var__ 
sc__ 
in__ 
subcategorias__ ,
)__, -
{`` 
cantidadProductosaa !
=aa" #)
CantidadProductosCategoriaRecaa$ A
(aaA B
scaaB D
,aaD E
cantidadProductosaaF W
)aaW X
;aaX Y
}cc 
returnee 
cantidadProductosee $
;ee$ %
}ff 	
privatehh 
inthh )
CantidadProductosCategoriaRechh 1
(hh1 2
	Categoriahh2 ;
categoriaActualhh< K
,hhK L
inthhM P
cantidadhhQ Y
)hhY Z
{ii 	
intjj 
cantidadProductosjj !
=jj" #
cantidadjj$ ,
+jj- .
categoriaActualjj/ >
.jj> ?

Productoesjj? I
.jjI J
CountjjJ O
(jjO P
)jjP Q
;jjQ R
varkk 
subcategoriaskk 
=kk 
dbkk  "
.kk" #

Categoriaskk# -
.kk- .
Wherekk. 3
(kk3 4
catkk4 7
=>kk8 :
catkk; >
.kk> ?
CategoriaPadreIDkk? O
==kkP R
categoriaActualkkS b
.kkb c
CategoriaIDkkc n
)kkn o
;kko p
foreachll 
(ll 
varll 
scll 
inll 
subcategoriasll ,
)ll, -
{mm 
cantidadProductosnn !
=nn" #)
CantidadProductosCategoriaRecnn$ A
(nnA B
scnnB D
,nnD E
cantidadProductosnnF W
)nnW X
;nnX Y
}oo 
returnpp 
cantidadProductospp $
;pp$ %
}qq 	
publicss 
Stringss +
CantidadProductosCategoriaDatosss 5
(ss5 6
intss6 9
raizss: >
)ss> ?
{tt 	
varuu 
	categoriauu 
=uu 
dbuu 
.uu 

Categoriasuu )
.uu) *
Whereuu* /
(uu/ 0
catuu0 3
=>uu4 6
catuu7 :
.uu: ;
CategoriaPadreIDuu; K
==uuL N
raizuuO S
)uuS T
;uuT U
	categoriavv 
=vv 
	categoriavv !
.vv! "
OrderByvv" )
(vv) *
uvv* +
=>vv, .
uvv/ 0
.vv0 1
Nombrevv1 7
)vv7 8
;vv8 9
varxx "
ListaCantidadProductosxx &
=xx' (
newxx) ,
Listxx- 1
<xx1 2
intxx2 5
>xx5 6
(xx6 7
)xx7 8
;xx8 9
foreachzz 
(zz 
varzz 
catzz 
inzz 
	categoriazz  )
)zz) *
{{{ "
ListaCantidadProductos|| &
.||& '
Add||' *
(||* ++
CantidadProductosCategoriaPadre||+ J
(||J K
cat||K N
.||N O
CategoriaID||O Z
)||Z [
)||[ \
;||\ ]
}}} 
String 
datosOrdenados !
=" #
string$ *
.* +
Join+ /
(/ 0
$str0 3
,3 4"
ListaCantidadProductos5 K
)K L
.L M
TrimM Q
(Q R
)R S
;S T
return
ÇÇ 
datosOrdenados
ÇÇ !
;
ÇÇ! "
}
ÑÑ 	
public
àà 
int
àà &
CountSubastasEnCategoria
àà +
(
àà+ ,
int
àà, /
id
àà0 2
)
àà2 3
{
ââ 	
var
ää 
	subPorCat
ää 
=
ää 
from
ää  
spc
ää! $
in
ää% '
db
ää( *
.
ää* +#
subastasPorCategorias
ää+ @
group
ãã !
spc
ãã" %
.
ãã% &!
ProductoIDSubastado
ãã& 9
by
ãã: <
spc
ãã= @
.
ãã@ A
IDCategoria
ããA L
into
ããM Q
C
ããR S
select
åå "
new
åå# &
{
åå' (
IDCategoria
åå) 4
=
åå5 6
C
åå7 8
.
åå8 9
Key
åå9 <
,
åå< =
SubastasCount
åå> K
=
ååL M
C
ååN O
.
ååO P
ToList
ååP V
(
ååV W
)
ååW X
.
ååX Y
Count
ååY ^
(
åå^ _
)
åå_ `
}
ååa b
;
ååb c
var
éé 
ListaSubPorcat
éé 
=
éé  
	subPorCat
éé! *
.
éé* +
ToList
éé+ 1
(
éé1 2
)
éé2 3
;
éé3 4
var
èè 
categoriaActual
èè 
=
èè  !
ListaSubPorcat
èè" 0
.
èè0 1
Where
èè1 6
(
èè6 7
spc
èè7 :
=>
èè; =
spc
èè> A
.
èèA B
IDCategoria
èèB M
==
èèN P
id
èèQ S
)
èèS T
.
èèT U
FirstOrDefault
èèU c
(
èèc d
)
èèd e
;
èèe f
if
êê 
(
êê 
categoriaActual
êê 
!=
êê !
null
êê" &
)
êê& '
{
ëë 
return
íí 
categoriaActual
íí &
.
íí& '
SubastasCount
íí' 4
;
íí4 5
}
ìì 
else
îî 
{
ïï 
return
ññ 
$num
ññ 
;
ññ 
}
óó 
}
òò 	
public
öö 
int
öö /
!CantidadSubastasPorCategoriaPadre
öö 4
(
öö4 5
int
öö5 8
raiz
öö9 =
)
öö= >
{
õõ 	
var
úú 
subcategorias
úú 
=
úú 
db
úú  "
.
úú" #

Categorias
úú# -
.
úú- .
Where
úú. 3
(
úú3 4
cat
úú4 7
=>
úú8 :
cat
úú; >
.
úú> ?
CategoriaPadreID
úú? O
==
úúP R
raiz
úúS W
)
úúW X
;
úúX Y
int
ùù 
cantidadSubastas
ùù  
=
ùù! "&
CountSubastasEnCategoria
ùù# ;
(
ùù; <
raiz
ùù< @
)
ùù@ A
;
ùùA B
foreach
ûû 
(
ûû 
var
ûû 
sc
ûû 
in
ûû 
subcategorias
ûû ,
)
ûû, -
{
üü 
cantidadSubastas
††  
=
††! "-
CantidadSubastasPorCategoriaRec
††# B
(
††B C
sc
††C E
.
††E F
CategoriaID
††F Q
,
††Q R
cantidadSubastas
††S c
)
††c d
;
††d e
}
¢¢ 
return
§§ 
cantidadSubastas
§§ #
;
§§# $
}
•• 	
public
ßß 
int
ßß -
CantidadSubastasPorCategoriaRec
ßß 2
(
ßß2 3
int
ßß3 6
categoriaIDActual
ßß7 H
,
ßßH I
int
ßßJ M
cantidad
ßßN V
)
ßßV W
{
®® 	
int
©© 
cantidadSubastas
©©  
=
©©! "
cantidad
©©# +
+
©©, -&
CountSubastasEnCategoria
©©. F
(
©©F G
categoriaIDActual
©©G X
)
©©X Y
;
©©Y Z
var
™™ 
subcategorias
™™ 
=
™™ 
db
™™  "
.
™™" #

Categorias
™™# -
.
™™- .
Where
™™. 3
(
™™3 4
cat
™™4 7
=>
™™8 :
cat
™™; >
.
™™> ?
CategoriaPadreID
™™? O
==
™™P R
categoriaIDActual
™™S d
)
™™d e
;
™™e f
foreach
´´ 
(
´´ 
var
´´ 
sc
´´ 
in
´´ 
subcategorias
´´ ,
)
´´, -
{
¨¨ 
cantidadSubastas
≠≠  
=
≠≠! "-
CantidadSubastasPorCategoriaRec
≠≠# B
(
≠≠B C
sc
≠≠C E
.
≠≠E F
CategoriaID
≠≠F Q
,
≠≠Q R
cantidadSubastas
≠≠S c
)
≠≠c d
;
≠≠d e
}
ÆÆ 
return
ØØ 
cantidadSubastas
ØØ #
;
ØØ# $
}
∞∞ 	
public
≤≤ 
String
≤≤ ,
CantidadSubastasCategoriaDatos
≤≤ 4
(
≤≤4 5
int
≤≤5 8
raiz
≤≤9 =
)
≤≤= >
{
≥≥ 	
var
¥¥ 
	categoria
¥¥ 
=
¥¥ 
db
¥¥ 
.
¥¥ 

Categorias
¥¥ )
.
¥¥) *
Where
¥¥* /
(
¥¥/ 0
cat
¥¥0 3
=>
¥¥4 6
cat
¥¥7 :
.
¥¥: ;
CategoriaPadreID
¥¥; K
==
¥¥L N
raiz
¥¥O S
)
¥¥S T
;
¥¥T U
	categoria
µµ 
=
µµ 
	categoria
µµ !
.
µµ! "
OrderBy
µµ" )
(
µµ) *
u
µµ* +
=>
µµ, .
u
µµ/ 0
.
µµ0 1
Nombre
µµ1 7
)
µµ7 8
;
µµ8 9
var
∑∑ #
ListaCantidadSubastas
∑∑ %
=
∑∑& '
new
∑∑( +
List
∑∑, 0
<
∑∑0 1
int
∑∑1 4
>
∑∑4 5
(
∑∑5 6
)
∑∑6 7
;
∑∑7 8
foreach
ππ 
(
ππ 
var
ππ 
cat
ππ 
in
ππ 
	categoria
ππ  )
)
ππ) *
{
∫∫ #
ListaCantidadSubastas
ªª %
.
ªª% &
Add
ªª& )
(
ªª) */
!CantidadSubastasPorCategoriaPadre
ªª* K
(
ªªK L
cat
ªªL O
.
ªªO P
CategoriaID
ªªP [
)
ªª[ \
)
ªª\ ]
;
ªª] ^
}
ºº 
String
ææ 
datosOrdenados
ææ !
=
ææ" #
string
ææ$ *
.
ææ* +
Join
ææ+ /
(
ææ/ 0
$str
ææ0 3
,
ææ3 4#
ListaCantidadSubastas
ææ5 J
)
ææJ K
.
ææK L
Trim
ææL P
(
ææP Q
)
ææQ R
;
ææR S
return
¡¡ 
datosOrdenados
¡¡ !
;
¡¡! "
}
√√ 	
public
«« 
ActionResult
«« &
VerIndex_ProductosDelDia
«« 4
(
««4 5
)
««5 6
{
»» 	
return
…… 
RedirectToAction
…… #
(
……# $
$str
……$ +
,
……+ ,
$str
……- >
)
……> ?
;
……? @
}
   	
public
ÕÕ 
ActionResult
ÕÕ 
Ver_Estadisticas
ÕÕ ,
(
ÕÕ, -
)
ÕÕ- .
{
ŒŒ 	
return
œœ 
RedirectToAction
œœ #
(
œœ# $
$str
œœ$ +
,
œœ+ ,
$str
œœ- ;
)
œœ; <
;
œœ< =
}
–– 	
public
’’ 
ActionResult
’’ 
VerCategorias
’’ )
(
’’) *
)
’’* +
{
÷÷ 	
return
ÿÿ 
RedirectToAction
ÿÿ #
(
ÿÿ# $
$str
ÿÿ$ +
,
ÿÿ+ ,
$str
ÿÿ- 9
)
ÿÿ9 :
;
ÿÿ: ;
}
⁄⁄ 	
}
ïï 
}òò ≈Ì
}C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\DenunciasController.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Controllers" -
{ 
public 

class 
DenunciasController $
:% &

Controller' 1
{ 
private 
TempPIEntities 
db !
=" #
new$ '
TempPIEntities( 6
(6 7
)7 8
;8 9
public 
ActionResult 
Index !
(! "
)" #
{ 	
string 
correo 
= 
( 
string #
)# $
HttpContext$ /
./ 0
Session0 7
[7 8
$str8 B
]B C
;C D
Administrador 
admin 
=  !
db" $
.$ %
Administradors% 3
.3 4
Find4 8
(8 9
correo9 ?
)? @
;@ A
List 
< 

Registrado 
> 
registrados (
=) *
db+ -
.- .
Registradoes. :
.: ;
ToList; A
(A B
)B C
;C D
if 
( 
admin 
== 
null 
) 
{ 
return   
RedirectToAction   '
(  ' (
$str  ( 7
,  7 8
$str  9 E
)  E F
;  F G
}!! 
List## 
<## 
Denuncia## 
>## 
	denuncias## $
=##% &
db##' )
.##) *
	Denuncias##* 3
.##3 4
ToList##4 :
(##: ;
)##; <
;##< =
DateTime$$ 
x$$ 
=$$ 
DateTime$$ !
.$$! "
Today$$" '
;$$' (
return&& 
View&& 
(&& 
	denuncias&& !
)&&! "
;&&" #
}(( 	
public)) 
ActionResult)) 
Realizar_Denuncia)) -
())- .
string)). 4
correo))5 ;
,)); <
int))= @

productoID))A K
)))K L
{** 	
var++ 
usuario++ 
=++ 
db++ 
.++ 
Registradoes++ )
.++) *
Find++* .
(++. /
correo++/ 5
)++5 6
;++6 7
var,, 
denuncia,, 
=,, 
new,, 
Denuncia,, '
(,,' (
),,( )
;,,) *
denuncia-- 
.-- 

Denunciado-- 
=--  !
usuario--" )
.--) *
Correo--* 0
;--0 1
denuncia.. 
... 

ProductoID.. 
=..  !

productoID.." ,
;.., -
string// 
correo2// 
=// 
(// 
string// $
)//$ %
HttpContext//% 0
.//0 1
Session//1 8
[//8 9
$str//9 C
]//C D
;//D E
denuncia00 
.00 
Denunciante00  
=00! "
correo200# *
;00* +
DateTime11 
fechaHoy11 
=11 
DateTime11  (
.11( )
Now11) ,
;11, -
denuncia22 
.22 
Fecha22 
=22 
fechaHoy22 %
;22% &
ViewBag33 
.33 
Nombre33 
=33 
usuario33 $
.33$ %
Nombre33% +
;33+ ,
return44 
View44 
(44 
denuncia44  
)44  !
;44! "
}55 	
[66 	
HttpPost66	 
]66 
public77 
ActionResult77 
Realizar_Denuncia77 -
(77- .
[77. /
Bind77/ 3
(773 4
Include774 ;
=77< =
$str77> y
)77y z
]77z {
Denuncia	77| Ñ
	denuncias
77Ö é
)
77é è
{88 	
if99 
(99 

ModelState99 
.99 
IsValid99 "
)99" #
{:: 
db;; 
.;; 
	Denuncias;; 
.;; 
Add;;  
(;;  !
	denuncias;;! *
);;* +
;;;+ ,
db<< 
.<< 
SaveChanges<< 
(<< 
)<<  
;<<  !
return== 
RedirectToAction== '
(==' (
$str==( /
,==/ 0
$str==1 7
)==7 8
;==8 9
}>> 
return@@ 
View@@ 
(@@ 
	denuncias@@ !
)@@! "
;@@" #
}AA 	
publicCC 
ActionResultCC $
VerIndex_ProductosDelDiaCC 4
(CC4 5
)CC5 6
{DD 	
returnEE 
RedirectToActionEE #
(EE# $
$strEE$ +
,EE+ ,
$strEE- >
)EE> ?
;EE? @
}FF 	
publicII 
ActionResultII 
Ver_EstadisticasII ,
(II, -
)II- .
{JJ 	
returnKK 
RedirectToActionKK #
(KK# $
$strKK$ +
,KK+ ,
$strKK- ;
)KK; <
;KK< =
}LL 	
publicQQ 
ActionResultQQ 
VerCategoriasQQ )
(QQ) *
)QQ* +
{RR 	
returnTT 
RedirectToActionTT #
(TT# $
$strTT$ +
,TT+ ,
$strTT- 9
)TT9 :
;TT: ;
}VV 	
publicYY 
ActionResultYY 
DetallesProductoYY ,
(YY, -
intYY- 0
?YY0 1
idYY2 4
,YY4 5
stringYY6 <
correoYY= C
)YYC D
{ZZ 	
return\\ 
RedirectToAction\\ #
(\\# $
$str\\$ -
,\\- .
$str\\/ @
,\\@ A
new\\B E
{\\F G
id\\H J
=\\K L
id\\M O
,\\O P
correo\\Q W
=\\X Y
correo\\Z `
}\\a b
)\\b c
;\\c d
}^^ 	
public`` 
ActionResult`` 
EliminarDenuncia`` ,
(``, -
DateTime``- 5
fecha``6 ;
)``; <
{aa 	
Denunciacc 
	adicionalcc 
=cc  
dbcc! #
.cc# $
	Denunciascc$ -
.cc- .
Findcc. 2
(cc2 3
fechacc3 8
)cc8 9
;cc9 :
ifee 
(ee 
	adicionalee 
!=ee 
nullee !
)ee! "
{ff 

Registradohh 

registradohh %
=hh& '
dbhh( *
.hh* +
Registradoeshh+ 7
.hh7 8
Findhh8 <
(hh< =
	adicionalhh= F
.hhF G
DenunciantehhG R
)hhR S
;hhS T
stringjj 
mensajejj 
=jj  

registradojj! +
.jj+ ,
Nombrejj, 2
+jj3 4
$str	jj5 ◊
;
jj◊ ÿ
EnviarCorreokk 
(kk 
	adicionalkk &
.kk& '
Denunciantekk' 2
,kk2 3
mensajekk4 ;
,kk; <
$strkk= Q
)kkQ R
;kkR S
dbmm 
.mm 
	Denunciasmm 
.mm 
Removemm #
(mm# $
	adicionalmm$ -
)mm- .
;mm. /
dbnn 
.nn 
SaveChangesnn 
(nn 
)nn  
;nn  !
}oo 
returnpp 
RedirectToActionpp #
(pp# $
$strpp$ +
)pp+ ,
;pp, -
}qq 	
publicuu 
ActionResultuu 
BloquearUsuariouu +
(uu+ ,
Stringuu, 2

denunciadouu3 =
,uu= >
DateTimeuu? G
fechauuH M
)uuM N
{vv 	

Registradoxx 
reg_denunciadoxx %
=xx& '
dbxx( *
.xx* +
Registradoesxx+ 7
.xx7 8
Findxx8 <
(xx< =

denunciadoxx= G
)xxG H
;xxH I
var{{ 
	productos{{ 
={{ 
from{{  
p{{! "
in{{# %
db{{& (
.{{( )

Productoes{{) 3
where|| !
p||" #
.||# $
CorreoCliente||$ 1
==||2 4

denunciado||5 ?
select}} "
p}}# $
;}}$ %
	productos~~ 
=~~ 
	productos~~ !
.~~! "
OrderBy~~" )
(~~) *
p~~* +
=>~~, .
p~~/ 0
.~~0 1
Nombre~~1 7
)~~7 8
;~~8 9
var
ÅÅ 
	denuncias
ÅÅ 
=
ÅÅ 
from
ÅÅ  
q
ÅÅ! "
in
ÅÅ# %
db
ÅÅ& (
.
ÅÅ( )
	Denuncias
ÅÅ) 2
where
ÇÇ !
q
ÇÇ" #
.
ÇÇ# $

Denunciado
ÇÇ$ .
==
ÇÇ/ 1

denunciado
ÇÇ2 <
select
ÉÉ "
q
ÉÉ# $
;
ÉÉ$ %
	denuncias
ÑÑ 
=
ÑÑ 
	denuncias
ÑÑ !
.
ÑÑ! "
OrderBy
ÑÑ" )
(
ÑÑ) *
q
ÑÑ* +
=>
ÑÑ, .
q
ÑÑ/ 0
.
ÑÑ0 1
Fecha
ÑÑ1 6
)
ÑÑ6 7
;
ÑÑ7 8
foreach
áá 
(
áá 
var
áá 
producto
áá !
in
áá" $
	productos
áá% .
)
áá. /
{
àà 
producto
ââ 
.
ââ 
FechaPublicado
ââ '
=
ââ( )
null
ââ* .
;
ââ. /
producto
ää 
.
ää 
	Publicado
ää "
=
ää# $
false
ää% *
;
ää* +
}
ãã 
if
éé 
(
éé 
reg_denunciado
éé 
!=
éé !
null
éé" &
)
éé& '
{
èè 
reg_denunciado
êê 
.
êê 
Bloqueo
êê &
=
êê' (
true
êê) -
;
êê- .
string
îî 
mensaje_denuncia
îî '
=
îî( )
$str
îî* ,
;
îî, -
Denuncia
ïï 
denuncia
ïï !
=
ïï" #
db
ïï$ &
.
ïï& '
	Denuncias
ïï' 0
.
ïï0 1
Find
ïï1 5
(
ïï5 6
fecha
ïï6 ;
)
ïï; <
;
ïï< =
Producto
ññ 
producto
ññ !
=
ññ" #
db
ññ$ &
.
ññ& '

Productoes
ññ' 1
.
ññ1 2
Find
ññ2 6
(
ññ6 7
denuncia
ññ7 ?
.
ññ? @

ProductoID
ññ@ J
,
ññK L
denuncia
ññM U
.
ññU V

Denunciado
ññV `
)
ññ` a
;
ñña b
if
òò 
(
òò 
denuncia
òò 
!=
òò 
null
òò  $
&&
òò% '
producto
òò( 0
!=
òò1 3
null
òò4 8
)
òò8 9
{
òò: ;
switch
ôô 
(
ôô 
denuncia
ôô $
.
ôô$ %
Tipo
ôô% )
)
ôô) *
{
öö 
case
õõ 
$num
õõ 
:
õõ 
mensaje_denuncia
úú ,
=
úú- .
$strúú/ ç
+úúé è
productoúúè ó
.úúó ò
Nombreúúò û
+úúû ü
$strúúü §
;úú• ¶
break
ùù !
;
ùù! "
case
üü 
$num
üü 
:
üü 
mensaje_denuncia
†† ,
=
††- .
$str
††/ 
;†† Ä
break
°° !
;
°°! "
case
££ 
$num
££ 
:
££ 
mensaje_denuncia
§§ ,
=
§§- .
$str§§/ £
+§§§ •
producto§§¶ Æ
.§§Æ Ø
Nombre§§Ø µ
+§§∂ ∑
$str§§∏ Ω
;§§Ω æ
break
•• !
;
••! "
case
ßß 
$num
ßß 
:
ßß 
mensaje_denuncia
®® ,
=
®®- .
$str®®/ ã
+®®å ç
producto®®é ñ
.®®ñ ó
Nombre®®ó ù
+®®û ü
$str®®† •
;®®• ¶
break
©© !
;
©©! "
case
´´ 
$num
´´ 
:
´´ 
mensaje_denuncia
¨¨ ,
=
¨¨- .
$str¨¨/ à
;¨¨à â
break
≠≠ !
;
≠≠! "
case
ØØ 
$num
ØØ 
:
ØØ 
mensaje_denuncia
∞∞ ,
=
∞∞- .
$str
∞∞/ \
;
∞∞\ ]
break
±± !
;
±±! "
}
≥≥ 
string
µµ 
mensaje_Bloqueado
µµ ,
=
µµ- .
reg_denunciado
µµ/ =
.
µµ= >
Nombre
µµ> D
+
µµE F
mensaje_denuncia
µµG W
+
µµX Y
$strµµZ À
;µµÀ Ã
EnviarCorreo
∂∂  
(
∂∂  !
reg_denunciado
∂∂! /
.
∂∂/ 0
Correo
∂∂0 6
,
∂∂6 7
mensaje_Bloqueado
∂∂8 I
,
∂∂I J
$str
∂∂K ^
)
∂∂^ _
;
∂∂_ `

Registrado
∏∏ 
reg_denunciante
∏∏ .
=
∏∏/ 0
db
∏∏1 3
.
∏∏3 4
Registradoes
∏∏4 @
.
∏∏@ A
Find
∏∏A E
(
∏∏E F
denuncia
∏∏F N
.
∏∏N O
Denunciante
∏∏O Z
)
∏∏Z [
;
∏∏[ \
string
ππ !
mensaje_denunciante
ππ .
=
ππ/ 0
$strππ1 æ
+ππø ¿
reg_denunciadoππ¡ œ
.ππœ –
Nombreππ– ÷
+ππ÷ ◊
$strππÿ €
+ππ‹ ›
reg_denunciadoππ› Î
.ππÎ Ï
	Apellido1ππÏ ı
+ππı ˆ
$strππ¯ ≥
;ππ≥ ¥
EnviarCorreo
∫∫  
(
∫∫  !
reg_denunciante
∫∫! 0
.
∫∫0 1
Correo
∫∫1 7
,
∫∫7 8!
mensaje_denunciante
∫∫9 L
,
∫∫L M
$str∫∫N Ö
)∫∫Ö Ü
;∫∫Ü á
}
ªª 
}
ΩΩ 
foreach
øø 
(
øø 
var
øø 
denuncia
øø !
in
øø" $
	denuncias
øø% .
)
øø. /
{
¿¿ 
db
¡¡ 
.
¡¡ 
	Denuncias
¡¡ 
.
¡¡ 
Remove
¡¡ #
(
¡¡# $
denuncia
¡¡$ ,
)
¡¡, -
;
¡¡- .
}
¬¬ 
db
√√ 
.
√√ 
SaveChanges
√√ 
(
√√ 
)
√√ 
;
√√ 
return
∆∆ 
RedirectToAction
∆∆ #
(
∆∆# $
$str
∆∆$ +
)
∆∆+ ,
;
∆∆, -
}
«« 	
[
ÀÀ 	
HttpPost
ÀÀ	 
]
ÀÀ 
public
ÃÃ 
void
ÃÃ 
EnviarCorreo
ÃÃ  
(
ÃÃ  !
string
ÃÃ! '
correo
ÃÃ( .
,
ÃÃ. /
string
ÃÃ0 6
mensaje
ÃÃ7 >
,
ÃÃ> ?
string
ÃÃ@ F
asunto
ÃÃG M
)
ÃÃM N
{
ÕÕ 	
var
ŒŒ 
fromAddress
ŒŒ 
=
ŒŒ 
new
ŒŒ !
MailAddress
ŒŒ" -
(
ŒŒ- .
$str
ŒŒ. I
,
ŒŒI J
$str
ŒŒK Y
)
ŒŒY Z
;
ŒŒZ [
var
œœ 
	toAddress
œœ 
=
œœ 
new
œœ 
MailAddress
œœ  +
(
œœ+ ,
correo
œœ, 2
,
œœ2 3
$str
œœ4 F
)
œœF G
;
œœG H
const
–– 
string
–– 
fromPassword
–– %
=
––& '
$str
––( 4
;
––4 5
string
—— 
subject
—— 
=
—— 
asunto
—— #
;
——# $
string
““ 
body
““ 
=
““ 
mensaje
““ !
;
““! "
var
‘‘ 
smtp
‘‘ 
=
‘‘ 
new
‘‘ 

SmtpClient
‘‘ %
{
’’ 
Host
÷÷ 
=
÷÷ 
$str
÷÷ '
,
÷÷' (
Port
◊◊ 
=
◊◊ 
$num
◊◊ 
,
◊◊ 
	EnableSsl
ÿÿ 
=
ÿÿ 
true
ÿÿ  
,
ÿÿ  !
DeliveryMethod
ŸŸ 
=
ŸŸ   
SmtpDeliveryMethod
ŸŸ! 3
.
ŸŸ3 4
Network
ŸŸ4 ;
,
ŸŸ; <
Credentials
⁄⁄ 
=
⁄⁄ 
new
⁄⁄ !
NetworkCredential
⁄⁄" 3
(
⁄⁄3 4
fromAddress
⁄⁄4 ?
.
⁄⁄? @
Address
⁄⁄@ G
,
⁄⁄G H
fromPassword
⁄⁄I U
)
⁄⁄U V
,
⁄⁄V W
Timeout
‹‹ 
=
‹‹ 
$num
‹‹ 
}
›› 
;
›› 
using
ﬁﬁ 
(
ﬁﬁ 
var
ﬁﬁ 
message
ﬁﬁ 
=
ﬁﬁ  
new
ﬁﬁ! $
MailMessage
ﬁﬁ% 0
(
ﬁﬁ0 1
fromAddress
ﬁﬁ1 <
,
ﬁﬁ< =
	toAddress
ﬁﬁ> G
)
ﬁﬁG H
{
ﬂﬂ 
Subject
‡‡ 
=
‡‡ 
subject
‡‡ !
,
‡‡! "
Body
·· 
=
·· 
body
·· 
}
‚‚ 
)
‚‚ 
{
„„ 
smtp
‰‰ 
.
‰‰ 
Send
‰‰ 
(
‰‰ 
message
‰‰ !
)
‰‰! "
;
‰‰" #
}
ÂÂ 
}
ÊÊ 	
public
ÁÁ 
ActionResult
ÁÁ 
EliminarProducto
ÁÁ ,
(
ÁÁ, -
int
ÁÁ- 0
?
ÁÁ0 1

idProducto
ÁÁ2 <
,
ÁÁ< =
string
ÁÁ> D
correoDenunciado
ÁÁE U
,
ÁÁU V
string
ÁÁW ]
correoDenunciante
ÁÁ^ o
,
ÁÁo p
DateTime
ÁÁq y
fecha
ÁÁz 
)ÁÁ Ä
{
ËË 	
Producto
ÍÍ 
productoPorBorrar
ÍÍ &
=
ÍÍ' (
db
ÍÍ) +
.
ÍÍ+ ,

Productoes
ÍÍ, 6
.
ÍÍ6 7
Find
ÍÍ7 ;
(
ÍÍ; <

idProducto
ÍÍ< F
,
ÍÍF G
correoDenunciado
ÍÍG W
)
ÍÍW X
;
ÍÍX Y
Denuncia
ÎÎ 
denunciaPorBorrar
ÎÎ &
=
ÎÎ' (
db
ÎÎ) +
.
ÎÎ+ ,
	Denuncias
ÎÎ, 5
.
ÎÎ5 6
Find
ÎÎ6 :
(
ÎÎ: ;
fecha
ÎÎ; @
)
ÎÎ@ A
;
ÎÎA B
string
ÏÏ 
nombreProducto
ÏÏ !
;
ÏÏ! "
if
ÌÌ 
(
ÌÌ 
productoPorBorrar
ÌÌ !
!=
ÌÌ" $
null
ÌÌ% )
||
ÌÌ* ,
denunciaPorBorrar
ÌÌ- >
!=
ÌÌ? A
null
ÌÌB F
)
ÌÌF G
{
ÓÓ 
nombreProducto
ÔÔ 
=
ÔÔ  
productoPorBorrar
ÔÔ! 2
.
ÔÔ2 3
Nombre
ÔÔ3 9
;
ÔÔ9 :
db
 
.
 

Productoes
 
.
 
Remove
 $
(
$ %
productoPorBorrar
% 6
)
6 7
;
7 8
db
ÒÒ 
.
ÒÒ 
	Denuncias
ÒÒ 
.
ÒÒ 
Remove
ÒÒ #
(
ÒÒ# $
denunciaPorBorrar
ÒÒ$ 5
)
ÒÒ5 6
;
ÒÒ6 7
db
ÚÚ 
.
ÚÚ 
SaveChanges
ÚÚ 
(
ÚÚ 
)
ÚÚ  
;
ÚÚ  !

Registrado
ıı 

registrado
ıı %
=
ıı& '
db
ıı( *
.
ıı* +
Registradoes
ıı+ 7
.
ıı7 8
Find
ıı8 <
(
ıı< =
correoDenunciante
ıı= N
)
ııN O
;
ııO P
string
ˆˆ 
mensaje
ˆˆ 
=
ˆˆ  

registrado
ˆˆ! +
.
ˆˆ+ ,
Nombre
ˆˆ, 2
+
ˆˆ3 4
$strˆˆ5 ó
+ˆˆò ô
nombreProductoˆˆö ®
+ˆˆ© ™
$strˆˆ´ ¡
;ˆˆ¡ ¬
EnviarCorreo
˜˜ 
(
˜˜ 
correoDenunciante
˜˜ .
,
˜˜. /
mensaje
˜˜0 7
,
˜˜7 8
$str
˜˜9 R
)
˜˜R S
;
˜˜S T

registrado
˘˘ 
=
˘˘ 
db
˘˘ 
.
˘˘  
Registradoes
˘˘  ,
.
˘˘, -
Find
˘˘- 1
(
˘˘1 2
correoDenunciado
˘˘2 B
)
˘˘B C
;
˘˘C D
mensaje
˙˙ 
=
˙˙ 

registrado
˙˙ $
.
˙˙$ %
Nombre
˙˙% +
+
˙˙, -
$str
˙˙. S
+
˙˙T U
nombreProducto
˙˙V d
+
˙˙e f
$str˙˙g Æ
;˙˙Æ Ø
EnviarCorreo
˚˚ 
(
˚˚ 
correoDenunciado
˚˚ -
,
˚˚- .
mensaje
˚˚/ 6
,
˚˚6 7
$str
˚˚8 L
)
˚˚L M
;
˚˚M N
}
¸¸ 
return
˛˛ 
RedirectToAction
˛˛ #
(
˛˛# $
$str
˛˛$ +
)
˛˛+ ,
;
˛˛, -
}
ˇˇ 	
public
ÄÄ 
ActionResult
ÄÄ 

Suspension
ÄÄ &
(
ÄÄ& '
string
ÄÄ' -
correo
ÄÄ. 4
,
ÄÄ4 5
byte
ÄÄ6 :
tipo
ÄÄ; ?
,
ÄÄ? @
DateTime
ÄÄA I
fechaDenuncia
ÄÄJ W
)
ÄÄW X
{
ÅÅ 	
TempData
ÇÇ 
[
ÇÇ 
$str
ÇÇ #
]
ÇÇ# $
=
ÇÇ% &
DateTime
ÇÇ' /
.
ÇÇ/ 0
Today
ÇÇ0 5
.
ÇÇ5 6
AddDays
ÇÇ6 =
(
ÇÇ= >
$num
ÇÇ> @
)
ÇÇ@ A
;
ÇÇA B

Suspension
ÑÑ 
suspensions
ÑÑ "
=
ÑÑ# $
new
ÑÑ% (

Suspension
ÑÑ) 3
(
ÑÑ3 4
)
ÑÑ4 5
;
ÑÑ5 6
suspensions
ÖÖ 
.
ÖÖ 
Correo
ÖÖ 
=
ÖÖ  
correo
ÖÖ! '
;
ÖÖ' (
suspensions
ÜÜ 
.
ÜÜ 
TipoDenuncia
ÜÜ $
=
ÜÜ% &
tipo
ÜÜ' +
;
ÜÜ+ ,
suspensions
áá 
.
áá 
FechaInicio
áá #
=
áá$ %
DateTime
áá& .
.
áá. /
Today
áá/ 4
;
áá4 5
ViewBag
àà 
.
àà 
Correo
àà 
=
àà 
correo
àà #
;
àà# $
return
ââ 
View
ââ 
(
ââ 
suspensions
ââ #
)
ââ# $
;
ââ$ %
}
ãã 	
[
åå 	
HttpPost
åå	 
]
åå 
public
çç 
ActionResult
çç 

Suspension
çç &
(
çç& '
[
çç' (
Bind
çç( ,
(
çç, -
Include
çç- 4
=
çç5 6
$str
çç7 Y
)
ççY Z
]
ççZ [

Suspension
çç\ f

suspension
ççg q
)
ççq r
{
éé 	
string
êê 
correo
êê 
=
êê 

suspension
êê &
.
êê& '
Correo
êê' -
;
êê- .

Suspension
ëë 
suspension2
ëë "
=
ëë# $
db
ëë% '
.
ëë' (
Suspensions
ëë( 3
.
ëë3 4
Find
ëë4 8
(
ëë8 9
correo
ëë9 ?
)
ëë? @
;
ëë@ A
List
íí 
<
íí 
Denuncia
íí 
>
íí 
denuncia
íí #
=
íí$ %
new
íí& )
List
íí* .
<
íí. /
Denuncia
íí/ 7
>
íí7 8
(
íí8 9
)
íí9 :
;
íí: ;
foreach
ìì 
(
ìì 
var
ìì 
item
ìì 
in
ìì  
db
ìì! #
.
ìì# $
	Denuncias
ìì$ -
)
ìì- .
{
îî 
if
ïï 
(
ïï 
item
ïï 
.
ïï 

Denunciado
ïï #
==
ïï$ &
correo
ïï' -
)
ïï- .
{
ïï/ 0
denuncia
ññ 
.
ññ 
Add
ññ  
(
ññ  !
item
ññ! %
)
ññ% &
;
ññ& '
}
óó 
}
òò 
if
ôô 
(
ôô 
suspension2
ôô 
!=
ôô 
null
ôô "
)
ôô" #
{
öö 
suspension2
õõ 
.
õõ 
FechaInicio
õõ '
=
õõ( )

suspension
õõ* 4
.
õõ4 5
FechaInicio
õõ5 @
;
õõ@ A
suspension2
úú 
.
úú 
FechaFin
úú $
=
úú% &

suspension
úú' 1
.
úú1 2
FechaFin
úú2 :
;
úú: ;
suspension2
ùù 
.
ùù 
TipoDenuncia
ùù (
=
ùù) *

suspension
ùù+ 5
.
ùù5 6
TipoDenuncia
ùù6 B
;
ùùB C
}
ûû 
else
üü 
{
†† 
db
°° 
.
°° 
Suspensions
°° 
.
°° 
Add
°° "
(
°°" #

suspension
°°# -
)
°°- .
;
°°. /
}
¢¢ 
db
§§ 
.
§§ 
SaveChanges
§§ 
(
§§ 
)
§§ 
;
§§ 
Denuncia
•• 
	denuncia1
•• 
=
••  
denuncia
••! )
.
••) *
First
••* /
(
••/ 0
)
••0 1
;
••1 2 
ActualizarDenuncia
¶¶ 
(
¶¶ 
	denuncia1
¶¶ (
.
¶¶( )
Fecha
¶¶) .
)
¶¶. /
;
¶¶/ 0
string
™™  
mensaje_suspension
™™ %
=
™™& '
$str
™™( *
;
™™* +

Registrado
´´ 

registrado
´´ !
=
´´" #
db
´´$ &
.
´´& '
Registradoes
´´' 3
.
´´3 4
Find
´´4 8
(
´´8 9
correo
´´9 ?
)
´´? @
;
´´@ A
Producto
¨¨ 
producto
¨¨ 
=
¨¨ 
db
¨¨  "
.
¨¨" #

Productoes
¨¨# -
.
¨¨- .
Find
¨¨. 2
(
¨¨2 3
	denuncia1
¨¨3 <
.
¨¨< =

ProductoID
¨¨= G
,
¨¨G H
	denuncia1
¨¨I R
.
¨¨R S

Denunciado
¨¨S ]
)
¨¨] ^
;
¨¨^ _
if
ÆÆ 
(
ÆÆ 
(
ÆÆ 

registrado
ÆÆ 
!=
ÆÆ 
null
ÆÆ #
)
ÆÆ# $
&&
ÆÆ% '
(
ÆÆ( )
	denuncia1
ÆÆ) 2
!=
ÆÆ3 5
null
ÆÆ6 :
)
ÆÆ: ;
&&
ÆÆ< >
(
ÆÆ? @
producto
ÆÆ@ H
!=
ÆÆI K
null
ÆÆL P
)
ÆÆP Q
)
ÆÆQ R
{
ÆÆS T
var
±± 
url
±± 
=
±± 
$str
±± K
+
±±L M
Url
±±N Q
.
±±Q R
Encode
±±R X
(
±±X Y
correo
±±Y _
)
±±_ `
;
±±` a
var
≤≤ 
link
≤≤ 
=
≤≤ 
Request
≤≤ "
.
≤≤" #
Url
≤≤# &
.
≤≤& '
AbsoluteUri
≤≤' 2
.
≤≤2 3
Replace
≤≤3 :
(
≤≤: ;
Request
≤≤; B
.
≤≤B C
Url
≤≤C F
.
≤≤F G
PathAndQuery
≤≤G S
,
≤≤S T
url
≤≤U X
)
≤≤X Y
;
≤≤Y Z
switch
¥¥ 
(
¥¥ 
	denuncia1
¥¥ !
.
¥¥! "
Tipo
¥¥" &
-
¥¥' (
$num
¥¥) +
)
¥¥+ ,
{
µµ 
case
∂∂ 
$num
∂∂ 
:
∂∂  
mensaje_suspension
∑∑ *
=
∑∑+ ,
$str
∑∑- Y
+
∑∑Z [
producto
∑∑\ d
.
∑∑d e
Nombre
∑∑e k
+
∑∑l m
$str
∑∑n s
;
∑∑s t
break
∏∏ 
;
∏∏ 
case
∫∫ 
$num
∫∫ 
:
∫∫  
mensaje_suspension
ªª *
=
ªª+ ,
$str
ªª- K
;
ªªK L
break
ºº 
;
ºº 
case
ææ 
$num
ææ 
:
ææ  
mensaje_suspension
øø *
=
øø+ ,
$str
øø- o
+
øøp q
producto
øør z
.
øøz {
Nombreøø{ Å
+øøÇ É
$strøøÑ â
;øøâ ä
break
¿¿ 
;
¿¿ 
case
¬¬ 
$num
¬¬ 
:
¬¬  
mensaje_suspension
√√ *
=
√√+ ,
$str
√√- W
+
√√X Y
producto
√√Z b
.
√√b c
Nombre
√√c i
+
√√j k
$str
√√l q
;
√√q r
break
ƒƒ 
;
ƒƒ 
case
∆∆ 
$num
∆∆ 
:
∆∆  
mensaje_suspension
«« *
=
««+ ,
$str
««- T
;
««T U
break
»» 
;
»» 
case
   
$num
   
:
    
mensaje_suspension
ÀÀ *
=
ÀÀ+ ,
$str
ÀÀ- K
;
ÀÀK L
break
ÃÃ 
;
ÃÃ 
}
ŒŒ 
string
–– 
mensaje
–– 
=
––  

registrado
––! +
.
––+ ,
Nombre
––, 2
+
––3 4
$str
––5 o
+
––p q!
mensaje_suspension––r Ñ
+––Ö Ü
$str––á æ
+––ø ¿
link––¡ ≈
;––≈ ∆
EnviarCorreo
—— 
(
—— 
correo
—— #
,
——# $
mensaje
——% ,
,
——, -
$str
——. A
)
——A B
;
——B C
}
”” 
return
‘‘ 
RedirectToAction
‘‘ #
(
‘‘# $
$str
‘‘$ +
)
‘‘+ ,
;
‘‘, -
}
’’ 	
public
◊◊ 
ActionResult
◊◊  
ActualizarDenuncia
◊◊ .
(
◊◊. /
DateTime
◊◊/ 7
fecha
◊◊8 =
)
◊◊= >
{
ÿÿ 	
Denuncia
⁄⁄ 
	adicional
⁄⁄ 
=
⁄⁄  
db
⁄⁄! #
.
⁄⁄# $
	Denuncias
⁄⁄$ -
.
⁄⁄- .
Find
⁄⁄. 2
(
⁄⁄2 3
fecha
⁄⁄3 8
)
⁄⁄8 9
;
⁄⁄9 :
if
€€ 
(
€€ 
	adicional
€€ 
!=
€€ 
null
€€ !
)
€€! "
{
€€# $
foreach
‹‹ 
(
‹‹ 
var
‹‹ 
item
‹‹ !
in
‹‹" $
db
‹‹% '
.
‹‹' (
	Denuncias
‹‹( 1
)
‹‹1 2
{
›› 
if
ﬁﬁ 
(
ﬁﬁ 
item
ﬁﬁ 
.
ﬁﬁ 

Denunciado
ﬁﬁ #
==
ﬁﬁ$ &
	adicional
ﬁﬁ' 0
.
ﬁﬁ0 1

Denunciado
ﬁﬁ1 ;
&&
ﬁﬁ< >
item
ﬁﬁ? C
.
ﬁﬁC D
Tipo
ﬁﬁD H
<
ﬁﬁI J
$num
ﬁﬁK L
)
ﬁﬁL M
{
ﬂﬂ 
item
‡‡ 
.
‡‡ 
Tipo
‡‡ 
+=
‡‡  
$num
‡‡! #
;
‡‡# $
}
·· 
}
‚‚ 
db
„„ 
.
„„ 
SaveChanges
„„ 
(
„„ 
)
„„  
;
„„  !
}
ÂÂ 
return
ÊÊ 
RedirectToAction
ÊÊ #
(
ÊÊ# $
$str
ÊÊ$ +
)
ÊÊ+ ,
;
ÊÊ, -
}
ÁÁ 	
}
ÈÈ 
}ÍÍ Ë0
ÄC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\EstadisticasController.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Controllers" -
{ 
public 

class "
EstadisticasController '
:( )

Controller* 4
{ 
private 
TempPIEntities 
db !
=" #
new$ '
TempPIEntities( 6
(6 7
)7 8
;8 9
public 
ActionResult 
Index !
(! "
)" #
{ 	
string 
correo 
= 
( 
string #
)# $
HttpContext$ /
./ 0
Session0 7
[7 8
$str8 B
]B C
;C D
Administrador 
admin 
=  !
db" $
.$ %
Administradors% 3
.3 4
Find4 8
(8 9
correo9 ?
)? @
;@ A
if 
( 
admin 
== 
null 
) 
{ 
return 
RedirectToAction '
(' (
$str( 7
,7 8
$str9 E
)E F
;F G
} 
var 
usuario 
= 
from 
u  
in! #
db$ &
.& '"
Calificaciones_Cliente' =
select  
u! "
;" #
usuario 
= 
usuario 
. 
OrderBy %
(% &
u& '
=>( *
u+ ,
., -
Nombre- 3
)3 4
;4 5
return   
View   
(   
usuario   
.    
ToList    &
(  & '
)  ' (
)  ( )
;  ) *
}!! 	
public$$ 
ActionResult$$ 
Details$$ #
($$# $
int$$$ '
id$$( *
)$$* +
{%% 	
return&& 
View&& 
(&& 
)&& 
;&& 
}'' 	
public** 
ActionResult** 
Create** "
(**" #
)**# $
{++ 	
return,, 
View,, 
(,, 
),, 
;,, 
}-- 	
[00 	
HttpPost00	 
]00 
public11 
ActionResult11 
Create11 "
(11" #
FormCollection11# 1

collection112 <
)11< =
{22 	
try33 
{44 
return77 
RedirectToAction77 '
(77' (
$str77( /
)77/ 0
;770 1
}88 
catch99 
{:: 
return;; 
View;; 
(;; 
);; 
;;; 
}<< 
}== 	
public@@ 
ActionResult@@ 
Edit@@  
(@@  !
int@@! $
id@@% '
)@@' (
{AA 	
returnBB 
ViewBB 
(BB 
)BB 
;BB 
}CC 	
[FF 	
HttpPostFF	 
]FF 
publicGG 
ActionResultGG 
EditGG  
(GG  !
intGG! $
idGG% '
,GG' (
FormCollectionGG) 7

collectionGG8 B
)GGB C
{HH 	
tryII 
{JJ 
returnMM 
RedirectToActionMM '
(MM' (
$strMM( /
)MM/ 0
;MM0 1
}NN 
catchOO 
{PP 
returnQQ 
ViewQQ 
(QQ 
)QQ 
;QQ 
}RR 
}SS 	
publicVV 
ActionResultVV 
DeleteVV "
(VV" #
intVV# &
idVV' )
)VV) *
{WW 	
returnXX 
ViewXX 
(XX 
)XX 
;XX 
}YY 	
[\\ 	
HttpPost\\	 
]\\ 
public]] 
ActionResult]] 
Delete]] "
(]]" #
int]]# &
id]]' )
,]]) *
FormCollection]]+ 9

collection]]: D
)]]D E
{^^ 	
try__ 
{`` 
returncc 
RedirectToActioncc '
(cc' (
$strcc( /
)cc/ 0
;cc0 1
}dd 
catchee 
{ff 
returngg 
Viewgg 
(gg 
)gg 
;gg 
}hh 
}ii 	
publickk 
ActionResultkk 
TopUsuarioskk '
(kk' (
)kk( )
{ll 	
stringmm 
correomm 
=mm 
(mm 
stringmm #
)mm# $
HttpContextmm$ /
.mm/ 0
Sessionmm0 7
[mm7 8
$strmm8 B
]mmB C
;mmC D
Administradornn 
adminnn 
=nn  !
dbnn" $
.nn$ %
Administradorsnn% 3
.nn3 4
Findnn4 8
(nn8 9
correonn9 ?
)nn? @
;nn@ A
ifpp 
(pp 
adminpp 
==pp 
nullpp 
)pp 
{qq 
returnrr 
RedirectToActionrr '
(rr' (
$strrr( 7
,rr7 8
$strrr9 E
)rrE F
;rrF G
}ss 
varuu 
usuariouu 
=uu 
fromuu 
uuu  
inuu! #
dbuu$ &
.uu& '
ProductosUsuariosuu' 8
selectvv  
uvv! "
;vv" #
usuarioww 
=ww 
usuarioww 
.ww 
OrderByDescendingww /
(ww/ 0
uww0 1
=>ww2 4
uww5 6
.ww6 7
CantidadProductosww7 H
)wwH I
;wwI J
usuarioxx 
=xx 
usuarioxx 
.xx 
Takexx "
(xx" #
$numxx# %
)xx% &
;xx& '
returnyy 
Viewyy 
(yy 
usuarioyy 
.yy  
ToListyy  &
(yy& '
)yy' (
)yy( )
;yy) *
}zz 	
}~~ 
}ÄÄ ˇ"
xC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\HomeController.cs
	namespace 	*
Proyecto_Integrador_Bases_Inge
 (
.( )
Controllers) 4
{ 
public		 

class		 
HomeController		 
:		  !

Controller		" ,
{

 
public 
ActionResult 
Index !
(! "
)" #
{ 	
return 
RedirectToAction #
(# $
$str$ +
,+ ,
$str- >
)> ?
;? @
} 	
public 
ActionResult 
About !
(! "
)" #
{ 	
ViewBag 
. 
Message 
= 
$str B
;B C
return 
View 
( 
) 
; 
} 	
public 
ActionResult 
Contact #
(# $
)$ %
{ 	
ViewBag 
. 
Message 
= 
$str 2
;2 3
return 
View 
( 
) 
; 
} 	
public!! 
ActionResult!! 
EditarPerfil!! (
(!!( )
)!!) *
{"" 	
return## 
View## 
(## 
)## 
;## 
}$$ 	
public&& 
ActionResult&& 
Prueba1&& #
(&&# $
)&&$ %
{'' 	
return(( 
View(( 
((( 
)(( 
;(( 
})) 	
public++ 
ActionResult++ 
FormularioProducto++ .
(++. /
)++/ 0
{,, 	
ViewBag-- 
.-- 
Message-- 
=-- 
$str-- .
;--. /
return// 
View// 
(// 
)// 
;// 
}00 	
public22 
ActionResult22  
ProductosDisponibles22 0
(220 1
)221 2
{33 	
ViewBag44 
.44 
Message44 
=44 
$str44 ?
;44? @
return66 
View66 
(66 
)66 
;66 
}77 	
public99 
ActionResult99 
MisProductos99 (
(99( )
)99) *
{:: 	
ViewBag;; 
.;; 
Message;; 
=;; 
$str;; 2
;;;2 3
return== 
View== 
(== 
)== 
;== 
}>> 	
public@@ 
ActionResult@@ 
ListaUsuarios@@ )
(@@) *
)@@* +
{AA 	
returnBB 
ViewBB 
(BB 
)BB 
;BB 
}CC 	
publicEE 
ActionResultEE 
CondicionesUsoEE *
(EE* +
)EE+ ,
{FF 	
returnGG 
ViewGG 
(GG 
)GG 
;GG 
}HH 	
publicKK 
ActionResultKK "
VerRegistro_RegistradoKK 2
(KK2 3
)KK3 4
{LL 	
returnMM 
RedirectToActionMM #
(MM# $
$strMM$ .
,MM. /
$strMM0 <
)MM< =
;MM= >
}NN 	
publicPP 
ActionResultPP #
VerEditarPerfil_ClientePP 3
(PP3 4
)PP4 5
{QQ 	
returnRR 
RedirectToActionRR #
(RR# $
$strRR$ 2
,RR2 3
$strRR4 =
)RR= >
;RR> ?
}SS 	
publicVV 
ActionResultVV 
VerCreate_ProductoVV .
(VV. /
)VV/ 0
{WW 	
returnXX 
RedirectToActionXX #
(XX# $
$strXX$ ,
,XX, -
$strXX. 8
)XX8 9
;XX9 :
}YY 	
public^^ 
ActionResult^^ $
VerIndex_ProductosDelDia^^ 4
(^^4 5
)^^5 6
{__ 	
returnaa 
RedirectToActionaa #
(aa# $
$straa$ +
,aa+ ,
$straa- >
)aa> ?
;aa? @
}cc 	
publicff 
ActionResultff 
Errorff !
(ff! "
)ff" #
{ff$ %
returnii 
Viewii 
(ii 
)ii 
;ii 
}jj 	
}mm 
}nn √ƒ
ÅC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\NotificationsController.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Controllers" -
{ 
public 

class #
NotificationsController (
:) *

Controller+ 5
{ 
private 
TempPIEntities 
db !
=" #
new$ '
TempPIEntities( 6
(6 7
)7 8
;8 9
public## 
ActionResult## 
Recibe## "
(##" #
string### )
searchBy##* 2
,##2 3
string##4 :
currentFilter##; H
,##H I
string##J P
searchString##Q ]
,##] ^
int##_ b
?##b c
page##d h
)##h i
{$$ 	
var%% 
cookiecorreo%% 
=%% 
ControllerContext%% 0
.%%0 1
HttpContext%%1 <
.%%< =
Request%%= D
.%%D E
Cookies%%E L
[%%L M
$str%%M S
]%%S T
;%%T U
ViewBag)) 
.)) 
CurrentSort)) 
=))  !
searchBy))" *
;))* +
ViewBag** 
.** 
NameSortParm**  
=**! "
String**# )
.**) *
IsNullOrEmpty*** 7
(**7 8
searchBy**8 @
)**@ A
?**B C
$str**D N
:**O P
$str**Q S
;**S T
ViewBag++ 
.++ 
SortPriceParm++ !
=++" #
searchBy++$ ,
==++- /
$str++0 7
?++8 9
$str++: F
:++G H
$str++I P
;++P Q
if.. 
(.. 
searchString.. 
!=.. 
null..  $
)..$ %
{// 
page00 
=00 
$num00 
;00 
}11 
else22 
{33 
searchString44 
=44 
currentFilter44 ,
;44, -
}55 
ViewBag77 
.77 
CurrentFilter77 !
=77" #
searchString77$ 0
;770 1
var88 
products88 
=88 
db88 
.88 

Productoes88 (
.88( )
Include88) 0
(880 1
c881 2
=>883 5
c886 7
.887 8
Cliente888 ?
)88? @
;88@ A
var99 
	productos99 
=99 
from99  
p99! "
in99# %
db99& (
.99( )

Productoes99) 3
select:: "
p::# $
;::$ %
if== 
(== 
cookiecorreo== 
!=== 
null==  $
)==$ %
{>> 
	productos?? 
=?? 
	productos?? %
.??% &
Where??& +
(??+ ,
p??, -
=>??. 0
p??1 2
.??2 3
CorreoCliente??3 @
==??A C
cookiecorreo??D P
.??P Q
Value??Q V
)??V W
;??W X
	productos@@ 
=@@ 
	productos@@ %
.@@% &
Where@@& +
(@@+ ,
p@@, -
=>@@. 0
p@@1 2
.@@2 3
Estado@@3 9
==@@: <
true@@= A
)@@A B
;@@B C
}AA 
elseBB 
{CC 
returnFF 
ViewFF 
(FF 
$strFF #
,FF# $
$strFF% +
)FF+ ,
;FF, -
}HH 
ifMM 
(MM 
!MM 
StringMM 
.MM 
IsNullOrEmptyMM %
(MM% &
searchStringMM& 2
)MM2 3
)MM3 4
{NN 
	productosOO 
=OO 
	productosOO %
.OO% &
WhereOO& +
(OO+ ,
pOO, -
=>OO. 0
pOO1 2
.OO2 3
NombreOO3 9
.OO9 :
ContainsOO: B
(OOB C
searchStringOOC O
)OOO P
)OOP Q
;OOQ R
}PP 
switchSS 
(SS 
searchBySS 
)SS 
{TT 
caseUU 
$strUU 
:UU  
	productosVV 
=VV 
	productosVV  )
.VV) *
OrderByVV* 1
(VV1 2
pVV2 3
=>VV4 6
pVV7 8
.VV8 9
NombreVV9 ?
)VV? @
;VV@ A
breakWW 
;WW 
caseYY 
$strYY !
:YY! "
	productosZZ 
=ZZ 
	productosZZ  )
.ZZ) *
OrderByDescendingZZ* ;
(ZZ; <
pZZ< =
=>ZZ> @
pZZA B
.ZZB C
PrecioEstimadoZZC Q
)ZZQ R
;ZZR S
break[[ 
;[[ 
case\\ 
$str\\ 
:\\ 
	productos]] 
=]] 
	productos]]  )
.]]) *
OrderBy]]* 1
(]]1 2
p]]2 3
=>]]4 6
p]]7 8
.]]8 9
PrecioEstimado]]9 G
)]]G H
;]]H I
break^^ 
;^^ 
default__ 
:__ 
	productos`` 
=`` 
	productos``  )
.``) *
OrderBy``* 1
(``1 2
p``2 3
=>``4 6
p``7 8
.``8 9
Nombre``9 ?
)``? @
;``@ A
breakaa 
;aa 
}bb 
intdd 
pageSizedd 
=dd 
$numdd 
;dd 
intee 

pageNumberee 
=ee 
(ee 
pageee "
??ee# %
$numee& '
)ee' (
;ee( )
returnff 
Viewff 
(ff 
	productosff !
.ff! "
ToPagedListff" -
(ff- .

pageNumberff. 8
,ff8 9
pageSizeff: B
)ffB C
)ffC D
;ffD E
}gg 	
publicii 
ActionResultii 
	Solicitudii %
(ii% &
intii& )
p1ii* ,
)ii, -
{jj 	
stringkk 
correoActualkk 
=kk  !
(kk" #
stringkk# )
)kk) *
HttpContextkk* 5
.kk5 6
Sessionkk6 =
[kk= >
$strkk> H
]kkH I
;kkI J
ViewBagll 
.ll 
p1ll 
=ll 
p1ll 
;ll 
ViewBagmm 
.mm 
correomm 
=mm 
correoActualmm )
;mm) *
intoo 
	producto1oo 
=oo 
p1oo 
;oo 
TruequeModelsqq 
tmodelqq  
=qq! "
newqq# &
TruequeModelsqq' 4
(qq4 5
)qq5 6
;qq6 7
varrr 
truequesrr 
=rr 
dbrr 
.rr 
Truequesrr &
.rr& '
Includerr' .
(rr. /
trr/ 0
=>rr1 3
trr4 5
.rr5 6
Productorr6 >
)rr> ?
.rr? @
Includerr@ G
(rrG H
trrH I
=>rrJ L
trrM N
.rrN O
	Producto1rrO X
)rrX Y
;rrY Z
varss 
	truequesBss 
=ss 
fromss  
pss! "
inss# %
dbss& (
.ss( )
Truequesss) 1
selecttt "
ptt# $
;tt$ %
varuu 
	truequesCuu 
=uu 
fromuu  
muu! "
inuu# %
dbuu& (
.uu( )
Truequesuu) 1
selectvv "
mvv# $
;vv$ %
ifyy 
(yy 
correoActualyy 
!=yy 
nullyy  $
)yy$ %
{zz 
	truequesB{{ 
={{ 
	truequesB{{ %
.{{% &
Where{{& +
({{+ ,
p{{, -
=>{{. 0
p{{1 2
.{{2 3
CorreoPublicador{{3 C
=={{D F
correoActual{{G S
&&{{T V
p{{W X
.{{X Y 
ProductoIDPublicador{{Y m
=={{n p
p1{{q s
){{s t
;{{t u
}|| 
else}} 
{~~ 
return
ÄÄ 
RedirectToAction
ÄÄ '
(
ÄÄ' (
$str
ÄÄ( 7
,
ÄÄ7 8
$str
ÄÄ9 E
)
ÄÄE F
;
ÄÄF G
}
ÇÇ 
tmodel
ÑÑ 
.
ÑÑ 
Trueques
ÑÑ 
=
ÑÑ 
	truequesB
ÑÑ '
.
ÑÑ' (
ToList
ÑÑ( .
(
ÑÑ. /
)
ÑÑ/ 0
;
ÑÑ0 1
var
ÜÜ 
products
ÜÜ 
=
ÜÜ 
db
ÜÜ 
.
ÜÜ 

Productoes
ÜÜ (
.
ÜÜ( )
Include
ÜÜ) 0
(
ÜÜ0 1
c
ÜÜ1 2
=>
ÜÜ3 5
c
ÜÜ6 7
.
ÜÜ7 8
Cliente
ÜÜ8 ?
)
ÜÜ? @
;
ÜÜ@ A
var
áá 
	productos
áá 
=
áá 
from
áá  
ps
áá! #
in
áá$ &
db
áá' )
.
áá) *

Productoes
áá* 4
select
àà "
ps
àà# %
;
àà% &
List
ââ 
<
ââ 
Producto
ââ 
>
ââ 
prod
ââ 
=
ââ  !
new
ââ" %
List
ââ& *
<
ââ* +
Producto
ââ+ 3
>
ââ3 4
(
ââ4 5
)
ââ5 6
;
ââ6 7
foreach
ää 
(
ää 
var
ää 
item
ää 
in
ää  
	truequesB
ää! *
)
ää* +
{
ää, -
foreach
ãã 
(
ãã 
var
ãã 
item2
ãã !
in
ãã" $
	productos
ãã% .
)
ãã. /
if
åå 
(
åå 
item
åå 
.
åå 
CorreoOfertante
åå ,
==
åå- /
item2
åå0 5
.
åå5 6
CorreoCliente
åå6 C
&&
ååD F
item
ååG K
.
ååK L!
ProductoIDOfertante
ååL _
==
åå` b
item2
ååc h
.
ååh i

ProductoID
ååi s
)
åås t
{
çç 
prod
éé 
.
éé 
Add
éé  
(
éé  !
item2
éé! &
)
éé& '
;
éé' (
}
èè 
}
ëë 
tmodel
îî 
.
îî 
	Productos
îî 
=
îî 
prod
îî #
.
îî# $
ToList
îî$ *
(
îî* +
)
îî+ ,
;
îî, -
var
óó 
clientes
óó 
=
óó 
db
óó 
.
óó 
Clientes
óó &
.
óó& '
Include
óó' .
(
óó. /
c
óó/ 0
=>
óó1 3
c
óó4 5
.
óó5 6

Registrado
óó6 @
)
óó@ A
;
óóA B
tmodel
òò 
.
òò 
Clientes
òò 
=
òò 
clientes
òò &
.
òò& '
ToList
òò' -
(
òò- .
)
òò. /
;
òò/ 0
return
öö 
View
öö 
(
öö 
tmodel
öö 
)
öö 
;
öö  
}
õõ 	
public
ûû 
ActionResult
ûû 
FormularioEntrega
ûû -
(
ûû- .
)
ûû. /
{
üü 	
return
§§ 
View
§§ 
(
§§ 
$str
§§ +
)
§§+ ,
;
§§, -
}
¶¶ 	
public
©© 
ActionResult
©© (
DetallesProductosOfertados
©© 6
(
©©6 7
int
©©7 :
id
©©; =
,
©©= >
string
©©? E
correo
©©F L
,
©©L M
int
©©N Q
p1
©©R T
,
©©T U
string
©©V \
correoOfertante
©©] l
)
©©l m
{
™™ 	
string
´´ 
correoActual
´´ 
=
´´  !
(
´´" #
string
´´# )
)
´´) *
HttpContext
´´* 5
.
´´5 6
Session
´´6 =
[
´´= >
$str
´´> H
]
´´H I
;
´´I J
ViewBag
¨¨ 
.
¨¨ 
p1
¨¨ 
=
¨¨ 
p1
¨¨ 
;
¨¨ 
ViewBag
≠≠ 
.
≠≠ 
correoOfertante
≠≠ #
=
≠≠$ %
correoOfertante
≠≠& 5
;
≠≠5 6
if
∞∞ 
(
∞∞ 
id
∞∞ 
==
∞∞ 
null
∞∞ 
)
∞∞ 
{
±± 
return
≤≤ 
new
≤≤ "
HttpStatusCodeResult
≤≤ /
(
≤≤/ 0
HttpStatusCode
≤≤0 >
.
≤≤> ?

BadRequest
≤≤? I
)
≤≤I J
;
≤≤J K
}
≥≥ 
Producto
¥¥ 
producto
¥¥ 
=
¥¥ 
db
¥¥  "
.
¥¥" #

Productoes
¥¥# -
.
¥¥- .
Find
¥¥. 2
(
¥¥2 3
id
¥¥3 5
,
¥¥5 6
correo
¥¥7 =
)
¥¥= >
;
¥¥> ?
if
µµ 
(
µµ 
producto
µµ 
.
µµ 
ProductoImagen1
µµ (
==
µµ) +
null
µµ, 0
)
µµ0 1
{
∂∂ 
byte
∑∑ 
[
∑∑ 
]
∑∑ 
image
∑∑ 
=
∑∑ 
new
∑∑ "
	WebClient
∑∑# ,
(
∑∑, -
)
∑∑- .
.
∑∑. /
DownloadData
∑∑/ ;
(
∑∑; <
$str∑∑< ¶
)∑∑¶ ß
;∑∑ß ®
var
∏∏ 
base64Image
∏∏ 
=
∏∏  !
Convert
∏∏" )
.
∏∏) *
ToBase64String
∏∏* 8
(
∏∏8 9
image
∏∏9 >
)
∏∏> ?
;
∏∏? @
TempData
ππ 
[
ππ 
$str
ππ 
]
ππ 
=
ππ  !
base64Image
ππ" -
;
ππ- .
}
∫∫ 
else
ªª 
{
ºº 
var
ΩΩ 
base64Image
ΩΩ 
=
ΩΩ  !
Convert
ΩΩ" )
.
ΩΩ) *
ToBase64String
ΩΩ* 8
(
ΩΩ8 9
producto
ΩΩ9 A
.
ΩΩA B
ProductoImagen1
ΩΩB Q
)
ΩΩQ R
;
ΩΩR S
TempData
ææ 
[
ææ 
$str
ææ 
]
ææ 
=
ææ  !
base64Image
ææ" -
;
ææ- .
}
øø 
if
¡¡ 
(
¡¡ 
producto
¡¡ 
==
¡¡ 
null
¡¡  
)
¡¡  !
{
¬¬ 
return
√√ 
HttpNotFound
√√ #
(
√√# $
)
√√$ %
;
√√% &
}
ƒƒ 
var
∆∆  
productosVirtuales
∆∆ "
=
∆∆# $
from
∆∆% )
p
∆∆* +
in
∆∆, .
db
∆∆/ 1
.
∆∆1 2
Virtuals
∆∆2 :
select
««% +
p
««, -
;
««- .
ViewBag
…… 
.
……  
productosVirtuales
…… &
=
……' ( 
productosVirtuales
……) ;
;
……; <
return
ÃÃ 
View
ÃÃ 
(
ÃÃ 
producto
ÃÃ  
)
ÃÃ  !
;
ÃÃ! "
}
ÕÕ 	
public
–– 
ActionResult
–– 
Delete
–– "
(
––" #
int
––# &
p1
––' )
,
––) *
string
––, 2
correo
––3 9
)
––9 :
{
—— 	
string
““ 
correoActual
““ 
=
““  !
(
““" #
string
““# )
)
““) *
HttpContext
““* 5
.
““5 6
Session
““6 =
[
““= >
$str
““> H
]
““H I
;
““I J
TruequeModels
‘‘ 
tmodel
‘‘  
=
‘‘! "
new
‘‘# &
TruequeModels
‘‘' 4
(
‘‘4 5
)
‘‘5 6
;
‘‘6 7
var
÷÷ 
trueques
÷÷ 
=
÷÷ 
db
÷÷ 
.
÷÷ 
Trueques
÷÷ &
.
÷÷& '
Include
÷÷' .
(
÷÷. /
t
÷÷/ 0
=>
÷÷1 3
t
÷÷4 5
.
÷÷5 6
Producto
÷÷6 >
)
÷÷> ?
.
÷÷? @
Include
÷÷@ G
(
÷÷G H
t
÷÷H I
=>
÷÷J L
t
÷÷M N
.
÷÷N O
	Producto1
÷÷O X
)
÷÷X Y
;
÷÷Y Z
var
◊◊ 
	truequesB
◊◊ 
=
◊◊ 
from
◊◊  
p
◊◊! "
in
◊◊# %
db
◊◊& (
.
◊◊( )
Trueques
◊◊) 1
select
ÿÿ "
p
ÿÿ# $
;
ÿÿ$ %
if
ÂÂ 
(
ÂÂ 
correoActual
ÂÂ 
!=
ÂÂ 
null
ÂÂ  $
)
ÂÂ$ %
{
ÊÊ 
	truequesB
ÁÁ 
=
ÁÁ 
	truequesB
ÁÁ %
.
ÁÁ% &
Where
ÁÁ& +
(
ÁÁ+ ,
p
ÁÁ, -
=>
ÁÁ. 0
p
ÁÁ1 2
.
ÁÁ2 3
CorreoPublicador
ÁÁ3 C
==
ÁÁD F
correoActual
ÁÁG S
&&
ÁÁT V
p
ÁÁW X
.
ÁÁX Y"
ProductoIDPublicador
ÁÁY m
==
ÁÁn p
p1
ÁÁq s
&&
ÁÁt v
p
ÁÁw x
.
ÁÁx y
CorreoOfertanteÁÁy à
==ÁÁâ ã
correoÁÁå í
)ÁÁí ì
;ÁÁì î
}
ËË 
else
ÈÈ 
{
ÍÍ 
return
ÏÏ 
RedirectToAction
ÏÏ '
(
ÏÏ' (
$str
ÏÏ( 7
,
ÏÏ7 8
$str
ÏÏ9 E
)
ÏÏE F
;
ÏÏF G
}
ÌÌ 
var
˜˜ 
body1
˜˜ 
=
˜˜ 
$"
˜˜ 
$str
˜˜ =
{
˜˜= >
correo
˜˜> D
}
˜˜D E
$str˜˜E ü
"˜˜ü †
;˜˜† °
body1
¯¯ 
.
¯¯ 
Replace
¯¯ 
(
¯¯ 
$str
¯¯ 
,
¯¯ 
Environment
¯¯  +
.
¯¯+ ,
NewLine
¯¯, 3
)
¯¯3 4
;
¯¯4 5
var
˘˘ 
body2
˘˘ 
=
˘˘ 
$"
˘˘ 
$str
˘˘ =
{
˘˘= >
correoActual
˘˘> J
}
˘˘J K
$str˘˘K •
"˘˘• ¶
;˘˘¶ ß
body2
˙˙ 
.
˙˙ 
Replace
˙˙ 
(
˙˙ 
$str
˙˙ 
,
˙˙ 
Environment
˙˙  +
.
˙˙+ ,
NewLine
˙˙, 3
)
˙˙3 4
;
˙˙4 5
EnviarCorreo
¸¸ 
(
¸¸ 
correoActual
¸¸ %
,
¸¸% &
body1
¸¸' ,
)
¸¸, -
;
¸¸- .
EnviarCorreo
˝˝ 
(
˝˝ 
correo
˝˝ 
,
˝˝  
body2
˝˝! &
)
˝˝& '
;
˝˝' (
db
ÄÄ 
.
ÄÄ 
Trueques
ÄÄ 
.
ÄÄ 
RemoveRange
ÄÄ #
(
ÄÄ# $
	truequesB
ÄÄ$ -
)
ÄÄ- .
;
ÄÄ. /
db
ÅÅ 
.
ÅÅ 
SaveChanges
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ 
return
ÇÇ 
RedirectToAction
ÇÇ #
(
ÇÇ# $
$str
ÇÇ$ ,
)
ÇÇ, -
;
ÇÇ- .
}
ÉÉ 	
	protected
áá 
override
áá 
void
áá 
Dispose
áá  '
(
áá' (
bool
áá( ,
	disposing
áá- 6
)
áá6 7
{
àà 	
if
ââ 
(
ââ 
	disposing
ââ 
)
ââ 
{
ää 
db
ãã 
.
ãã 
Dispose
ãã 
(
ãã 
)
ãã 
;
ãã 
}
åå 
base
çç 
.
çç 
Dispose
çç 
(
çç 
	disposing
çç "
)
çç" #
;
çç# $
}
éé 	
public
êê 
ActionResult
êê 
MisTrueques
êê '
(
êê' (
)
êê( )
{
ëë 	
string
íí 
correoActual
íí 
=
íí  !
(
íí" #
string
íí# )
)
íí) *
HttpContext
íí* 5
.
íí5 6
Session
íí6 =
[
íí= >
$str
íí> H
]
ííH I
;
ííI J
TruequeModels
ïï 
tmodel
ïï  
=
ïï! "
new
ïï# &
TruequeModels
ïï' 4
(
ïï4 5
)
ïï5 6
;
ïï6 7
var
ññ 
trueques
ññ 
=
ññ 
db
ññ 
.
ññ 
Trueques
ññ &
.
ññ& '
Include
ññ' .
(
ññ. /
t
ññ/ 0
=>
ññ1 3
t
ññ4 5
.
ññ5 6
Producto
ññ6 >
)
ññ> ?
.
ññ? @
Include
ññ@ G
(
ññG H
t
ññH I
=>
ññJ L
t
ññM N
.
ññN O
	Producto1
ññO X
)
ññX Y
;
ññY Z
var
óó 
	truequesB
óó 
=
óó 
from
óó  
p
óó! "
in
óó# %
db
óó& (
.
óó( )
Trueques
óó) 1
select
òò "
p
òò# $
;
òò$ %
if
úú 
(
úú 
correoActual
úú 
!=
úú 
null
úú  $
)
úú$ %
{
ùù 
	truequesB
ûû 
=
ûû 
	truequesB
ûû %
.
ûû% &
Where
ûû& +
(
ûû+ ,
p
ûû, -
=>
ûû. 0
p
ûû1 2
.
ûû2 3
CorreoPublicador
ûû3 C
==
ûûD F
correoActual
ûûG S
)
ûûS T
;
ûûT U
}
üü 
else
†† 
{
°° 
return
¢¢ 
RedirectToAction
¢¢ '
(
¢¢' (
$str
¢¢( 7
,
¢¢7 8
$str
¢¢9 E
)
¢¢E F
;
¢¢F G
}
££ 
tmodel
¶¶ 
.
¶¶ 
Trueques
¶¶ 
=
¶¶ 
	truequesB
¶¶ '
.
¶¶' (
ToList
¶¶( .
(
¶¶. /
)
¶¶/ 0
;
¶¶0 1
var
®® 
products
®® 
=
®® 
db
®® 
.
®® 

Productoes
®® (
.
®®( )
Include
®®) 0
(
®®0 1
c
®®1 2
=>
®®3 5
c
®®6 7
.
®®7 8
Cliente
®®8 ?
)
®®? @
;
®®@ A
var
©© 
	productos
©© 
=
©© 
from
©©  
ps
©©! #
in
©©$ &
db
©©' )
.
©©) *

Productoes
©©* 4
select
™™ "
ps
™™# %
;
™™% &
tmodel
≠≠ 
.
≠≠ 
	Productos
≠≠ 
=
≠≠ 
products
≠≠ '
.
≠≠' (
ToList
≠≠( .
(
≠≠. /
)
≠≠/ 0
;
≠≠0 1
return
ØØ 
View
ØØ 
(
ØØ 
tmodel
ØØ 
)
ØØ 
;
ØØ  
}
∞∞ 	
public
≥≥ 
ActionResult
≥≥ 
VerSignUp_Usuario
≥≥ -
(
≥≥- .
)
≥≥. /
{
¥¥ 	
return
µµ 
RedirectToAction
µµ #
(
µµ# $
$str
µµ$ ,
,
µµ, -
$str
µµ. 7
)
µµ7 8
;
µµ8 9
}
∂∂ 	
[
ºº 	
HttpPost
ºº	 
]
ºº 
public
ΩΩ 
ActionResult
ΩΩ 
EnviarCorreo
ΩΩ (
(
ΩΩ( )
string
ΩΩ) /
correo
ΩΩ0 6
,
ΩΩ6 7
string
ΩΩ8 >
bodyMessage
ΩΩ? J
)
ΩΩJ K
{
ææ 	
var
øø 
fromAddress
øø 
=
øø 
new
øø !
MailAddress
øø" -
(
øø- .
$str
øø. I
,
øøI J
$str
øøK Y
)
øøY Z
;
øøZ [
var
¿¿ 
	toAddress
¿¿ 
=
¿¿ 
new
¿¿ 
MailAddress
¿¿  +
(
¿¿+ ,
correo
¿¿, 2
,
¿¿2 3
$str
¿¿4 F
)
¿¿F G
;
¿¿G H
const
¡¡ 
string
¡¡ 
fromPassword
¡¡ %
=
¡¡& '
$str
¡¡( 4
;
¡¡4 5
const
¬¬ 
string
¬¬ 
subject
¬¬  
=
¬¬! "
$str
¬¬# @
;
¬¬@ A
string
√√ 
body
√√ 
=
√√ 
bodyMessage
√√ %
;
√√% &
var
≈≈ 
smtp
≈≈ 
=
≈≈ 
new
≈≈ 

SmtpClient
≈≈ %
{
∆∆ 
Host
«« 
=
«« 
$str
«« '
,
««' (
Port
»» 
=
»» 
$num
»» 
,
»» 
	EnableSsl
…… 
=
…… 
true
……  
,
……  !
DeliveryMethod
   
=
     
SmtpDeliveryMethod
  ! 3
.
  3 4
Network
  4 ;
,
  ; <
Credentials
ÀÀ 
=
ÀÀ 
new
ÀÀ !
NetworkCredential
ÀÀ" 3
(
ÀÀ3 4
fromAddress
ÀÀ4 ?
.
ÀÀ? @
Address
ÀÀ@ G
,
ÀÀG H
fromPassword
ÀÀI U
)
ÀÀU V
,
ÀÀV W
Timeout
ÕÕ 
=
ÕÕ 
$num
ÕÕ 
}
ŒŒ 
;
ŒŒ 
using
œœ 
(
œœ 
var
œœ 
message
œœ 
=
œœ  
new
œœ! $
MailMessage
œœ% 0
(
œœ0 1
fromAddress
œœ1 <
,
œœ< =
	toAddress
œœ> G
)
œœG H
{
–– 
Subject
—— 
=
—— 
subject
—— !
,
——! "
Body
““ 
=
““ 
body
““ 
}
”” 
)
”” 
{
‘‘ 
smtp
’’ 
.
’’ 
Send
’’ 
(
’’ 
message
’’ !
)
’’! "
;
’’" #
}
÷÷ 
return
◊◊ 
View
◊◊ 
(
◊◊ 
)
◊◊ 
;
◊◊ 
}
ÿÿ 	
}
ﬁﬁ 
}ﬂﬂ íü
{C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\OfertasController.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Controllers" -
{ 
public 

class 
OfertasController "
:# $

Controller% /
{ 
private 
TempPIEntities 
db !
=" #
new$ '
TempPIEntities( 6
(6 7
)7 8
;8 9
public 
ActionResult 
Index !
(! "
string" (
searchBy) 1
,1 2
string3 9
currentFilter: G
,G H
stringI O
searchStringP \
,\ ]
int^ a
?a b
pagec g
)g h
{ 	
string 
correoActual 
=  !
(" #
string# )
)) *
HttpContext* 5
.5 6
Session6 =
[= >
$str> H
]H I
;I J
if 
( 
correoActual 
== 
$str  "
)" #
return 
RedirectToAction '
(' (
$str( 7
,7 8
$str9 E
)E F
;F G
	Desmarcar 
( 
) 
; 
ViewBag!! 
.!! 
CurrentSort!! 
=!!  !
searchBy!!" *
;!!* +
ViewBag"" 
."" 
NameSortParm""  
=""! "
String""# )
."") *
IsNullOrEmpty""* 7
(""7 8
searchBy""8 @
)""@ A
?""B C
$str""D N
:""O P
$str""Q S
;""S T
ViewBag## 
.## 
SortPriceParm## !
=##" #
searchBy##$ ,
==##- /
$str##0 7
?##8 9
$str##: F
:##G H
$str##I P
;##P Q
if(( 
((( 
searchString(( 
!=(( 
null((  $
)(($ %
{)) 
page** 
=** 
$num** 
;** 
}++ 
else,, 
{-- 
searchString.. 
=.. 
currentFilter.. ,
;.., -
}// 
ViewBag11 
.11 
CurrentFilter11 !
=11" #
searchString11$ 0
;110 1
var22 
products22 
=22 
db22 
.22 

Productoes22 (
.22( )
Include22) 0
(220 1
c221 2
=>223 5
c226 7
.227 8
Cliente228 ?
)22? @
;22@ A
var33 
	productos33 
=33 
from33  
p33! "
in33# %
db33& (
.33( )

Productoes33) 3
select44 "
p44# $
;44$ %
	productos77 
=77 
	productos77 !
.77! "
Where77" '
(77' (
p77( )
=>77* ,
p77- .
.77. /
Estado77/ 5
==776 8
true779 =
)77= >
;77> ?
if>> 
(>> 
!>> 
String>> 
.>> 
IsNullOrEmpty>> %
(>>% &
searchString>>& 2
)>>2 3
)>>3 4
{?? 
	productos@@ 
=@@ 
	productos@@ %
.@@% &
Where@@& +
(@@+ ,
p@@, -
=>@@. 0
p@@1 2
.@@2 3
Nombre@@3 9
.@@9 :
Contains@@: B
(@@B C
searchString@@C O
)@@O P
)@@P Q
;@@Q R
}AA 
switchDD 
(DD 
searchByDD 
)DD 
{EE 
caseFF 
$strFF 
:FF  
	productosGG 
=GG 
	productosGG  )
.GG) *
OrderByGG* 1
(GG1 2
pGG2 3
=>GG4 6
pGG7 8
.GG8 9
NombreGG9 ?
)GG? @
;GG@ A
breakHH 
;HH 
caseJJ 
$strJJ !
:JJ! "
	productosKK 
=KK 
	productosKK  )
.KK) *
OrderByDescendingKK* ;
(KK; <
pKK< =
=>KK> @
pKKA B
.KKB C
PrecioEstimadoKKC Q
)KKQ R
;KKR S
breakLL 
;LL 
caseMM 
$strMM 
:MM 
	productosNN 
=NN 
	productosNN  )
.NN) *
OrderByNN* 1
(NN1 2
pNN2 3
=>NN4 6
pNN7 8
.NN8 9
PrecioEstimadoNN9 G
)NNG H
;NNH I
breakOO 
;OO 
defaultPP 
:PP 
	productosQQ 
=QQ 
	productosQQ  )
.QQ) *
OrderByQQ* 1
(QQ1 2
pQQ2 3
=>QQ4 6
pQQ7 8
.QQ8 9
NombreQQ9 ?
)QQ? @
;QQ@ A
breakRR 
;RR 
}TT 
intWW 
pageSizeWW 
=WW 
$numWW 
;WW 
intXX 

pageNumberXX 
=XX 
(XX 
pageXX "
??XX# %
$numXX& '
)XX' (
;XX( )
returnZZ 
ViewZZ 
(ZZ 
	productosZZ !
.ZZ! "
ToPagedListZZ" -
(ZZ- .

pageNumberZZ. 8
,ZZ8 9
pageSizeZZ: B
)ZZB C
)ZZC D
;ZZD E
}[[ 	
public]] 
ActionResult]] 
Details]] #
(]]# $
int]]$ '
?]]' (
id]]) +
,]]+ ,
string]]- 3
correo]]4 :
)]]: ;
{^^ 	
	Desmarcar__ 
(__ 
)__ 
;__ 
var`` 
cookiecorreo`` 
=`` 
ControllerContext`` 0
.``0 1
HttpContext``1 <
.``< =
Request``= D
.``D E
Cookies``E L
[``L M
$str``M S
]``S T
;``T U
ViewBagbb 
.bb 
	esClientebb 
=bb 
truebb  $
;bb$ %
ifcc 
(cc 
cookiecorreocc 
==cc 
nullcc  $
)cc$ %
{dd 
ViewBagee 
.ee 
	esClienteee !
=ee" #
falseee$ )
;ee) *
}ff 
ifgg 
(gg 
idgg 
==gg 
nullgg 
)gg 
{hh 
returnii 
newii  
HttpStatusCodeResultii /
(ii/ 0
HttpStatusCodeii0 >
.ii> ?

BadRequestii? I
)iiI J
;iiJ K
}jj 
Productokk 
productokk 
=kk 
dbkk  "
.kk" #

Productoeskk# -
.kk- .
Findkk. 2
(kk2 3
idkk3 5
,kk5 6
correokk7 =
)kk= >
;kk> ?
ifll 
(ll 
productoll 
==ll 
nullll  
)ll  !
{mm 
returnnn 
HttpNotFoundnn #
(nn# $
)nn$ %
;nn% &
}oo 
varpp 
productosVirtualespp "
=pp" #
frompp$ (
ppp) *
inpp+ -
dbpp. 0
.pp0 1
Virtualspp1 9
selectqq# )
pqq* +
;qq+ ,
ViewBagss 
.ss 
productosVirtualesss &
=ss' (
productosVirtualesss) ;
;ss; <
returnuu 
Viewuu 
(uu 
productouu  
)uu  !
;uu! "
}vv 	
publicxx 
ActionResultxx 
MisProductosModalxx -
(xx- .
stringxx. 4
searchByxx5 =
,xx= >
stringxx? E
currentFilterxxF S
,xxS T
stringxxU [
searchStringxx\ h
,xxh i
intxxj m
?xxm n
pagexxo s
)xxs t
{yy 	
string{{ 
correoActual{{ 
={{  !
({{" #
string{{# )
){{) *
HttpContext{{* 5
.{{5 6
Session{{6 =
[{{= >
$str{{> H
]{{H I
;{{I J
ViewBag}} 
.}} 
CurrentSort}} 
=}}  !
searchBy}}" *
;}}* +
ViewBag~~ 
.~~ 
NameSortParm~~  
=~~! "
String~~# )
.~~) *
IsNullOrEmpty~~* 7
(~~7 8
searchBy~~8 @
)~~@ A
?~~B C
$str~~D N
:~~O P
$str~~Q S
;~~S T
ViewBag 
. 
SortPriceParm !
=" #
searchBy$ ,
==- /
$str0 7
?8 9
$str: F
:G H
$strI P
;P Q
if
ÖÖ 
(
ÖÖ 
searchString
ÖÖ 
!=
ÖÖ 
null
ÖÖ  $
)
ÖÖ$ %
{
ÜÜ 
page
áá 
=
áá 
$num
áá 
;
áá 
}
àà 
else
ââ 
{
ää 
searchString
ãã 
=
ãã 
currentFilter
ãã ,
;
ãã, -
}
åå 
ViewBag
éé 
.
éé 
CurrentFilter
éé !
=
éé" #
searchString
éé$ 0
;
éé0 1
var
èè 
products
èè 
=
èè 
db
èè 
.
èè 

Productoes
èè (
.
èè( )
Include
èè) 0
(
èè0 1
c
èè1 2
=>
èè3 5
c
èè6 7
.
èè7 8
Cliente
èè8 ?
)
èè? @
;
èè@ A
var
êê 
	productos
êê 
=
êê 
from
êê  
p
êê! "
in
êê# %
db
êê& (
.
êê( )

Productoes
êê) 3
select
ëë "
p
ëë# $
;
ëë$ %
if
îî 
(
îî 
correoActual
îî 
!=
îî 
null
îî  $
)
îî$ %
{
ïï 
	productos
ññ 
=
ññ 
	productos
ññ %
.
ññ% &
Where
ññ& +
(
ññ+ ,
p
ññ, -
=>
ññ. 0
p
ññ1 2
.
ññ2 3
CorreoCliente
ññ3 @
==
ññA C
correoActual
ññD P
)
ññP Q
;
ññQ R
}
óó 
else
òò 
{
ôô 
return
öö 
RedirectToAction
öö '
(
öö' (
$str
öö( 7
,
öö7 8
$str
öö9 E
)
ööE F
;
ööF G
}
õõ 
if
ûû 
(
ûû 
!
ûû 
String
ûû 
.
ûû 
IsNullOrEmpty
ûû %
(
ûû% &
searchString
ûû& 2
)
ûû2 3
)
ûû3 4
{
üü 
	productos
†† 
=
†† 
	productos
†† %
.
††% &
Where
††& +
(
††+ ,
p
††, -
=>
††. 0
p
††1 2
.
††2 3
Nombre
††3 9
.
††9 :
Contains
††: B
(
††B C
searchString
††C O
)
††O P
)
††P Q
;
††Q R
}
°° 
switch
§§ 
(
§§ 
searchBy
§§ 
)
§§ 
{
•• 
case
¶¶ 
$str
¶¶ 
:
¶¶  
	productos
ßß 
=
ßß 
	productos
ßß  )
.
ßß) *
OrderBy
ßß* 1
(
ßß1 2
p
ßß2 3
=>
ßß4 6
p
ßß7 8
.
ßß8 9
Nombre
ßß9 ?
)
ßß? @
;
ßß@ A
break
®® 
;
®® 
case
™™ 
$str
™™ !
:
™™! "
	productos
´´ 
=
´´ 
	productos
´´  )
.
´´) *
OrderByDescending
´´* ;
(
´´; <
p
´´< =
=>
´´> @
p
´´A B
.
´´B C
PrecioEstimado
´´C Q
)
´´Q R
;
´´R S
break
¨¨ 
;
¨¨ 
case
≠≠ 
$str
≠≠ 
:
≠≠ 
	productos
ÆÆ 
=
ÆÆ 
	productos
ÆÆ  )
.
ÆÆ) *
OrderBy
ÆÆ* 1
(
ÆÆ1 2
p
ÆÆ2 3
=>
ÆÆ4 6
p
ÆÆ7 8
.
ÆÆ8 9
PrecioEstimado
ÆÆ9 G
)
ÆÆG H
;
ÆÆH I
break
ØØ 
;
ØØ 
default
∞∞ 
:
∞∞ 
	productos
±± 
=
±± 
	productos
±±  )
.
±±) *
OrderBy
±±* 1
(
±±1 2
p
±±2 3
=>
±±4 6
p
±±7 8
.
±±8 9
Nombre
±±9 ?
)
±±? @
;
±±@ A
break
≤≤ 
;
≤≤ 
}
≥≥ 
int
µµ 
pageSize
µµ 
=
µµ 
$num
µµ 
;
µµ 
int
∂∂ 

pageNumber
∂∂ 
=
∂∂ 
(
∂∂ 
page
∂∂ "
??
∂∂# %
$num
∂∂& '
)
∂∂' (
;
∂∂( )
return
∑∑ 
View
∑∑ 
(
∑∑ 
	productos
∑∑ !
.
∑∑! "
ToPagedList
∑∑" -
(
∑∑- .

pageNumber
∑∑. 8
,
∑∑8 9
pageSize
∑∑: B
)
∑∑B C
)
∑∑C D
;
∑∑D E
}
∏∏ 	
public
∫∫ 
ActionResult
∫∫ 
DetailsOferta
∫∫ )
(
∫∫) *
int
∫∫* -
?
∫∫- .
id
∫∫/ 1
,
∫∫1 2
string
∫∫3 9
correo
∫∫: @
)
∫∫@ A
{
ªª 	
string
ºº 
correoActual
ºº 
=
ºº  !
(
ºº" #
string
ºº# )
)
ºº) *
HttpContext
ºº* 5
.
ºº5 6
Session
ºº6 =
[
ºº= >
$str
ºº> H
]
ººH I
;
ººI J
Producto
ΩΩ 
oferta
ΩΩ 
=
ΩΩ 
db
ΩΩ  
.
ΩΩ  !

Productoes
ΩΩ! +
.
ΩΩ+ ,
Find
ΩΩ, 0
(
ΩΩ0 1
id
ΩΩ1 3
,
ΩΩ3 4
correo
ΩΩ5 ;
)
ΩΩ; <
;
ΩΩ< =
var
ææ 
	productos
ææ 
=
ææ 
from
ææ  
p
ææ! "
in
ææ# %
db
ææ& (
.
ææ( )

Productoes
ææ) 3
select
øø "
p
øø# $
;
øø$ %
	productos
¿¿ 
=
¿¿ 
	productos
¿¿ !
.
¿¿! "
Where
¿¿" '
(
¿¿' (
p
¿¿( )
=>
¿¿* ,
p
¿¿- .
.
¿¿. /
Seleccionado
¿¿/ ;
==
¿¿< >
true
¿¿? C
&&
¿¿D F
p
¿¿G H
.
¿¿H I
CorreoCliente
¿¿I V
==
¿¿W Y
correoActual
¿¿Z f
)
¿¿f g
;
¿¿g h
if
¡¡ 
(
¡¡ 
	productos
¡¡ 
.
¡¡ 
IsNullOrEmpty
¡¡ '
(
¡¡' (
)
¡¡( )
)
¡¡) *
ViewBag
¬¬ 
.
¬¬ 
Contiene
¬¬  
=
¬¬! "
$num
¬¬# $
;
¬¬$ %
else
√√ 
ViewBag
ƒƒ 
.
ƒƒ 
Contiene
ƒƒ  
=
ƒƒ! "
$num
ƒƒ# $
;
ƒƒ$ %
ViewBag
≈≈ 
.
≈≈ 
lista
≈≈ 
=
≈≈ 
	productos
≈≈ %
;
≈≈% &
return
∆∆ 
View
∆∆ 
(
∆∆ 
oferta
∆∆ 
)
∆∆ 
;
∆∆  
}
«« 	
public
…… 
ActionResult
…… 
InsertarTrueque
…… +
(
……+ ,
int
……, /
id
……0 2
,
……2 3
string
……4 :
correo
……; A
)
……A B
{
   	
string
ÀÀ 
correoActual
ÀÀ 
=
ÀÀ  !
(
ÀÀ" #
string
ÀÀ# )
)
ÀÀ) *
HttpContext
ÀÀ* 5
.
ÀÀ5 6
Session
ÀÀ6 =
[
ÀÀ= >
$str
ÀÀ> H
]
ÀÀH I
;
ÀÀI J
DateTime
ÃÃ 
date
ÃÃ 
=
ÃÃ 
DateTime
ÃÃ $
.
ÃÃ$ %
Now
ÃÃ% (
;
ÃÃ( )
var
ÕÕ 
	productos
ÕÕ 
=
ÕÕ 
from
ÕÕ  
p
ÕÕ! "
in
ÕÕ# %
db
ÕÕ& (
.
ÕÕ( )

Productoes
ÕÕ) 3
select
ŒŒ "
p
ŒŒ# $
;
ŒŒ$ %
	productos
œœ 
=
œœ 
	productos
œœ !
.
œœ! "
Where
œœ" '
(
œœ' (
p
œœ( )
=>
œœ* ,
p
œœ- .
.
œœ. /
Seleccionado
œœ/ ;
==
œœ< >
true
œœ? C
&&
œœD F
p
œœG H
.
œœH I
CorreoCliente
œœI V
==
œœW Y
correoActual
œœZ f
)
œœf g
;
œœg h
Trueque
–– 
trueque
–– 
=
–– 
new
–– !
Trueque
––" )
(
––) *
)
––* +
;
––+ ,
foreach
—— 
(
—— 
var
—— 
item
—— 
in
——  
	productos
——! *
)
——* +
{
““ 
trueque
’’ 
.
’’ 
Inserte
’’ 
(
’’ 
id
’’ !
,
’’! "
correo
’’# )
,
’’) *
item
’’+ /
.
’’/ 0

ProductoID
’’0 :
,
’’: ;
item
’’< @
.
’’@ A
CorreoCliente
’’A N
,
’’N O
date
’’P T
)
’’T U
;
’’U V
}
÷÷ 
return
ÿÿ 
RedirectToAction
ÿÿ #
(
ÿÿ# $
$str
ÿÿ$ +
)
ÿÿ+ ,
;
ÿÿ, -
}
ŸŸ 	
[
€€ 	
	WebMethod
€€	 
]
€€ 
public
‹‹ 
string
‹‹ 
Seleccionar
‹‹ !
(
‹‹! "
int
‹‹" %
id
‹‹& (
)
‹‹( )
{
›› 	
string
ﬁﬁ 
correoActual
ﬁﬁ 
=
ﬁﬁ  !
(
ﬁﬁ" #
string
ﬁﬁ# )
)
ﬁﬁ) *
HttpContext
ﬁﬁ* 5
.
ﬁﬁ5 6
Session
ﬁﬁ6 =
[
ﬁﬁ= >
$str
ﬁﬁ> H
]
ﬁﬁH I
;
ﬁﬁI J
Producto
ﬂﬂ 
producto
ﬂﬂ 
=
ﬂﬂ 
db
ﬂﬂ  "
.
ﬂﬂ" #

Productoes
ﬂﬂ# -
.
ﬂﬂ- .
Find
ﬂﬂ. 2
(
ﬂﬂ2 3
id
ﬂﬂ3 5
,
ﬂﬂ5 6
correoActual
ﬂﬂ7 C
)
ﬂﬂC D
;
ﬂﬂD E
if
‡‡ 
(
‡‡ 
!
‡‡ 
producto
‡‡ 
.
‡‡ 
Seleccionado
‡‡ &
)
‡‡& '
producto
·· 
.
·· 
Seleccionado
·· %
=
··& '
true
··( ,
;
··, -
else
‚‚ 
producto
„„ 
.
„„ 
Seleccionado
„„ %
=
„„& '
false
„„( -
;
„„- .
db
‰‰ 
.
‰‰ 
SaveChanges
‰‰ 
(
‰‰ 
)
‰‰ 
;
‰‰ 
return
ÂÂ 
$str
ÂÂ 
;
ÂÂ 
}
ÊÊ 	
[
ËË 	
	WebMethod
ËË	 
]
ËË 
public
ÈÈ 
string
ÈÈ 
	Desmarcar
ÈÈ 
(
ÈÈ  
)
ÈÈ  !
{
ÍÍ 	
string
ÎÎ 
correoActual
ÎÎ 
=
ÎÎ  !
(
ÎÎ" #
string
ÎÎ# )
)
ÎÎ) *
HttpContext
ÎÎ* 5
.
ÎÎ5 6
Session
ÎÎ6 =
[
ÎÎ= >
$str
ÎÎ> H
]
ÎÎH I
;
ÎÎI J
var
ÏÏ 
	productos
ÏÏ 
=
ÏÏ 
from
ÏÏ  
p
ÏÏ! "
in
ÏÏ# %
db
ÏÏ& (
.
ÏÏ( )

Productoes
ÏÏ) 3
select
ÌÌ "
p
ÌÌ# $
;
ÌÌ$ %
	productos
ÓÓ 
=
ÓÓ 
	productos
ÓÓ !
.
ÓÓ! "
Where
ÓÓ" '
(
ÓÓ' (
p
ÓÓ( )
=>
ÓÓ* ,
p
ÓÓ- .
.
ÓÓ. /
Seleccionado
ÓÓ/ ;
==
ÓÓ< >
true
ÓÓ? C
&&
ÓÓD F
p
ÓÓG H
.
ÓÓH I
CorreoCliente
ÓÓI V
==
ÓÓW Y
correoActual
ÓÓZ f
)
ÓÓf g
;
ÓÓg h
foreach
ÔÔ 
(
ÔÔ 
var
ÔÔ 
item
ÔÔ 
in
ÔÔ  
	productos
ÔÔ! *
)
ÔÔ* +
item
 
.
 
Seleccionado
 !
=
" #
false
$ )
;
) *
db
ÒÒ 
.
ÒÒ 
SaveChanges
ÒÒ 
(
ÒÒ 
)
ÒÒ 
;
ÒÒ 
return
ÚÚ 
$str
ÚÚ 
;
ÚÚ 
}
ÛÛ 	
}
ÙÙ 
}ıı ôé
|C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\ProductoController.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Controllers" -
{ 
public 

class 
ProductoController #
:$ %

Controller& 0
{ 
private 
TempPIEntities 
db !
=" #
new$ '
TempPIEntities( 6
(6 7
)7 8
;8 9
public## 
ActionResult## 
Index## !
(##! "
string##" (
searchBy##) 1
,##1 2
string##3 9
currentFilter##: G
,##G H
string##I O
searchString##P \
,##\ ]
int##^ a
?##a b
page##c g
)##g h
{$$ 	
string&& 
correoActual&& 
=&&  !
(&&" #
string&&# )
)&&) *
HttpContext&&* 5
.&&5 6
Session&&6 =
[&&= >
$str&&> H
]&&H I
;&&I J
ViewBag(( 
.(( 
CurrentSort(( 
=((  !
searchBy((" *
;((* +
ViewBag)) 
.)) 
NameSortParm))  
=))! "
String))# )
.))) *
IsNullOrEmpty))* 7
())7 8
searchBy))8 @
)))@ A
?))B C
$str))D N
:))O P
$str))Q S
;))S T
ViewBag** 
.** 
SortPriceParm** !
=**" #
searchBy**$ ,
==**- /
$str**0 7
?**8 9
$str**: F
:**G H
$str**I P
;**P Q
if00 
(00 
searchString00 
!=00 
null00  $
)00$ %
{11 
page22 
=22 
$num22 
;22 
}33 
else44 
{55 
searchString66 
=66 
currentFilter66 ,
;66, -
}77 
ViewBag99 
.99 
CurrentFilter99 !
=99" #
searchString99$ 0
;990 1
var:: 
products:: 
=:: 
db:: 
.:: 

Productoes:: (
.::( )
Include::) 0
(::0 1
c::1 2
=>::3 5
c::6 7
.::7 8
Cliente::8 ?
)::? @
;::@ A
var;; 
	productos;; 
=;; 
from;;  
p;;! "
in;;# %
db;;& (
.;;( )

Productoes;;) 3
select<< "
p<<# $
;<<$ %
	productosBB 
=BB 
	productosBB !
.BB! "
WhereBB" '
(BB' (
pBB( )
=>BB* ,
pBB- .
.BB. /
EstadoBB/ 5
==BB6 8
trueBB9 =
)BB= >
;BB> ?
ifEE 
(EE 
correoActualEE 
!=EE 
nullEE  $
)EE$ %
{FF 
	productosGG 
=GG 
	productosGG %
.GG% &
WhereGG& +
(GG+ ,
pGG, -
=>GG. 0
pGG1 2
.GG2 3
CorreoClienteGG3 @
==GGA C
correoActualGGD P
)GGP Q
;GGQ R
}HH 
elseII 
{JJ 
returnKK 
RedirectToActionKK '
(KK' (
$strKK( 7
,KK7 8
$strKK9 E
)KKE F
;KKF G
}LL 
switchRR 
(RR 
searchByRR 
)RR 
{SS 
caseTT 
$strTT 
:TT  
	productosUU 
=UU 
	productosUU  )
.UU) *
OrderByUU* 1
(UU1 2
pUU2 3
=>UU4 6
pUU7 8
.UU8 9
NombreUU9 ?
)UU? @
;UU@ A
breakVV 
;VV 
caseXX 
$strXX !
:XX! "
	productosYY 
=YY 
	productosYY  )
.YY) *
OrderByDescendingYY* ;
(YY; <
pYY< =
=>YY> @
pYYA B
.YYB C
PrecioEstimadoYYC Q
)YYQ R
;YYR S
breakZZ 
;ZZ 
case[[ 
$str[[ 
:[[ 
	productos\\ 
=\\ 
	productos\\  )
.\\) *
OrderBy\\* 1
(\\1 2
p\\2 3
=>\\4 6
p\\7 8
.\\8 9
PrecioEstimado\\9 G
)\\G H
;\\H I
break]] 
;]] 
default^^ 
:^^ 
	productos__ 
=__ 
	productos__  )
.__) *
OrderBy__* 1
(__1 2
p__2 3
=>__4 6
p__7 8
.__8 9
Nombre__9 ?
)__? @
;__@ A
break`` 
;`` 
}aa 
intcc 
pageSizecc 
=cc 
$numcc 
;cc 
intdd 

pageNumberdd 
=dd 
(dd 
pagedd "
??dd# %
$numdd& '
)dd' (
;dd( )
returnff 
Viewff 
(ff 
	productosff !
.ff! "
ToPagedListff" -
(ff- .

pageNumberff. 8
,ff8 9
pageSizeff: B
)ffB C
)ffC D
;ffD E
}gg 	
publicjj 
ActionResultjj 
Detailsjj #
(jj# $
intjj$ '
?jj' (
idjj) +
,jj+ ,
stringjj- 3
correojj4 :
)jj: ;
{kk 	
varmm 
cookiecorreomm 
=mm 
ControllerContextmm 0
.mm0 1
HttpContextmm1 <
.mm< =
Requestmm= D
.mmD E
CookiesmmE L
[mmL M
$strmmM S
]mmS T
;mmT U
stringnn 
correoActualnn 
=nn  !
(nn" #
stringnn# )
)nn) *
HttpContextnn* 5
.nn5 6
Sessionnn6 =
[nn= >
$strnn> H
]nnH I
;nnI J
ifrr 
(rr 
idrr 
==rr 
nullrr 
)rr 
{ss 
returntt 
newtt  
HttpStatusCodeResulttt /
(tt/ 0
HttpStatusCodett0 >
.tt> ?

BadRequesttt? I
)ttI J
;ttJ K
}uu 
Productovv 
productovv 
=vv 
dbvv  "
.vv" #

Productoesvv# -
.vv- .
Findvv. 2
(vv2 3
idvv3 5
,vv5 6
correovv7 =
)vv= >
;vv> ?
ifww 
(ww 
productoww 
.ww 
ProductoImagen1ww (
==ww) +
nullww, 0
)ww0 1
{xx 
byteyy 
[yy 
]yy 
imageyy 
=yy 
newyy "
	WebClientyy# ,
(yy, -
)yy- .
.yy. /
DownloadDatayy/ ;
(yy; <
$str	yy< ¶
)
yy¶ ß
;
yyß ®
varzz 
base64Imagezz 
=zz  !
Convertzz" )
.zz) *
ToBase64Stringzz* 8
(zz8 9
imagezz9 >
)zz> ?
;zz? @
TempData{{ 
[{{ 
$str{{ 
]{{ 
={{  !
base64Image{{" -
;{{- .
}|| 
else}} 
{~~ 
var 
base64Image 
=  !
Convert" )
.) *
ToBase64String* 8
(8 9
producto9 A
.A B
ProductoImagen1B Q
)Q R
;R S
TempData
ÄÄ 
[
ÄÄ 
$str
ÄÄ 
]
ÄÄ 
=
ÄÄ  !
base64Image
ÄÄ" -
;
ÄÄ- .
}
ÅÅ 
if
ÉÉ 
(
ÉÉ 
producto
ÉÉ 
==
ÉÉ 
null
ÉÉ  
)
ÉÉ  !
{
ÑÑ 
return
ÖÖ 
HttpNotFound
ÖÖ #
(
ÖÖ# $
)
ÖÖ$ %
;
ÖÖ% &
}
ÜÜ %
ProductoCreateViewModel
áá #%
productoCreateViewModel
áá$ ;
=
áá< =
new
áá> A%
ProductoCreateViewModel
ááB Y
(
ááY Z
)
ááZ [
{
àà 
Producto
ãã 
=
ãã 
producto
ãã #
,
ãã# $
	Categoria
åå 
=
åå 
new
åå 
List
åå  $
<
åå$ %
	Categoria
åå% .
>
åå. /
(
åå/ 0
db
åå0 2
.
åå2 3

Categorias
åå3 =
)
åå= >
,
åå> ?
selected
çç 
=
çç 
new
çç 
List
çç #
<
çç# $
bool
çç$ (
>
çç( )
(
çç) *
)
çç* +
}
éé 
;
éé 
var
êê  
productosVirtuales
êê "
=
êê# $
from
êê% )
p
êê* +
in
êê, .
db
êê/ 1
.
êê1 2
Virtuals
êê2 :
select
ëë% +
p
ëë, -
;
ëë- .
ViewBag
íí 
.
íí  
productosVirtuales
íí &
=
íí' ( 
productosVirtuales
íí) ;
;
íí; <
return
ïï 
View
ïï 
(
ïï 
producto
ïï  
)
ïï  !
;
ïï! "
}
ññ 	
[
ôô 	
HttpGet
ôô	 
]
ôô 
public
öö 
ActionResult
öö 
Create
öö "
(
öö" #
)
öö# $
{
õõ 	
ViewBag
úú 
.
úú 
	Categoria
úú 
=
úú 
new
úú  #

SelectList
úú$ .
(
úú. /
db
úú/ 1
.
úú1 2

Categorias
úú2 <
,
úú< =
$str
úú> K
,
úúK L
$str
úúM U
)
úúU V
;
úúV W
string
ùù 
correoActual
ùù 
=
ùù  !
(
ùù" #
string
ùù# )
)
ùù) *
HttpContext
ùù* 5
.
ùù5 6
Session
ùù6 =
[
ùù= >
$str
ùù> H
]
ùùH I
;
ùùI J
if
ûû 
(
ûû 
correoActual
ûû 
!=
ûû 
null
ûû  $
)
ûû$ %
return
üü 
View
üü 
(
üü 
)
üü 
;
üü 
else
†† 
return
°° 
RedirectToAction
°° '
(
°°' (
$str
°°( 7
,
°°7 8
$str
°°9 E
)
°°E F
;
°°F G
}
¢¢ 	
[
ßß 	
HttpPost
ßß	 
]
ßß 
public
©© 
ActionResult
©© 
Create
©© "
(
©©" #
[
©©# $
Bind
©©$ (
(
©©( )
Include
©©) 0
=
©©1 2
$str©©3 √
)©©√ ƒ
]©©ƒ ≈
Producto©©∆ Œ
producto©©œ ◊
,©©◊ ÿ"
HttpPostedFileBase©©Ÿ Î
Archivo_Imagen1©©Ï ˚
,©©˚ ¸"
HttpPostedFileBase©©˝ è
Archivo_Imagen2©©ê ü
,©©ü †"
HttpPostedFileBase©©° ≥
Archivo_Imagen3©©¥ √
,©©√ ƒ
FormCollection©©≈ ”
form©©‘ ÿ
)©©ÿ Ÿ
{
™™ 	%
ProductoCreateViewModel
¨¨ #%
productoCreateViewModel
¨¨$ ;
=
¨¨< =
new
¨¨> A%
ProductoCreateViewModel
¨¨B Y
(
¨¨Y Z
)
¨¨Z [
{
≠≠ 
Producto
∞∞ 
=
∞∞ 
producto
∞∞ #
,
∞∞# $
	Categoria
±± 
=
±± 
new
±± 
List
±±  $
<
±±$ %
	Categoria
±±% .
>
±±. /
(
±±/ 0
db
±±0 2
.
±±2 3

Categorias
±±3 =
)
±±= >
,
±±> ?
selected
≤≤ 
=
≤≤ 
new
≤≤ 
List
≤≤ #
<
≤≤# $
bool
≤≤$ (
>
≤≤( )
(
≤≤) *
)
≤≤* +
}
≥≥ 
;
≥≥ 
ViewBag
¥¥ 
.
¥¥ 
	Categoria
¥¥ 
=
¥¥ 
new
¥¥  #

SelectList
¥¥$ .
(
¥¥. /
db
¥¥/ 1
.
¥¥1 2

Categorias
¥¥2 <
,
¥¥< =
$str
¥¥> K
,
¥¥K L
$str
¥¥M U
)
¥¥U V
;
¥¥V W
producto
∂∂ 
.
∂∂ 
FechaRegistrado
∂∂ $
=
∂∂% &
DateTime
∂∂' /
.
∂∂/ 0
Now
∂∂0 3
;
∂∂3 4
string
∏∏ 
derechosAutor
∏∏  
=
∏∏! "
Convert
∏∏# *
.
∏∏* +
ToString
∏∏+ 3
(
∏∏3 4
form
∏∏4 8
[
∏∏8 9
$str
∏∏9 C
]
∏∏C D
.
∏∏D E
ToString
∏∏E M
(
∏∏M N
)
∏∏N O
)
∏∏O P
;
∏∏P Q
string
ππ 
tipoArchivo
ππ 
=
ππ  
Convert
ππ! (
.
ππ( )
ToString
ππ) 1
(
ππ1 2
form
ππ2 6
[
ππ6 7
$str
ππ7 D
]
ππD E
.
ππE F
ToString
ππF N
(
ππN O
)
ππO P
)
ππP Q
;
ππQ R
string
∫∫ 
fuentes
∫∫ 
=
∫∫ 
Convert
∫∫ $
.
∫∫$ %
ToString
∫∫% -
(
∫∫- .
form
∫∫. 2
[
∫∫2 3
$str
∫∫3 <
]
∫∫< =
.
∫∫= >
ToString
∫∫> F
(
∫∫F G
)
∫∫G H
)
∫∫H I
;
∫∫I J
string
ºº 
correoActual
ºº 
=
ºº  !
(
ºº" #
string
ºº# )
)
ºº) *
HttpContext
ºº* 5
.
ºº5 6
Session
ºº6 =
[
ºº= >
$str
ºº> H
]
ººH I
;
ººI J
if
ææ 
(
ææ 
correoActual
ææ 
!=
ææ 
null
ææ  $
)
ææ$ %
producto
øø 
.
øø 
CorreoCliente
øø &
=
øø' (
correoActual
øø) 5
;
øø5 6
else
¿¿ 
return
¡¡ 
RedirectToAction
¡¡ '
(
¡¡' (
$str
¡¡( 7
,
¡¡7 8
$str
¡¡9 E
)
¡¡E F
;
¡¡F G
byte
√√ 
[
√√ 
]
√√ 
imagenP1
√√ 
=
√√ 
{
√√ 
}
√√  !
;
√√! "
byte
ƒƒ 
[
ƒƒ 
]
ƒƒ 
imagenP2
ƒƒ 
=
ƒƒ 
{
ƒƒ 
}
ƒƒ  !
;
ƒƒ! "
byte
≈≈ 
[
≈≈ 
]
≈≈ 
imagenP3
≈≈ 
=
≈≈ 
{
≈≈ 
}
≈≈  !
;
≈≈! "
if
«« 
(
«« 
Archivo_Imagen1
«« 
!=
««  "
null
««# '
)
««' (
{
»» 
imagenP1
…… 
=
…… 
ConvertToByte
…… (
(
……( )
Archivo_Imagen1
……) 8
)
……8 9
;
……9 :
if
   
(
   
imagenP1
   
.
   
Length
   #
!=
  $ &
$num
  ' (
)
  ( )
{
  * +
producto
  , 4
.
  4 5
ProductoImagen1
  5 D
=
  E F
imagenP1
  G O
;
  O P
}
  Q R
}
ÀÀ 
if
ÕÕ 
(
ÕÕ 
Archivo_Imagen2
ÕÕ 
!=
ÕÕ  "
null
ÕÕ# '
)
ÕÕ' (
{
ŒŒ 
imagenP1
œœ 
=
œœ 
ConvertToByte
œœ (
(
œœ( )
Archivo_Imagen2
œœ) 8
)
œœ8 9
;
œœ9 :
if
–– 
(
–– 
imagenP2
–– 
.
–– 
Length
–– #
!=
––$ &
$num
––' (
)
––( )
{
––* +
producto
––, 4
.
––4 5
ProductoImagen2
––5 D
=
––E F
imagenP2
––G O
;
––O P
}
––Q R
}
—— 
if
”” 
(
”” 
Archivo_Imagen3
”” 
!=
””  "
null
””# '
)
””' (
{
‘‘ 
imagenP1
’’ 
=
’’ 
ConvertToByte
’’ (
(
’’( )
Archivo_Imagen3
’’) 8
)
’’8 9
;
’’9 :
if
÷÷ 
(
÷÷ 
imagenP3
÷÷ 
.
÷÷ 
Length
÷÷ #
!=
÷÷$ &
$num
÷÷' (
)
÷÷( )
{
÷÷* +
producto
÷÷, 4
.
÷÷4 5
ProductoImagen3
÷÷5 D
=
÷÷E F
imagenP3
÷÷G O
;
÷÷O P
}
÷÷Q R
}
◊◊ 
if
ﬁﬁ 
(
ﬁﬁ 

ModelState
ﬁﬁ 
.
ﬁﬁ 
IsValid
ﬁﬁ "
)
ﬁﬁ" #
{
ﬂﬂ 
}
‰‰ 
string
ÊÊ 
[
ÊÊ 
]
ÊÊ "
resultadosCheckboxes
ÊÊ )
=
ÊÊ* +
form
ÊÊ, 0
[
ÊÊ0 1
$str
ÊÊ1 D
]
ÊÊD E
.
ÊÊE F
Split
ÊÊF K
(
ÊÊK L
$char
ÊÊL O
)
ÊÊO P
;
ÊÊP Q
List
ÁÁ 
<
ÁÁ 
string
ÁÁ 
>
ÁÁ '
resultadosCheckboxesLista
ÁÁ 2
=
ÁÁ3 4"
resultadosCheckboxes
ÁÁ5 I
.
ÁÁI J
ToList
ÁÁJ P
(
ÁÁP Q
)
ÁÁQ R
;
ÁÁR S
for
ÈÈ 
(
ÈÈ 
int
ÈÈ 
i
ÈÈ 
=
ÈÈ 
$num
ÈÈ 
;
ÈÈ 
i
ÈÈ 
<
ÈÈ '
resultadosCheckboxesLista
ÈÈ  9
.
ÈÈ9 :
Count
ÈÈ: ?
;
ÈÈ? @
i
ÈÈA B
++
ÈÈB D
)
ÈÈD E
{
ÍÍ 
string
ÎÎ 
	resultado
ÎÎ  
=
ÎÎ! "'
resultadosCheckboxesLista
ÎÎ# <
[
ÎÎ< =
i
ÎÎ= >
]
ÎÎ> ?
;
ÎÎ? @
if
ÏÏ 
(
ÏÏ 
	resultado
ÏÏ 
==
ÏÏ  
$str
ÏÏ! '
)
ÏÏ' (
{
ÌÌ '
resultadosCheckboxesLista
ÓÓ -
.
ÓÓ- .
RemoveAt
ÓÓ. 6
(
ÓÓ6 7
i
ÓÓ7 8
+
ÓÓ9 :
$num
ÓÓ; <
)
ÓÓ< =
;
ÓÓ= >
}
ÔÔ 
}
 
List
ÚÚ 
<
ÚÚ 
	Categoria
ÚÚ 
>
ÚÚ 
listaCategorias
ÚÚ +
=
ÚÚ, -
new
ÚÚ. 1
List
ÚÚ2 6
<
ÚÚ6 7
	Categoria
ÚÚ7 @
>
ÚÚ@ A
(
ÚÚA B
db
ÚÚB D
.
ÚÚD E

Categorias
ÚÚE O
)
ÚÚO P
;
ÚÚP Q
for
ÙÙ 
(
ÙÙ 
int
ÙÙ 
i
ÙÙ 
=
ÙÙ 
$num
ÙÙ 
;
ÙÙ 
i
ÙÙ 
<
ÙÙ '
resultadosCheckboxesLista
ÙÙ  9
.
ÙÙ9 :
Count
ÙÙ: ?
;
ÙÙ? @
i
ÙÙA B
++
ÙÙB D
)
ÙÙD E
{
ıı 
if
ˆˆ 
(
ˆˆ '
resultadosCheckboxesLista
ˆˆ -
[
ˆˆ- .
i
ˆˆ. /
]
ˆˆ/ 0
==
ˆˆ1 3
$str
ˆˆ4 :
)
ˆˆ: ;
{
˜˜ 
listaCategorias
¯¯ #
[
¯¯# $
i
¯¯$ %
]
¯¯% &
.
¯¯& '

Productoes
¯¯' 1
.
¯¯1 2
Add
¯¯2 5
(
¯¯5 6
producto
¯¯6 >
)
¯¯> ?
;
¯¯? @
producto
˘˘ 
.
˘˘ 

Categorias
˘˘ '
.
˘˘' (
Add
˘˘( +
(
˘˘+ ,
listaCategorias
˘˘, ;
[
˘˘; <
i
˘˘< =
]
˘˘= >
)
˘˘> ?
;
˘˘? @
}
˙˙ 
}
¸¸ 
int
ÇÇ 
opcion
ÇÇ 
=
ÇÇ 
Convert
ÇÇ  
.
ÇÇ  !
ToUInt16
ÇÇ! )
(
ÇÇ) *
form
ÇÇ* .
[
ÇÇ. /
$str
ÇÇ/ =
]
ÇÇ= >
.
ÇÇ> ?
ToString
ÇÇ? G
(
ÇÇG H
)
ÇÇH I
)
ÇÇI J
;
ÇÇJ K
if
ÑÑ 
(
ÑÑ 
opcion
ÑÑ 
==
ÑÑ 
$num
ÑÑ 
)
ÑÑ 
{
ÖÖ "
insertProductoFisico
ÜÜ $
(
ÜÜ$ %
producto
ÜÜ% -
)
ÜÜ- .
;
ÜÜ. /
}
áá 
else
àà 
{
ââ #
insertProductoVirtual
ää %
(
ää% &
producto
ää& .
,
ää. /
derechosAutor
ää0 =
,
ää= >
tipoArchivo
ää? J
,
ääJ K
fuentes
ääL S
)
ääS T
;
ääT U
}
ãã 
return
êê 
RedirectToAction
êê #
(
êê# $
$str
êê$ +
)
êê+ ,
;
êê, -
}
íí 	
public
ïï 
void
ïï "
insertProductoFisico
ïï (
(
ïï( )
Producto
ïï) 1
producto
ïï2 :
)
ïï: ;
{
ññ 	
string
òò #
listaCategoriasString
òò (
=
òò) *
$str
òò+ -
;
òò- .
foreach
ôô 
(
ôô 
	Categoria
ôô 
	categoria
ôô (
in
ôô) +
producto
ôô, 4
.
ôô4 5

Categorias
ôô5 ?
)
ôô? @
{
öö #
listaCategoriasString
õõ %
+=
õõ& (
	categoria
õõ) 2
.
õõ2 3
CategoriaID
õõ3 >
;
õõ> ?
if
ùù 
(
ùù 
	categoria
ùù 
!=
ùù  
producto
ùù! )
.
ùù) *

Categorias
ùù* 4
.
ùù4 5
Last
ùù5 9
(
ùù9 :
)
ùù: ;
)
ùù; <
{
ûû #
listaCategoriasString
üü )
+=
üü* ,
$str
üü- 0
;
üü0 1
}
†† 
}
°° 
db
££ 
.
££ 
spFisico_Insert
££ 
(
££ 
producto
££ '
.
££' (
Nombre
££( .
,
££. /
producto
££0 8
.
££8 9
CorreoCliente
££9 F
,
££F G
producto
££H P
.
££P Q
PrecioEstimado
££Q _
,
££_ `
producto
££a i
.
££i j
	Condicion
££j s
,
££s t
producto
££u }
.
££} ~
Descripcion££~ â
,££â ä
producto
§§ 
.
§§ 
ProductoImagen1
§§ (
,
§§( )
producto
§§* 2
.
§§2 3
ProductoImagen2
§§3 B
,
§§B C
producto
§§D L
.
§§L M
ProductoImagen3
§§M \
,
§§\ ]
producto
§§^ f
.
§§f g
	Publicado
§§g p
,
§§p q
DateTime
§§r z
.
§§z {
Now
§§{ ~
,
§§~ %
listaCategoriasString§§Ä ï
)
•• 
;
•• 
}
¶¶ 	
public
®® 
void
®® #
insertProductoVirtual
®® )
(
®®) *
Producto
®®* 2
producto
®®3 ;
,
®®; <
string
®®= C
derechosAutor
®®D Q
,
®®Q R
string
®®S Y
tipoArchivo
®®Z e
,
®®e f
string
®®g m
fuentes
®®n u
)
®®u v
{
©© 	
string
´´ #
listaCategoriasString
´´ (
=
´´) *
$str
´´+ -
;
´´- .
foreach
¨¨ 
(
¨¨ 
	Categoria
¨¨ 
	categoria
¨¨ (
in
¨¨) +
producto
¨¨, 4
.
¨¨4 5

Categorias
¨¨5 ?
)
¨¨? @
{
≠≠ #
listaCategoriasString
ÆÆ %
+=
ÆÆ& (
	categoria
ÆÆ) 2
.
ÆÆ2 3
CategoriaID
ÆÆ3 >
;
ÆÆ> ?
if
∞∞ 
(
∞∞ 
	categoria
∞∞ 
!=
∞∞  
producto
∞∞! )
.
∞∞) *

Categorias
∞∞* 4
.
∞∞4 5
Last
∞∞5 9
(
∞∞9 :
)
∞∞: ;
)
∞∞; <
{
±± #
listaCategoriasString
≤≤ )
+=
≤≤* ,
$str
≤≤- 0
;
≤≤0 1
}
≥≥ 
}
¥¥ 
db
∂∂ 
.
∂∂ 
spVirtual_Insert
∂∂ 
(
∂∂  
producto
∂∂  (
.
∂∂( )
Nombre
∂∂) /
,
∂∂/ 0
producto
∂∂1 9
.
∂∂9 :
CorreoCliente
∂∂: G
,
∂∂G H
producto
∂∂I Q
.
∂∂Q R
PrecioEstimado
∂∂R `
,
∂∂` a
producto
∂∂b j
.
∂∂j k
	Condicion
∂∂k t
,
∂∂t u
producto
∂∂v ~
.
∂∂~ 
Descripcion∂∂ ä
,∂∂ä ã
producto
∑∑ 
.
∑∑ 
ProductoImagen1
∑∑ (
,
∑∑( )
producto
∑∑* 2
.
∑∑2 3
ProductoImagen2
∑∑3 B
,
∑∑B C
producto
∑∑D L
.
∑∑L M
ProductoImagen3
∑∑M \
,
∑∑\ ]
producto
∑∑^ f
.
∑∑f g
	Publicado
∑∑g p
,
∑∑p q
DateTime
∑∑r z
.
∑∑z {
Now
∑∑{ ~
,∑∑ Ä
derechosAutor∑∑Ä ç
,∑∑ç é
tipoArchivo∑∑è ö
,∑∑ö õ
fuentes∑∑ú £
,∑∑£ §
DateTime∑∑• ≠
.∑∑≠ Æ
Now∑∑Æ ±
,∑∑± ≤%
listaCategoriasString∑∑≥ »
)∑∑» …
;∑∑…  
}
∏∏ 	
public
∫∫ 
byte
∫∫ 
[
∫∫ 
]
∫∫ 
ConvertToByte
∫∫ #
(
∫∫# $ 
HttpPostedFileBase
∫∫$ 6
file2
∫∫7 <
)
∫∫< =
{
ªª 	
byte
ºº 
[
ºº 
]
ºº 
	imageByte
ºº 
=
ºº 
null
ºº #
;
ºº# $
BinaryReader
ΩΩ 
rdr
ΩΩ 
=
ΩΩ 
new
ΩΩ "
BinaryReader
ΩΩ# /
(
ΩΩ/ 0
file2
ΩΩ0 5
.
ΩΩ5 6
InputStream
ΩΩ6 A
)
ΩΩA B
;
ΩΩB C
	imageByte
ææ 
=
ææ 
rdr
ææ 
.
ææ 
	ReadBytes
ææ %
(
ææ% &
(
ææ& '
int
ææ' *
)
ææ* +
file2
ææ+ 0
.
ææ0 1
ContentLength
ææ1 >
)
ææ> ?
;
ææ? @
return
øø 
	imageByte
øø 
;
øø 
}
¿¿ 	
public
¬¬ 
void
¬¬ !
editeImagenProducto
¬¬ '
(
¬¬' ( 
HttpPostedFileBase
¬¬( :
Archivo_Imagen
¬¬; I
,
¬¬I J
Producto
¬¬K S
producto
¬¬T \
,
¬¬\ ]
byte
¬¬^ b
[
¬¬b c
]
¬¬c d
imagenP
¬¬e l
,
¬¬l m
int
¬¬n q
n
¬¬r s
)
¬¬s t
{
√√ 	
if
ƒƒ 
(
ƒƒ 
Archivo_Imagen
ƒƒ 
!=
ƒƒ !
null
ƒƒ" &
)
ƒƒ& '
{
≈≈ 
imagenP
∆∆ 
=
∆∆ 
ConvertToByte
∆∆ '
(
∆∆' (
Archivo_Imagen
∆∆( 6
)
∆∆6 7
;
∆∆7 8
switch
«« 
(
«« 
n
«« 
)
«« 
{
»» 
case
…… 
$num
…… 
:
…… 
if
   
(
   
imagenP
   #
.
  # $
Length
  $ *
!=
  + -
$num
  . /
)
  / 0
{
  1 2
producto
  3 ;
.
  ; <
ProductoImagen1
  < K
=
  L M
imagenP
  N U
;
  U V
}
  W X
break
ÀÀ 
;
ÀÀ 
case
ÕÕ 
$num
ÕÕ 
:
ÕÕ 
if
ŒŒ 
(
ŒŒ 
imagenP
ŒŒ #
.
ŒŒ# $
Length
ŒŒ$ *
!=
ŒŒ+ -
$num
ŒŒ. /
)
ŒŒ/ 0
{
ŒŒ1 2
producto
ŒŒ3 ;
.
ŒŒ; <
ProductoImagen2
ŒŒ< K
=
ŒŒL M
imagenP
ŒŒN U
;
ŒŒU V
}
ŒŒW X
break
œœ 
;
œœ 
case
—— 
$num
—— 
:
—— 
if
““ 
(
““ 
imagenP
““ #
.
““# $
Length
““$ *
!=
““+ -
$num
““. /
)
““/ 0
{
““1 2
producto
““3 ;
.
““; <
ProductoImagen3
““< K
=
““L M
imagenP
““N U
;
““U V
}
““W X
break
”” 
;
”” 
default
’’ 
:
’’ 
break
÷÷ 
;
÷÷ 
}
◊◊ 
}
ÿÿ 
else
ŸŸ 
{
⁄⁄ 
switch
€€ 
(
€€ 
n
€€ 
)
€€ 
{
‹‹ 
case
›› 
$num
›› 
:
›› 
producto
ﬁﬁ  
.
ﬁﬁ  !
ProductoImagen1
ﬁﬁ! 0
=
ﬁﬁ1 2
producto
ﬁﬁ3 ;
.
ﬁﬁ; <
ProductoImagen1
ﬁﬁ< K
;
ﬁﬁK L
break
ﬂﬂ 
;
ﬂﬂ 
case
·· 
$num
·· 
:
·· 
producto
‚‚  
.
‚‚  !
ProductoImagen2
‚‚! 0
=
‚‚1 2
producto
‚‚3 ;
.
‚‚; <
ProductoImagen2
‚‚< K
;
‚‚K L
break
„„ 
;
„„ 
case
ÂÂ 
$num
ÂÂ 
:
ÂÂ 
producto
ÊÊ  
.
ÊÊ  !
ProductoImagen3
ÊÊ! 0
=
ÊÊ1 2
producto
ÊÊ3 ;
.
ÊÊ; <
ProductoImagen3
ÊÊ< K
;
ÊÊK L
break
ÁÁ 
;
ÁÁ 
default
ÈÈ 
:
ÈÈ 
break
ÍÍ 
;
ÍÍ 
}
ÎÎ 
}
ÏÏ 
}
ÌÌ 	
public
 
ActionResult
 
Edit
  
(
  !
int
! $
?
$ %
id
& (
,
( )
string
* 0
correo
1 7
)
7 8
{
ÒÒ 	
ViewBag
ÚÚ 
.
ÚÚ 
	Categoria
ÚÚ 
=
ÚÚ 
new
ÚÚ  #

SelectList
ÚÚ$ .
(
ÚÚ. /
db
ÚÚ/ 1
.
ÚÚ1 2

Categorias
ÚÚ2 <
,
ÚÚ< =
$str
ÚÚ> K
,
ÚÚK L
$str
ÚÚM U
)
ÚÚU V
;
ÚÚV W
var
ÛÛ 
cookiecorreo
ÛÛ 
=
ÛÛ 
ControllerContext
ÛÛ 0
.
ÛÛ0 1
HttpContext
ÛÛ1 <
.
ÛÛ< =
Request
ÛÛ= D
.
ÛÛD E
Cookies
ÛÛE L
[
ÛÛL M
$str
ÛÛM S
]
ÛÛS T
;
ÛÛT U
string
ÙÙ 
correoActual
ÙÙ 
=
ÙÙ  !
(
ÙÙ" #
string
ÙÙ# )
)
ÙÙ) *
HttpContext
ÙÙ* 5
.
ÙÙ5 6
Session
ÙÙ6 =
[
ÙÙ= >
$str
ÙÙ> H
]
ÙÙH I
;
ÙÙI J
if
ıı 
(
ıı 
id
ıı 
==
ıı 
null
ıı 
)
ıı 
{
ˆˆ 
return
˜˜ 
new
˜˜ "
HttpStatusCodeResult
˜˜ /
(
˜˜/ 0
HttpStatusCode
˜˜0 >
.
˜˜> ?

BadRequest
˜˜? I
)
˜˜I J
;
˜˜J K
}
¯¯ 
Producto
˘˘ 
producto
˘˘ 
=
˘˘ 
db
˘˘  "
.
˘˘" #

Productoes
˘˘# -
.
˘˘- .
Find
˘˘. 2
(
˘˘2 3
id
˘˘3 5
,
˘˘5 6
correo
˘˘7 =
)
˘˘= >
;
˘˘> ?
if
˙˙ 
(
˙˙ 
producto
˙˙ 
==
˙˙ 
null
˙˙  
)
˙˙  !
{
˚˚ 
return
¸¸ 
HttpNotFound
¸¸ #
(
¸¸# $
)
¸¸$ %
;
¸¸% &
}
˝˝ 
ViewBag
˛˛ 
.
˛˛ 
correo
˛˛ 
=
˛˛ 
new
˛˛  

SelectList
˛˛! +
(
˛˛+ ,
db
˛˛, .
.
˛˛. /
Clientes
˛˛/ 7
,
˛˛7 8
$str
˛˛9 A
,
˛˛A B
producto
˛˛C K
.
˛˛K L
CorreoCliente
˛˛L Y
)
˛˛Y Z
;
˛˛Z [
return
ˇˇ 
View
ˇˇ 
(
ˇˇ 
producto
ˇˇ  
)
ˇˇ  !
;
ˇˇ! "
}
ÄÄ 	
[
ÖÖ 	
HttpPost
ÖÖ	 
]
ÖÖ 
public
áá 
ActionResult
áá 
Edit
áá  
(
áá  !
[
áá! "
Bind
áá" &
(
áá& '
Include
áá' .
=
áá/ 0
$stráá1 ◊
)áá◊ ÿ
]ááÿ Ÿ
Productoáá⁄ ‚
productoáá„ Î
,ááÎ Ï"
HttpPostedFileBaseááÌ ˇ
Archivo_Imagen1ááÄ è
,ááè ê"
HttpPostedFileBaseááë £
Archivo_Imagen2áá§ ≥
,áá≥ ¥"
HttpPostedFileBaseááµ «
Archivo_Imagen3áá» ◊
,áá◊ ÿ
stringááŸ ﬂ
	Publicadoáá‡ È
,ááÈ Í
FormCollectionááÎ ˘
formáá˙ ˛
)áá˛ ˇ
{
àà 	
Debug
ââ 
.
ââ 
	WriteLine
ââ 
(
ââ 
$str
ââ (
+
ââ) *
producto
ââ+ 3
.
ââ3 4
FechaRegistrado
ââ4 C
)
ââC D
;
ââD E
ViewBag
ää 
.
ää 
	Categoria
ää 
=
ää 
new
ää  #

SelectList
ää$ .
(
ää. /
db
ää/ 1
.
ää1 2

Categorias
ää2 <
,
ää< =
$str
ää> K
,
ääK L
$str
ääM U
)
ääU V
;
ääV W
var
ãã 
cookiecorreo
ãã 
=
ãã 
ControllerContext
ãã 0
.
ãã0 1
HttpContext
ãã1 <
.
ãã< =
Request
ãã= D
.
ããD E
Cookies
ããE L
[
ããL M
$str
ããM S
]
ããS T
;
ããT U
string
åå 
correoActual
åå 
=
åå  !
(
åå" #
string
åå# )
)
åå) *
HttpContext
åå* 5
.
åå5 6
Session
åå6 =
[
åå= >
$str
åå> H
]
ååH I
;
ååI J
if
éé 
(
éé 
	Publicado
éé 
==
éé 
$str
éé #
)
éé# $
{
èè 
producto
êê 
.
êê 
	Publicado
êê "
=
êê# $
true
êê% )
;
êê) *
producto
ëë 
.
ëë 
FechaPublicado
ëë '
=
ëë( )
DateTime
ëë* 2
.
ëë2 3
Now
ëë3 6
;
ëë6 7
}
íí 
byte
îî 
[
îî 
]
îî 
imagenP1
îî 
=
îî 
{
îî 
}
îî  !
;
îî! "
byte
ïï 
[
ïï 
]
ïï 
imagenP2
ïï 
=
ïï 
{
ïï 
}
ïï  !
;
ïï! "
byte
ññ 
[
ññ 
]
ññ 
imagenP3
ññ 
=
ññ 
{
ññ 
}
ññ  !
;
ññ! "!
editeImagenProducto
òò 
(
òò  
Archivo_Imagen1
òò  /
,
òò/ 0
producto
òò1 9
,
òò9 :
imagenP1
òò; C
,
òòC D
$num
òòE F
)
òòF G
;
òòG H!
editeImagenProducto
ôô 
(
ôô  
Archivo_Imagen2
ôô  /
,
ôô/ 0
producto
ôô1 9
,
ôô9 :
imagenP2
ôô; C
,
ôôC D
$num
ôôE F
)
ôôF G
;
ôôG H!
editeImagenProducto
öö 
(
öö  
Archivo_Imagen3
öö  /
,
öö/ 0
producto
öö1 9
,
öö9 :
imagenP3
öö; C
,
ööC D
$num
ööE F
)
ööF G
;
ööG H
string
úú 
[
úú 
]
úú "
resultadosCheckboxes
úú )
=
úú* +
form
úú, 0
[
úú0 1
$str
úú1 D
]
úúD E
.
úúE F
Split
úúF K
(
úúK L
$char
úúL O
)
úúO P
;
úúP Q
List
ùù 
<
ùù 
string
ùù 
>
ùù '
resultadosCheckboxesLista
ùù 2
=
ùù3 4"
resultadosCheckboxes
ùù5 I
.
ùùI J
ToList
ùùJ P
(
ùùP Q
)
ùùQ R
;
ùùR S
for
üü 
(
üü 
int
üü 
i
üü 
=
üü 
$num
üü 
;
üü 
i
üü 
<
üü '
resultadosCheckboxesLista
üü  9
.
üü9 :
Count
üü: ?
;
üü? @
i
üüA B
++
üüB D
)
üüD E
{
†† 
string
°° 
	resultado
°°  
=
°°! "'
resultadosCheckboxesLista
°°# <
[
°°< =
i
°°= >
]
°°> ?
;
°°? @
if
¢¢ 
(
¢¢ 
	resultado
¢¢ 
==
¢¢  
$str
¢¢! '
)
¢¢' (
{
££ '
resultadosCheckboxesLista
§§ -
.
§§- .
RemoveAt
§§. 6
(
§§6 7
i
§§7 8
+
§§9 :
$num
§§; <
)
§§< =
;
§§= >
}
•• 
}
¶¶ 
List
®® 
<
®® 
	Categoria
®® 
>
®® 
listaCategorias
®® +
=
®®, -
new
®®. 1
List
®®2 6
<
®®6 7
	Categoria
®®7 @
>
®®@ A
(
®®A B
db
®®B D
.
®®D E

Categorias
®®E O
)
®®O P
;
®®P Q
for
™™ 
(
™™ 
int
™™ 
i
™™ 
=
™™ 
$num
™™ 
;
™™ 
i
™™ 
<
™™ '
resultadosCheckboxesLista
™™  9
.
™™9 :
Count
™™: ?
;
™™? @
i
™™A B
++
™™B D
)
™™D E
{
´´ 
if
¨¨ 
(
¨¨ '
resultadosCheckboxesLista
¨¨ -
[
¨¨- .
i
¨¨. /
]
¨¨/ 0
==
¨¨1 3
$str
¨¨4 :
)
¨¨: ;
{
≠≠ 
listaCategorias
ÆÆ #
[
ÆÆ# $
i
ÆÆ$ %
]
ÆÆ% &
.
ÆÆ& '

Productoes
ÆÆ' 1
.
ÆÆ1 2
Add
ÆÆ2 5
(
ÆÆ5 6
producto
ÆÆ6 >
)
ÆÆ> ?
;
ÆÆ? @
producto
ØØ 
.
ØØ 

Categorias
ØØ '
.
ØØ' (
Add
ØØ( +
(
ØØ+ ,
listaCategorias
ØØ, ;
[
ØØ; <
i
ØØ< =
]
ØØ= >
)
ØØ> ?
;
ØØ? @
}
∞∞ 
}
≤≤ 
if
µµ 
(
µµ 

ModelState
µµ 
.
µµ 
IsValid
µµ "
)
µµ" #
{
∂∂ 
db
∑∑ 
.
∑∑ 
Entry
∑∑ 
(
∑∑ 
producto
∑∑ !
)
∑∑! "
.
∑∑" #
State
∑∑# (
=
∑∑) *
EntityState
∑∑+ 6
.
∑∑6 7
Modified
∑∑7 ?
;
∑∑? @
try
∏∏ 
{
ππ 
db
∫∫ 
.
∫∫ 
SaveChanges
∫∫ "
(
∫∫" #
)
∫∫# $
;
∫∫$ %
}
ªª 
catch
ºº 
(
ºº )
DbEntityValidationException
ºº 2
e
ºº3 4
)
ºº4 5
{
ΩΩ 
throw
ææ 
;
ææ 
}
øø 
return
¿¿ 
RedirectToAction
¿¿ '
(
¿¿' (
$str
¿¿( /
)
¿¿/ 0
;
¿¿0 1
}
¡¡ 
ViewBag
¬¬ 
.
¬¬ 
CorreoCliente
¬¬ !
=
¬¬" #
new
¬¬$ '

SelectList
¬¬( 2
(
¬¬2 3
db
¬¬3 5
.
¬¬5 6
Clientes
¬¬6 >
,
¬¬> ?
$str
¬¬@ F
,
¬¬F G
producto
¬¬H P
.
¬¬P Q
CorreoCliente
¬¬Q ^
)
¬¬^ _
;
¬¬_ `
return
√√ 
View
√√ 
(
√√ 
producto
√√  
)
√√  !
;
√√! "
}
ƒƒ 	
public
«« 
ActionResult
«« 
Delete
«« "
(
««" #
int
««# &
?
««& '
id
««( *
,
««* +
string
««, 2
correo
««3 9
)
««9 :
{
»» 	
var
…… 
cookiecorreo
…… 
=
…… 
ControllerContext
…… 0
.
……0 1
HttpContext
……1 <
.
……< =
Request
……= D
.
……D E
Cookies
……E L
[
……L M
$str
……M S
]
……S T
;
……T U
if
   
(
   
id
   
==
   
null
   
)
   
{
ÀÀ 
return
ÃÃ 
new
ÃÃ "
HttpStatusCodeResult
ÃÃ /
(
ÃÃ/ 0
HttpStatusCode
ÃÃ0 >
.
ÃÃ> ?

BadRequest
ÃÃ? I
)
ÃÃI J
;
ÃÃJ K
}
ÕÕ 
Producto
ŒŒ 
producto
ŒŒ 
=
ŒŒ 
db
ŒŒ  "
.
ŒŒ" #

Productoes
ŒŒ# -
.
ŒŒ- .
Find
ŒŒ. 2
(
ŒŒ2 3
id
ŒŒ3 5
,
ŒŒ5 6
correo
ŒŒ7 =
)
ŒŒ= >
;
ŒŒ> ?
if
œœ 
(
œœ 
producto
œœ 
==
œœ 
null
œœ  
)
œœ  !
{
–– 
return
—— 
HttpNotFound
—— #
(
——# $
)
——$ %
;
——% &
}
““ 
return
”” 
View
”” 
(
”” 
producto
””  
)
””  !
;
””! "
}
‘‘ 	
[
◊◊ 	
HttpPost
◊◊	 
,
◊◊ 

ActionName
◊◊ 
(
◊◊ 
$str
◊◊ &
)
◊◊& '
]
◊◊' (
public
ŸŸ 
ActionResult
ŸŸ 
DeleteConfirmed
ŸŸ +
(
ŸŸ+ ,
int
ŸŸ, /
id
ŸŸ0 2
,
ŸŸ2 3
string
ŸŸ4 :
correo
ŸŸ; A
)
ŸŸA B
{
⁄⁄ 	
var
€€ 
cookiecorreo
€€ 
=
€€ 
ControllerContext
€€ 0
.
€€0 1
HttpContext
€€1 <
.
€€< =
Request
€€= D
.
€€D E
Cookies
€€E L
[
€€L M
$str
€€M S
]
€€S T
;
€€T U
Producto
‹‹ 
producto
‹‹ 
=
‹‹ 
db
‹‹  "
.
‹‹" #

Productoes
‹‹# -
.
‹‹- .
Find
‹‹. 2
(
‹‹2 3
id
‹‹3 5
,
‹‹5 6
correo
‹‹7 =
)
‹‹= >
;
‹‹> ?
producto
›› 
.
›› 
Estado
›› 
=
›› 
false
›› #
;
››# $
db
‡‡ 
.
‡‡ 
SaveChanges
‡‡ 
(
‡‡ 
)
‡‡ 
;
‡‡ 
return
·· 
RedirectToAction
·· #
(
··# $
$str
··$ +
)
··+ ,
;
··, -
}
‚‚ 	
public
‰‰ 
ActionResult
‰‰ 
Insertar
‰‰ $
(
‰‰$ %
)
‰‰% &
{
ÂÂ 	
return
ÊÊ 
View
ÊÊ 
(
ÊÊ 
)
ÊÊ 
;
ÊÊ 
}
ÁÁ 	
[
ÈÈ 	
HttpPost
ÈÈ	 
]
ÈÈ 
public
ÍÍ 
ActionResult
ÍÍ 
Insertar
ÍÍ $
(
ÍÍ$ %
Producto
ÍÍ% -
obj
ÍÍ. 1
)
ÍÍ1 2
{
ÎÎ 	
Producto
ÏÏ 
objreg
ÏÏ 
=
ÏÏ 
new
ÏÏ !
Producto
ÏÏ" *
(
ÏÏ* +
)
ÏÏ+ ,
;
ÏÏ, -

ModelState
ÔÔ 
.
ÔÔ 
Clear
ÔÔ 
(
ÔÔ 
)
ÔÔ 
;
ÔÔ 
return
 
View
 
(
 
)
 
;
 
}
ÒÒ 	
	protected
ÛÛ 
override
ÛÛ 
void
ÛÛ 
Dispose
ÛÛ  '
(
ÛÛ' (
bool
ÛÛ( ,
	disposing
ÛÛ- 6
)
ÛÛ6 7
{
ÙÙ 	
if
ıı 
(
ıı 
	disposing
ıı 
)
ıı 
{
ˆˆ 
db
˜˜ 
.
˜˜ 
Dispose
˜˜ 
(
˜˜ 
)
˜˜ 
;
˜˜ 
}
¯¯ 
base
˘˘ 
.
˘˘ 
Dispose
˘˘ 
(
˘˘ 
	disposing
˘˘ "
)
˘˘" #
;
˘˘# $
}
˙˙ 	
public
¸¸ 
ActionResult
¸¸ 
Publicar
¸¸ $
(
¸¸$ %
string
¸¸% +
searchBy
¸¸, 4
,
¸¸4 5
string
¸¸6 <
currentFilter
¸¸= J
,
¸¸J K
string
¸¸L R
searchString
¸¸S _
,
¸¸_ `
int
¸¸a d
?
¸¸d e
page
¸¸f j
)
¸¸j k
{
˝˝ 	
string
ˇˇ 
correoActual
ˇˇ 
=
ˇˇ  !
(
ˇˇ" #
string
ˇˇ# )
)
ˇˇ) *
HttpContext
ˇˇ* 5
.
ˇˇ5 6
Session
ˇˇ6 =
[
ˇˇ= >
$str
ˇˇ> H
]
ˇˇH I
;
ˇˇI J
ViewBag
ÅÅ 
.
ÅÅ 
CurrentSort
ÅÅ 
=
ÅÅ  !
searchBy
ÅÅ" *
;
ÅÅ* +
ViewBag
ÇÇ 
.
ÇÇ 
NameSortParm
ÇÇ  
=
ÇÇ! "
String
ÇÇ# )
.
ÇÇ) *
IsNullOrEmpty
ÇÇ* 7
(
ÇÇ7 8
searchBy
ÇÇ8 @
)
ÇÇ@ A
?
ÇÇB C
$str
ÇÇD N
:
ÇÇO P
$str
ÇÇQ S
;
ÇÇS T
ViewBag
ÉÉ 
.
ÉÉ 
SortPriceParm
ÉÉ !
=
ÉÉ" #
searchBy
ÉÉ$ ,
==
ÉÉ- /
$str
ÉÉ0 7
?
ÉÉ8 9
$str
ÉÉ: F
:
ÉÉG H
$str
ÉÉI P
;
ÉÉP Q
if
ââ 
(
ââ 
searchString
ââ 
!=
ââ 
null
ââ  $
)
ââ$ %
{
ää 
page
ãã 
=
ãã 
$num
ãã 
;
ãã 
}
åå 
else
çç 
{
éé 
searchString
èè 
=
èè 
currentFilter
èè ,
;
èè, -
}
êê 
ViewBag
íí 
.
íí 
CurrentFilter
íí !
=
íí" #
searchString
íí$ 0
;
íí0 1
var
ìì 
products
ìì 
=
ìì 
db
ìì 
.
ìì 

Productoes
ìì (
.
ìì( )
Include
ìì) 0
(
ìì0 1
c
ìì1 2
=>
ìì3 5
c
ìì6 7
.
ìì7 8
Cliente
ìì8 ?
)
ìì? @
;
ìì@ A
var
îî 
	productos
îî 
=
îî 
from
îî  
p
îî! "
in
îî# %
db
îî& (
.
îî( )

Productoes
îî) 3
select
ïï "
p
ïï# $
;
ïï$ %
	productos
ôô 
=
ôô 
	productos
ôô !
.
ôô! "
Where
ôô" '
(
ôô' (
p
ôô( )
=>
ôô* ,
p
ôô- .
.
ôô. /
Estado
ôô/ 5
==
ôô6 8
true
ôô9 =
)
ôô= >
;
ôô> ?
if
úú 
(
úú 
correoActual
úú 
!=
úú 
null
úú  $
)
úú$ %
{
ùù 
	productos
ûû 
=
ûû 
	productos
ûû %
.
ûû% &
Where
ûû& +
(
ûû+ ,
p
ûû, -
=>
ûû. 0
p
ûû1 2
.
ûû2 3
CorreoCliente
ûû3 @
==
ûûA C
correoActual
ûûD P
)
ûûP Q
;
ûûQ R
}
üü 
else
†† 
{
°° 
return
¢¢ 
RedirectToAction
¢¢ '
(
¢¢' (
$str
¢¢( 7
,
¢¢7 8
$str
¢¢9 E
)
¢¢E F
;
¢¢F G
}
££ 
switch
©© 
(
©© 
searchBy
©© 
)
©© 
{
™™ 
case
´´ 
$str
´´ 
:
´´  
	productos
¨¨ 
=
¨¨ 
	productos
¨¨  )
.
¨¨) *
OrderBy
¨¨* 1
(
¨¨1 2
p
¨¨2 3
=>
¨¨4 6
p
¨¨7 8
.
¨¨8 9
Nombre
¨¨9 ?
)
¨¨? @
;
¨¨@ A
break
≠≠ 
;
≠≠ 
case
ØØ 
$str
ØØ !
:
ØØ! "
	productos
∞∞ 
=
∞∞ 
	productos
∞∞  )
.
∞∞) *
OrderByDescending
∞∞* ;
(
∞∞; <
p
∞∞< =
=>
∞∞> @
p
∞∞A B
.
∞∞B C
PrecioEstimado
∞∞C Q
)
∞∞Q R
;
∞∞R S
break
±± 
;
±± 
case
≤≤ 
$str
≤≤ 
:
≤≤ 
	productos
≥≥ 
=
≥≥ 
	productos
≥≥  )
.
≥≥) *
OrderBy
≥≥* 1
(
≥≥1 2
p
≥≥2 3
=>
≥≥4 6
p
≥≥7 8
.
≥≥8 9
PrecioEstimado
≥≥9 G
)
≥≥G H
;
≥≥H I
break
¥¥ 
;
¥¥ 
default
µµ 
:
µµ 
	productos
∂∂ 
=
∂∂ 
	productos
∂∂  )
.
∂∂) *
OrderBy
∂∂* 1
(
∂∂1 2
p
∂∂2 3
=>
∂∂4 6
p
∂∂7 8
.
∂∂8 9
Nombre
∂∂9 ?
)
∂∂? @
;
∂∂@ A
break
∑∑ 
;
∑∑ 
}
∏∏ 
int
∫∫ 
pageSize
∫∫ 
=
∫∫ 
$num
∫∫ 
;
∫∫ 
int
ªª 

pageNumber
ªª 
=
ªª 
(
ªª 
page
ªª "
??
ªª# %
$num
ªª& '
)
ªª' (
;
ªª( )
return
ΩΩ 
View
ΩΩ 
(
ΩΩ 
	productos
ΩΩ !
.
ΩΩ! "
ToPagedList
ΩΩ" -
(
ΩΩ- .

pageNumber
ΩΩ. 8
,
ΩΩ8 9
pageSize
ΩΩ: B
)
ΩΩB C
)
ΩΩC D
;
ΩΩD E
}
ææ 	
public
√√ 
ActionResult
√√ 
VerSignUp_Usuario
√√ -
(
√√- .
)
√√. /
{
ƒƒ 	
return
≈≈ 
RedirectToAction
≈≈ #
(
≈≈# $
$str
≈≈$ ,
,
≈≈, -
$str
≈≈. 7
)
≈≈7 8
;
≈≈8 9
}
∆∆ 	
public
ÀÀ 
ActionResult
ÀÀ &
VerIndex_ProductosDelDia
ÀÀ 4
(
ÀÀ4 5
)
ÀÀ5 6
{
ÃÃ 	
return
ÕÕ 
RedirectToAction
ÕÕ #
(
ÕÕ# $
$str
ÕÕ$ +
,
ÕÕ+ ,
$str
ÕÕ- >
)
ÕÕ> ?
;
ÕÕ? @
}
ŒŒ 	
[
–– 	
Serializable
––	 
]
–– 
private
—— 
class
—— )
DbEntityValidationException
—— 1
:
——2 3
	Exception
——4 =
{
““ 	
public
”” )
DbEntityValidationException
”” .
(
””. /
)
””/ 0
{
‘‘ 
}
’’ 
public
◊◊ )
DbEntityValidationException
◊◊ .
(
◊◊. /
string
◊◊/ 5
message
◊◊6 =
)
◊◊= >
:
◊◊? @
base
◊◊A E
(
◊◊E F
message
◊◊F M
)
◊◊M N
{
ÿÿ 
}
ŸŸ 
public
€€ )
DbEntityValidationException
€€ .
(
€€. /
string
€€/ 5
message
€€6 =
,
€€= >
	Exception
€€? H
innerException
€€I W
)
€€W X
:
€€Y Z
base
€€[ _
(
€€_ `
message
€€` g
,
€€g h
innerException
€€i w
)
€€w x
{
‹‹ 
}
›› 
	protected
ﬂﬂ )
DbEntityValidationException
ﬂﬂ 1
(
ﬂﬂ1 2
SerializationInfo
ﬂﬂ2 C
info
ﬂﬂD H
,
ﬂﬂH I
StreamingContext
ﬂﬂJ Z
context
ﬂﬂ[ b
)
ﬂﬂb c
:
ﬂﬂd e
base
ﬂﬂf j
(
ﬂﬂj k
info
ﬂﬂk o
,
ﬂﬂo p
context
ﬂﬂq x
)
ﬂﬂx y
{
‡‡ 
}
·· 
public
„„ 
IEnumerable
„„ 
<
„„ 
object
„„ %
>
„„% &$
EntityValidationErrors
„„' =
{
„„> ?
get
„„@ C
;
„„C D
internal
„„E M
set
„„N Q
;
„„Q R
}
„„S T
}
‰‰ 	
}
ÂÂ 
}ÊÊ ﬁD
ÉC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\ProductosDelDiaController.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Controllers" -
{ 
public 

class %
ProductosDelDiaController *
:+ ,

Controller- 7
{ 
private 
TempPIEntities 
db !
=" #
new$ '
TempPIEntities( 6
(6 7
)7 8
;8 9
public 
ActionResult 
Index !
(! "
string" (
searchString) 5
,5 6
int7 :
?: ;
page< @
)@ A
{B C
DateTime 
fechaHoy 
= 
DateTime  (
.( )
Today) .
;. /
var 
	productos 
= 
from  
p! "
in# %
db& (
.( )#
Productos_Info_Clientes) @
where !
DbFunctions" -
.- .
TruncateTime. :
(: ;
p< =
.= >
FechaPublicado> L
)L M
==N P
fechaHoyQ Y
select "
p# $
;$ %
	productos 
= 
	productos !
.! "
OrderBy" )
() *
p* +
=>, .
p/ 0
.0 1
Nombre1 7
)7 8
;8 9
if'' 
('' 
!'' 
String'' 
.'' 
IsNullOrEmpty'' %
(''% &
searchString''& 2
)''2 3
)''3 4
{(( 
	productos)) 
=)) 
	productos)) $
.))$ %
Where))% *
())* +
p))+ ,
=>))- /
p))0 1
.))1 2
Nombre))2 8
.))8 9
Contains))9 A
())A B
searchString))B N
)))N O
)))O P
;))P Q
}** 
int,, 
pageSize,, 
=,, 
$num,, 
;,, 
int-- 

pageNumber-- 
=-- 
(-- 
page-- "
??--# %
$num--& '
)--' (
;--( )
string00 
correo00 
=00 
(00 
string00 #
)00# $
HttpContext00$ /
.00/ 0
Session000 7
[007 8
$str008 B
]00B C
;00C D
Administrador11 
admin11 
=11  !
db11" $
.11$ %
Administradors11% 3
.113 4
Find114 8
(118 9
correo119 ?
)11? @
;11@ A
var22 
view22 
=22 
View22 
(22 
$str22 #
,22# $
	productos22$ -
.22- .
ToPagedList22. 9
(229 :

pageNumber22: D
,22D E
pageSize22F N
)22N O
)22O P
;22P Q
if44 
(44 
admin44 
==44 
null44 
)44 
{55 
Cliente66 
cliente66 
=66  !
db66" $
.66$ %
Clientes66% -
.66- .
Find66. 2
(662 3
correo663 9
)669 :
;66: ;
if77 
(77 
cliente77 
==77 
null77 #
)77# $
{88 
return99 
view99 
;99  
}:: 
view;; 
.;; 

MasterName;; 
=;;  !
$str;;" H
;;;H I
return<< 
view<< 
;<< 
}== 
else>> 
{?? 
view@@ 
.@@ 

MasterName@@ 
=@@  !
$str@@" N
;@@N O
returnAA 
viewAA 
;AA 
}BB 
}DD 	
publicHH 
ActionResultHH 
DetailsHH #
(HH# $
intHH$ '
?HH' (
idHH) +
,HH+ ,
stringHH- 3
correoHH4 :
)HH: ;
{II 	
stringKK 
nombre_categoriaKK #
=KK$ %
$strKK& (
;KK( )
ProductoMM 
prodMM 
=MM 
dbMM 
.MM 

ProductoesMM )
.MM) *
FindMM* .
(MM. /
idMM/ 1
,MM1 2
correoMM3 9
)MM9 :
;MM: ;
ifOO 
(OO 
prodOO 
!=OO 
nullOO 
)OO 
{PP 
foreachQQ 
(QQ 
varQQ 
itemQQ !
inQQ" $
prodQQ% )
.QQ) *

CategoriasQQ* 4
)QQ4 5
{RR 
nombre_categoriaSS $
=SS% &
itemSS' +
.SS+ ,
NombreSS, 2
;SS2 3
}TT 
}UU 
varXX 
cookiecorreoXX 
=XX 
ControllerContextXX 0
.XX0 1
HttpContextXX1 <
.XX< =
RequestXX= D
.XXD E
CookiesXXE L
[XXL M
$strXXM S
]XXS T
;XXT U
ifYY 
(YY 
idYY 
==YY 
nullYY 
)YY 
{ZZ 
return[[ 
new[[  
HttpStatusCodeResult[[ /
([[/ 0
HttpStatusCode[[0 >
.[[> ?

BadRequest[[? I
)[[I J
;[[J K
}\\ 
Producto]] 
producto]] 
=]] 
db]]  "
.]]" #

Productoes]]# -
.]]- .
Find]]. 2
(]]2 3
id]]3 5
,]]5 6
correo]]7 =
)]]= >
;]]> ?
if^^ 
(^^ 
producto^^ 
==^^ 
null^^  
)^^  !
{__ 
return`` 
HttpNotFound`` #
(``# $
)``$ %
;``% &
}aa 
ViewBagbb 
.bb 
	esClientebb 
=bb 
truebb  $
;bb$ %
ViewBagcc 
.cc 
	Categoriacc 
=cc 
nombre_categoriacc  0
;cc0 1
stringdd 
correo_userdd 
=dd  
(dd! "
stringdd" (
)dd( )
HttpContextdd) 4
.dd4 5
Sessiondd5 <
[dd< =
$strdd= G
]ddG H
;ddH I
Administradoree 
adminee 
=ee  !
dbee" $
.ee$ %
Administradorsee% 3
.ee3 4
Findee4 8
(ee8 9
correo_useree9 D
)eeD E
;eeE F
varff 
viewff 
=ff 
Viewff 
(ff 
$strff %
,ff% &
productoff' /
)ff/ 0
;ff0 1
ifhh 
(hh 
adminhh 
==hh 
nullhh 
)hh 
{ii 
Clientejj 
clientejj 
=jj  !
dbjj" $
.jj$ %
Clientesjj% -
.jj- .
Findjj. 2
(jj2 3
correo_userjj3 >
)jj> ?
;jj? @
ifkk 
(kk 
clientekk 
==kk 
nullkk #
)kk# $
{ll 
ViewBagmm 
.mm 
	esClientemm %
=mm& '
falsemm( -
;mm- .
returnnn 
viewnn 
;nn  
}oo 
viewpp 
.pp 

MasterNamepp 
=pp  !
$strpp" H
;ppH I
returnqq 
viewqq 
;qq 
}rr 
elsess 
{tt 
viewuu 
.uu 

MasterNameuu 
=uu  !
$struu" N
;uuN O
returnvv 
viewvv 
;vv 
}ww 
}yy 	
public|| 
ActionResult|| $
VerIndex_ProductosDelDia|| 4
(||4 5
)||5 6
{}} 	
return~~ 
RedirectToAction~~ #
(~~# $
$str~~$ +
,~~+ ,
$str~~- >
)~~> ?
;~~? @
} 	
public
ÇÇ 
ActionResult
ÇÇ  
VerCreate_Producto
ÇÇ .
(
ÇÇ. /
)
ÇÇ/ 0
{
ÉÉ 	
return
ÑÑ 
RedirectToAction
ÑÑ #
(
ÑÑ# $
$str
ÑÑ$ ,
,
ÑÑ, -
$str
ÑÑ. 8
)
ÑÑ8 9
;
ÑÑ9 :
}
ÖÖ 	
public
ää 
ActionResult
ää 
VerSignUp_Usuario
ää -
(
ää- .
)
ää. /
{
ãã 	
return
çç 
RedirectToAction
çç #
(
çç# $
$str
çç$ 3
,
çç3 4
$str
çç5 A
)
ççA B
;
ççB C
}
èè 	
}
ìì 
}îî ÷ü
~C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\RegistradoController.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Controllers" -
{ 
public 

class  
RegistradoController %
:& '

Controller( 2
{ 
private 
TempPIEntities 
db !
=" #
new$ '
TempPIEntities( 6
(6 7
)7 8
;8 9
public 
ActionResult 
Index !
(! "
)" #
{ 	
return 
View 
( 
db 
. 
Registradoes '
.' (
ToList( .
(. /
)/ 0
)0 1
;1 2
} 	
public 
ActionResult 
Details #
(# $
string$ *
Correo+ 1
)1 2
{ 	
if 
( 
Correo 
== 
null 
) 
{ 
return   
new    
HttpStatusCodeResult   /
(  / 0
HttpStatusCode  0 >
.  > ?

BadRequest  ? I
)  I J
;  J K
}!! 

Registrado"" 

registrado"" !
=""" #
db""$ &
.""& '
Registradoes""' 3
.""3 4
Find""4 8
(""8 9
Correo""9 ?
)""? @
;""@ A
if## 
(## 

registrado## 
==## 
null## "
)##" #
{$$ 
return%% 
HttpNotFound%% #
(%%# $
)%%$ %
;%%% &
}&& 
return'' 
View'' 
('' 

registrado'' "
)''" #
;''# $
}(( 	
public++ 
ActionResult++ 
Create++ "
(++" #
)++# $
{,, 	
return-- 
View-- 
(-- 
)-- 
;-- 
}.. 	
public00 
ActionResult00 
Registro00 $
(00$ %
)00% &
{11 	
return22 
View22 
(22 
)22 
;22 
}33 	
publicAA	 
ActionResultAA 
ValidarRegistroAA ,
(AA, -
FormCollectionAA- ;
formAA< @
)AA@ A
{BB 	
stringCC 
correoCC 
=CC 
formCC  
[CC  !
$strCC! (
]CC( )
.CC) *
ToStringCC* 2
(CC2 3
)CC3 4
;CC4 5
stringDD 
Contrase√±aDD 
=DD 
formDD  $
[DD$ %
$strDD% 1
]DD1 2
.DD2 3
ToStringDD3 ;
(DD; <
)DD< =
;DD= >
ScryptEncoderEE 
encoderEE !
=EE" #
newEE$ '
ScryptEncoderEE( 5
(EE5 6
)EE6 7
;EE7 8

RegistradoGG 
usuarioGG 
=GG  
dbGG! #
.GG# $
RegistradoesGG$ 0
.GG0 1
FindGG1 5
(GG5 6
correoGG6 <
)GG< =
;GG= >
stringUU 
Contrase√±aHashedUU #
=UU$ %
encoderUU& -
.UU- .
EncodeUU. 4
(UU4 5
Contrase√±aUU5 ?
)UU? @
;UU@ A
stringWW 
codigoEnlaceWW 
=WW  !
GuidWW" &
.WW& '
NewGuidWW' .
(WW. /
)WW/ 0
.WW0 1
ToStringWW1 9
(WW9 :
)WW: ;
;WW; <
varXX 
enlaceVerificacionXX "
=XX# $
$strXX% J
;XXJ K
if[[ 
([[ 
usuario[[ 
!=[[ 
null[[ 
)[[  
{\\ 
TempData]] 
[]] 
$str]] &
]]]& '
=]]( )
$str]]* c
;]]c d
return^^ 
RedirectToAction^^ '
(^^' (
$str^^( 2
)^^2 3
;^^3 4
}__ 
else`` 
{aa 

Registradocc 
usuario1cc #
=cc$ %
newcc& )

Registradocc* 4
(cc4 5
)cc5 6
;cc6 7
usuario1dd 
.dd 
Correodd 
=dd  !
correodd" (
;dd( )
usuario1ff 
.ff 

Contrasenaff #
=ff$ %
Contrase√±aHashedff& 6
;ff6 7
dbhh 
.hh 
Registradoeshh 
.hh  
Addhh  #
(hh# $
usuario1hh$ ,
)hh, -
;hh- .
Clienteii 
cliente1ii  
=ii! "
newii# &
Clienteii' .
(ii. /
)ii/ 0
;ii0 1
cliente1jj 
.jj 
Correojj 
=jj  !
usuario1jj" *
.jj* +
Correojj+ 1
;jj1 2
dbkk 
.kk 
Clienteskk 
.kk 
Addkk 
(kk  
cliente1kk  (
)kk( )
;kk) *
dbll 
.ll 
SaveChangesll 
(ll 
)ll  
;ll  !
Sessionmm 
[mm 
$strmm #
]mm# $
=mm% &
usuario1mm' /
.mm/ 0
Correomm0 6
;mm6 7
EnviarCorreo
ÖÖ 
(
ÖÖ 
correo
ÖÖ #
,
ÖÖ# $
$strÖÖ% å
+ÖÖç é"
enlaceVerificacionÖÖè °
+ÖÖ¢ £
$strÖÖ§ Ã
)ÖÖÃ Õ
;ÖÖÕ Œ
return
àà 
View
àà 
(
àà 
$str
àà -
)
àà- .
;
àà. /
}
ââ 
}
ää 	
[
êê 	
HttpPost
êê	 
]
êê 
public
ëë 
ActionResult
ëë 
EnviarCorreo
ëë (
(
ëë( )
string
ëë) /
correo
ëë0 6
,
ëë6 7
string
ëë8 >
bodyMessage
ëë? J
)
ëëJ K
{
íí 	
var
îî 
fromAddress
îî 
=
îî  !
new
îî" %
MailAddress
îî& 1
(
îî1 2
$str
îî2 N
,
îîN O
$str
îîP ^
)
îî^ _
;
îî_ `
var
ïï 
	toAddress
ïï 
=
ïï 
new
ïï  #
MailAddress
ïï$ /
(
ïï/ 0
correo
ïï0 6
,
ïï6 7
$str
ïï8 J
)
ïïJ K
;
ïïK L
const
ññ 
string
ññ 
fromPassword
ññ )
=
ññ* +
$str
ññ, 7
;
ññ7 8
const
óó 
string
óó 
subject
óó $
=
óó% &
$str
óó' B
;
óóB C
string
òò 
body
òò 
=
òò 
bodyMessage
òò )
;
òò) *
var
öö 
smtp
öö 
=
öö 
new
öö 

SmtpClient
öö )
{
õõ 
Host
úú 
=
úú 
$str
úú +
,
úú+ ,
Port
ùù 
=
ùù 
$num
ùù 
,
ùù 
	EnableSsl
ûû 
=
ûû 
true
ûû  $
,
ûû$ %
DeliveryMethod
üü "
=
üü# $ 
SmtpDeliveryMethod
üü% 7
.
üü7 8
Network
üü8 ?
,
üü? @
Credentials
†† 
=
††  !
new
††" %
NetworkCredential
††& 7
(
††7 8
fromAddress
††8 C
.
††C D
Address
††D K
,
††K L
fromPassword
††M Y
)
††Y Z
,
††Z [
Timeout
¢¢ 
=
¢¢ 
$num
¢¢ #
}
££ 
;
££ 
using
§§ 
(
§§ 
var
§§ 
message
§§ "
=
§§# $
new
§§% (
MailMessage
§§) 4
(
§§4 5
fromAddress
§§5 @
,
§§@ A
	toAddress
§§B K
)
§§K L
{
•• 
Subject
¶¶ 
=
¶¶ 
subject
¶¶ %
,
¶¶% &
Body
ßß 
=
ßß 
body
ßß 
}
®® 
)
®® 
{
©© 
smtp
™™ 
.
™™ 
Send
™™ 
(
™™ 
message
™™ %
)
™™% &
;
™™& '
}
´´ 
return
¨¨ 
View
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
}
≠≠ 	
public
∞∞ 
Boolean
∞∞ '
verificarPrefNotificacion
∞∞ 0
(
∞∞0 1
string
∞∞1 7
correo
∞∞8 >
)
∞∞> ?
{
±± 	
Boolean
≤≤ 
	resultado
≤≤ 
=
≤≤ 
false
≤≤  %
;
≤≤% &

Registrado
≥≥ 

registrado
≥≥ !
=
≥≥" #
db
≥≥$ &
.
≥≥& '
Registradoes
≥≥' 3
.
≥≥3 4
Find
≥≥4 8
(
≥≥8 9
correo
≥≥9 ?
)
≥≥? @
;
≥≥@ A
if
¥¥ 
(
¥¥ 

registrado
¥¥ 
.
¥¥ 
EstadoCuenta
¥¥ '
==
¥¥( *
false
¥¥+ 0
)
¥¥0 1
{
µµ 
	resultado
∑∑ 
=
∑∑ 
true
∑∑  
;
∑∑  !
}
∏∏ 
else
ππ 
{
∫∫ 
Cliente
ªª 
cliente
ªª 
=
ªª  !
db
ªª" $
.
ªª$ %
Clientes
ªª% -
.
ªª- .
Find
ªª. 2
(
ªª2 3
correo
ªª3 9
)
ªª9 :
;
ªª: ;
if
ºº 
(
ºº 
cliente
ºº 
.
ºº $
BloquearNotificaciones
ºº 2
==
ºº3 5
false
ºº6 ;
)
ºº; <
{
ΩΩ 
	resultado
ææ 
=
ææ 
true
ææ  $
;
ææ$ %
}
øø 
}
¿¿ 
return
¡¡ 
	resultado
¡¡ 
;
¡¡ 
}
¬¬ 	
public
∆∆ 
ActionResult
∆∆ 
RegistroExitoso
∆∆ +
(
∆∆+ ,
)
∆∆, -
{
«« 	
return
»» 
View
»» 
(
»» 
)
»» 
;
»» 
}
…… 	
public
ÀÀ 
ActionResult
ÀÀ 
CondicionesUso
ÀÀ *
(
ÀÀ* +
)
ÀÀ+ ,
{
ÃÃ 	
return
ÕÕ 
View
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ 
}
ŒŒ 	
public
œœ 
ActionResult
œœ 
PerfilCompleto
œœ *
(
œœ* +
)
œœ+ ,
{
–– 	
return
—— 
View
—— 
(
—— 
)
—— 
;
—— 
}
““ 	
public
‘‘ 
ActionResult
‘‘ 
IniciarSesion
‘‘ )
(
‘‘) *
)
‘‘* +
{
’’ 	
LogOut
÷÷ 
(
÷÷ 
)
÷÷ 
;
÷÷ 
return
ÿÿ 
View
ÿÿ 
(
ÿÿ 
)
ÿÿ 
;
ÿÿ 
}
ŸŸ 	
[
€€ 	
HttpPost
€€	 
]
€€ 
public
‹‹ 
ActionResult
‹‹ !
ValidarInicioSesion
‹‹ /
(
‹‹/ 0
FormCollection
‹‹0 >
form
‹‹? C
)
‹‹C D
{
›› 	
ScryptEncoder
‚‚ 
decoder
‚‚ !
=
‚‚" #
new
‚‚$ '
ScryptEncoder
‚‚( 5
(
‚‚5 6
)
‚‚6 7
;
‚‚7 8
string
„„ 
correo1
„„ 
=
„„ 
form
„„ !
[
„„! "
$str
„„" +
]
„„+ ,
.
„„, -
ToString
„„- 5
(
„„5 6
)
„„6 7
;
„„7 8
string
‰‰ 
Contrase√±a1
‰‰ 
=
‰‰  
form
‰‰! %
[
‰‰% &
$str
‰‰& 3
]
‰‰3 4
.
‰‰4 5
ToString
‰‰5 =
(
‰‰= >
)
‰‰> ?
;
‰‰? @

Registrado
ÂÂ 
usuario
ÂÂ 
=
ÂÂ  
db
ÂÂ! #
.
ÂÂ# $
Registradoes
ÂÂ$ 0
.
ÂÂ0 1
Find
ÂÂ1 5
(
ÂÂ5 6
correo1
ÂÂ6 =
)
ÂÂ= >
;
ÂÂ> ?
Cliente
ÊÊ 
cliente
ÊÊ 
=
ÊÊ 
db
ÊÊ  
.
ÊÊ  !
Clientes
ÊÊ! )
.
ÊÊ) *
Find
ÊÊ* .
(
ÊÊ. /
correo1
ÊÊ/ 6
)
ÊÊ6 7
;
ÊÊ7 8

Suspension
ÁÁ 

suspension
ÁÁ !
=
ÁÁ" #
db
ÁÁ$ &
.
ÁÁ& '
Suspensions
ÁÁ' 2
.
ÁÁ2 3
Find
ÁÁ3 7
(
ÁÁ7 8
correo1
ÁÁ8 ?
)
ÁÁ? @
;
ÁÁ@ A
bool
ÎÎ 
contrase√±aValida
ÎÎ !
;
ÎÎ! "
string
ÒÒ 

checkResp1
ÒÒ 
=
ÒÒ 
form
ÒÒ  $
[
ÒÒ$ %
$str
ÒÒ% 0
]
ÒÒ0 1
;
ÒÒ1 2
bool
ÚÚ 
checkRespB1
ÚÚ 
=
ÚÚ 
Convert
ÚÚ &
.
ÚÚ& '
	ToBoolean
ÚÚ' 0
(
ÚÚ0 1

checkResp1
ÚÚ1 ;
)
ÚÚ; <
;
ÚÚ< =
if
ıı 
(
ıı 
checkRespB1
ıı 
==
ıı 
true
ıı #
)
ıı# $
{
ˆˆ 
if
˜˜ 
(
˜˜ 
usuario
˜˜ 
.
˜˜ 
EstadoCuenta
˜˜ (
==
˜˜) +
false
˜˜, 1
)
˜˜1 2
{
¯¯ 
if
˙˙ 
(
˙˙ 
usuario
˙˙ 
.
˙˙  
Nombre
˙˙  &
==
˙˙' )
null
˙˙* .
)
˙˙. /
{
˚˚ 
return
¸¸ 
RedirectToAction
¸¸ /
(
¸¸/ 0
$str
¸¸0 G
)
¸¸G H
;
¸¸H I
}
˝˝ 
}
ˇˇ 
else
ÄÄ 
{
ÅÅ 
if
ââ 
(
ââ 
(
ââ 
usuario
ââ  
.
ââ  !
Bloqueo
ââ! (
==
ââ) +
true
ââ, 0
)
ââ0 1
)
ââ1 2
{
ää 
return
ãã 
RedirectToAction
ãã /
(
ãã/ 0
$str
ãã0 I
)
ããI J
;
ããJ K
}
åå 
if
èè 
(
èè 
usuario
èè 
.
èè  
Correo
èè  &
==
èè' )

suspension
èè* 4
.
èè4 5
Correo
èè5 ;
)
èè; <
{
êê 
string
ëë !
mensajeReactivacion
ëë 2
=
ëë3 4
$str
ëë5 B
+
ëëC D
correo1
ëëE L
+
ëëM N
$str
ëëO u
+
ëëv w
$strëëx û
+ëëü †
clienteëë° ®
.ëë® ©
FechaCierreëë© ¥
+ëëµ ∂
$strëë∑ Ü
;ëëÜ á
EnviarCorreo
ìì $
(
ìì$ %
$str
ìì% 9
,
ìì9 :!
mensajeReactivacion
ìì; N
)
ììN O
;
ììO P
return
îî 
RedirectToAction
îî /
(
îî/ 0
$str
îî0 A
)
îîA B
;
îîB C
}
ïï 
}
ññ 
}
óó 
if
öö 
(
öö 
usuario
öö 
==
öö 
null
öö 
)
öö  
{
õõ 
TempData
úú 
[
úú 
$str
úú &
]
úú& '
=
úú( )
$str
úú* S
;
úúS T
return
ùù 
RedirectToAction
ùù '
(
ùù' (
$str
ùù( 7
)
ùù7 8
;
ùù8 9
}
ûû 
else
†† 
if
†† 
(
†† 
(
†† 
contrase√±aValida
†† &
=
††' (
decoder
††) 0
.
††0 1
Compare
††1 8
(
††8 9
Contrase√±a1
††9 D
,
††D E
usuario
††F M
.
††M N

Contrasena
††N X
)
††X Y
)
††Y Z
==
††[ ]
false
††^ c
)
††c d
{
££ 
TempData
§§ 
[
§§ 
$str
§§ &
]
§§& '
=
§§( )
$str
§§* S
;
§§S T
return
•• 
RedirectToAction
•• '
(
••' (
$str
••( 7
)
••7 8
;
••8 9
}
¶¶ 
else
ßß 
if
ßß 
(
ßß 
usuario
ßß 
.
ßß 
EstadoCuenta
ßß )
==
ßß* ,
false
ßß- 2
)
ßß2 3
{
®® 
TempData
©© 
[
©© 
$str
©© &
]
©©& '
=
©©( )
$str
©©* a
;
©©a b
return
™™ 
RedirectToAction
™™ '
(
™™' (
$str
™™( 7
)
™™7 8
;
™™8 9
}
´´ 
else
¨¨ 
if
¨¨ 
(
¨¨ 
usuario
¨¨ 
.
¨¨ 
Bloqueo
¨¨ $
==
¨¨% '
true
¨¨( ,
)
¨¨, -
{
≠≠ 
TempData
ÆÆ 
[
ÆÆ 
$str
ÆÆ &
]
ÆÆ& '
=
ÆÆ( )
$str
ÆÆ* H
;
ÆÆH I
return
ØØ 
RedirectToAction
ØØ '
(
ØØ' (
$str
ØØ( 7
)
ØØ7 8
;
ØØ8 9
}
∞∞ 
else
±± 
if
±± 
(
±± 

suspension
±± 
!=
±± !
null
±±" &
)
±±& '
{
≤≤ 
if
≥≥ 
(
≥≥ 

suspension
≥≥ 
.
≥≥ 
FechaFin
≥≥ '
>
≥≥' (
DateTime
≥≥( 0
.
≥≥0 1
Today
≥≥1 6
)
≥≥6 7
{
≥≥8 9
TempData
¥¥ 
[
¥¥ 
$str
¥¥ *
]
¥¥* +
=
¥¥, -
$str
¥¥. s
;
¥¥s t
return
µµ 
RedirectToAction
µµ +
(
µµ+ ,
$str
µµ, ;
)
µµ; <
;
µµ< =
}
∂∂ 
Login
∑∑ 
(
∑∑ 
usuario
∑∑ 
)
∑∑ 
;
∑∑ 
if
∏∏ 
(
∏∏ 
usuario
∏∏ 
.
∏∏ 
Nombre
∏∏ "
==
∏∏# %
null
∏∏& *
)
∏∏* +
{
ππ 
return
ªª 
RedirectToAction
ªª +
(
ªª+ ,
$str
ªª, :
,
ªª: ;
$str
ªª< E
)
ªªE F
;
ªªF G
}
ºº 
else
ΩΩ 
{
ææ 
return
øø 
RedirectToAction
øø +
(
øø+ ,
$str
øø, ;
,
øø; <
$str
øø= F
)
øøF G
;
øøG H
}
¿¿ 
}
¡¡ 
else
√√ 
{
ƒƒ 
Login
≈≈ 
(
≈≈ 
usuario
≈≈ 
)
≈≈ 
;
≈≈ 
Administrador
∆∆ 
admin
∆∆ #
=
∆∆$ %
db
∆∆& (
.
∆∆( )
Administradors
∆∆) 7
.
∆∆7 8
Find
∆∆8 <
(
∆∆< =
correo1
∆∆= D
)
∆∆D E
;
∆∆E F
if
«« 
(
«« 
admin
«« 
!=
«« 
null
«« !
)
««! "
{
»» 
return
…… 
RedirectToAction
…… +
(
……+ ,
$str
……, 3
,
……3 4
$str
……5 @
)
……@ A
;
……A B
}
   
else
ÀÀ 
if
ÀÀ 
(
ÀÀ 
usuario
ÀÀ  
.
ÀÀ  !
Nombre
ÀÀ! '
==
ÀÀ( *
null
ÀÀ+ /
)
ÀÀ/ 0
{
ÃÃ 
return
ŒŒ 
RedirectToAction
ŒŒ +
(
ŒŒ+ ,
$str
ŒŒ, :
,
ŒŒ: ;
$str
ŒŒ< E
)
ŒŒE F
;
ŒŒF G
}
œœ 
else
–– 
{
—— 
return
““ 
RedirectToAction
““ +
(
““+ ,
$str
““, ;
,
““; <
$str
““= F
)
““F G
;
““G H
}
”” 
}
‘‘ 
}
’’ 	
public
ÿÿ 
string
ÿÿ 
Login
ÿÿ 
(
ÿÿ 

Registrado
ÿÿ &
r
ÿÿ' (
)
ÿÿ( )
{
ŸŸ 	

HttpCookie
⁄⁄ 

UserCookie
⁄⁄ !
=
⁄⁄" #
new
⁄⁄$ '

HttpCookie
⁄⁄( 2
(
⁄⁄2 3
$str
⁄⁄3 9
,
⁄⁄9 :
r
⁄⁄; <
.
⁄⁄< =
Correo
⁄⁄= C
.
⁄⁄C D
ToString
⁄⁄D L
(
⁄⁄L M
)
⁄⁄M N
)
⁄⁄N O
;
⁄⁄O P

UserCookie
€€ 
.
€€ 
Expires
€€ 
.
€€ 
AddDays
€€ &
(
€€& '
$num
€€' (
)
€€( )
;
€€) *
HttpContext
‹‹ 
.
‹‹ 
Response
‹‹  
.
‹‹  !
	SetCookie
‹‹! *
(
‹‹* +

UserCookie
‹‹+ 5
)
‹‹5 6
;
‹‹6 7

HttpCookie
›› 
	NewCookie
››  
=
››! "
Request
››# *
.
››* +
Cookies
››+ 2
[
››2 3
$str
››3 9
]
››9 :
;
››: ;

Registrado
ﬁﬁ 
usuario
ﬁﬁ 
=
ﬁﬁ  
db
ﬁﬁ! #
.
ﬁﬁ# $
Registradoes
ﬁﬁ$ 0
.
ﬁﬁ0 1
Find
ﬁﬁ1 5
(
ﬁﬁ5 6
	NewCookie
ﬁﬁ6 ?
.
ﬁﬁ? @
Value
ﬁﬁ@ E
)
ﬁﬁE F
;
ﬁﬁF G
Session
ﬂﬂ 
[
ﬂﬂ 
$str
ﬂﬂ 
]
ﬂﬂ 
=
ﬂﬂ  !
usuario
ﬂﬂ" )
.
ﬂﬂ) *
Nombre
ﬂﬂ* 0
;
ﬂﬂ0 1
Session
‡‡ 
[
‡‡ 
$str
‡‡ 
]
‡‡ 
=
‡‡  !
usuario
‡‡" )
.
‡‡) *
Correo
‡‡* 0
;
‡‡0 1
return
·· 
	NewCookie
·· 
.
·· 
Value
·· "
;
··" #
}
‚‚ 	
public
‰‰ 
void
‰‰ 
LogOut
‰‰ 
(
‰‰ 
)
‰‰ 
{
ÂÂ 	
Response
ÊÊ 
.
ÊÊ 
Cookies
ÊÊ 
[
ÊÊ 
$str
ÊÊ #
]
ÊÊ# $
.
ÊÊ$ %
Expires
ÊÊ% ,
=
ÊÊ- .
DateTime
ÊÊ/ 7
.
ÊÊ7 8
Now
ÊÊ8 ;
.
ÊÊ; <
AddDays
ÊÊ< C
(
ÊÊC D
-
ÊÊD E
$num
ÊÊE F
)
ÊÊF G
;
ÊÊG H
Session
ÁÁ 
[
ÁÁ 
$str
ÁÁ 
]
ÁÁ 
=
ÁÁ  !
$str
ÁÁ" $
;
ÁÁ$ %
Session
ËË 
[
ËË 
$str
ËË 
]
ËË 
=
ËË  !
$str
ËË" $
;
ËË$ %
}
ÍÍ 	
[
ÓÓ 	
HttpPost
ÓÓ	 
]
ÓÓ 
public
 
ActionResult
 
Create
 "
(
" #
[
# $
Bind
$ (
(
( )
Include
) 0
=
1 2
$str
3 n
)
n o
]
o p

Registrado
q {

registrado| Ü
)Ü á
{
ÒÒ 	
if
ÚÚ 
(
ÚÚ 

ModelState
ÚÚ 
.
ÚÚ 
IsValid
ÚÚ "
)
ÚÚ" #
{
ÛÛ 
db
ÙÙ 
.
ÙÙ 
Registradoes
ÙÙ 
.
ÙÙ  
Add
ÙÙ  #
(
ÙÙ# $

registrado
ÙÙ$ .
)
ÙÙ. /
;
ÙÙ/ 0
db
ıı 
.
ıı 
SaveChanges
ıı 
(
ıı 
)
ıı  
;
ıı  !
return
ˆˆ 
RedirectToAction
ˆˆ '
(
ˆˆ' (
$str
ˆˆ( /
)
ˆˆ/ 0
;
ˆˆ0 1
}
˜˜ 
return
˘˘ 
View
˘˘ 
(
˘˘ 

registrado
˘˘ "
)
˘˘" #
;
˘˘# $
}
˙˙ 	
public
˝˝ 
ActionResult
˝˝ 
Edit
˝˝  
(
˝˝  !
string
˝˝! '
Correo
˝˝( .
)
˝˝. /
{
˛˛ 	
if
ÄÄ 
(
ÄÄ 
Correo
ÄÄ 
==
ÄÄ 
null
ÄÄ 
)
ÄÄ 
{
ÅÅ 
return
ÇÇ 
new
ÇÇ "
HttpStatusCodeResult
ÇÇ /
(
ÇÇ/ 0
HttpStatusCode
ÇÇ0 >
.
ÇÇ> ?

BadRequest
ÇÇ? I
)
ÇÇI J
;
ÇÇJ K
}
ÉÉ 

Registrado
ÑÑ 

registrado
ÑÑ !
=
ÑÑ" #
db
ÑÑ$ &
.
ÑÑ& '
Registradoes
ÑÑ' 3
.
ÑÑ3 4
Find
ÑÑ4 8
(
ÑÑ8 9
Correo
ÑÑ9 ?
)
ÑÑ? @
;
ÑÑ@ A
if
ÖÖ 
(
ÖÖ 

registrado
ÖÖ 
==
ÖÖ 
null
ÖÖ "
)
ÖÖ" #
{
ÜÜ 
return
áá 
HttpNotFound
áá #
(
áá# $
)
áá$ %
;
áá% &
}
àà 
return
ää 
View
ää 
(
ää 

registrado
ää "
)
ää" #
;
ää# $
}
ãã 	
public
ùù 
ActionResult
ùù "
RestaurarContrase√±a
ùù /
(
ùù/ 0
)
ùù0 1
{
ûû 	
return
üü 
View
üü 
(
üü 
)
üü 
;
üü 
}
†† 	
[
££ 	
HttpPost
££	 
]
££ 
public
§§ 
ActionResult
§§ "
RestaurarContrase√±a
§§ /
(
§§/ 0
FormCollection
§§0 >
form
§§? C
)
§§C D
{
•• 	
string
¶¶ 
correo
¶¶ 
=
¶¶ 
form
¶¶  
[
¶¶  !
$str
¶¶! *
]
¶¶* +
.
¶¶+ ,
ToString
¶¶, 4
(
¶¶4 5
)
¶¶5 6
;
¶¶6 7
string
ßß 
codigoCambio
ßß 
=
ßß  !
Guid
ßß" &
.
ßß& '
NewGuid
ßß' .
(
ßß. /
)
ßß/ 0
.
ßß0 1
ToString
ßß1 9
(
ßß9 :
)
ßß: ;
;
ßß; <
string
®® 
mensaje
®® 
=
®® 
$str
®® 
;
®®  

Registrado
©© 

registrado
©© !
=
©©" #
db
©©$ &
.
©©& '
Registradoes
©©' 3
.
©©3 4
Find
©©4 8
(
©©8 9
correo
©©9 ?
)
©©? @
;
©©@ A
if
™™ 
(
™™ 

registrado
™™ 
!=
™™ 
null
™™ "
)
™™" #
{
´´ 
var
¨¨ 
	verifyUrl
¨¨ 
=
¨¨ 
$str
¨¨  @
+
¨¨A B
codigoCambio
¨¨C O
;
¨¨O P
var
≠≠ 
link
≠≠ 
=
≠≠ 
Request
≠≠ "
.
≠≠" #
Url
≠≠# &
.
≠≠& '
AbsoluteUri
≠≠' 2
.
≠≠2 3
Replace
≠≠3 :
(
≠≠: ;
Request
≠≠; B
.
≠≠B C
Url
≠≠C F
.
≠≠F G
PathAndQuery
≠≠G S
,
≠≠S T
	verifyUrl
≠≠U ^
)
≠≠^ _
;
≠≠_ `
EnviarCorreo
ÆÆ 
(
ÆÆ 
correo
ÆÆ #
,
ÆÆ# $
$strÆÆ% ›
+ÆÆﬁ ﬂ
linkÆÆ‡ ‰
)ÆÆ‰ Â
;ÆÆÂ Ê

registrado
±± 
.
±± $
CodigoCambioContrasena
±± 1
=
±±2 3
codigoCambio
±±4 @
;
±±@ A
db
≤≤ 
.
≤≤ 
SaveChanges
≤≤ 
(
≤≤ 
)
≤≤  
;
≤≤  !
mensaje
¥¥ 
=
¥¥ 
$str¥¥ Ä
;¥¥Ä Å
}
µµ 
else
∂∂ 
{
∑∑ 
mensaje
∏∏ 
=
∏∏ 
$str
∏∏ G
;
∏∏G H
}
ππ 
ViewBag
∫∫ 
.
∫∫ 
Message
∫∫ 
=
∫∫ 
mensaje
∫∫ %
;
∫∫% &
return
ªª 
View
ªª 
(
ªª 
)
ªª 
;
ªª 
}
ºº 	
public
øø 
ActionResult
øø 
CambiarContrasena
øø -
(
øø- .
string
øø. 4
id
øø5 7
)
øø7 8
{
¿¿ 	
if
¬¬ 
(
¬¬ 
string
¬¬ 
.
¬¬ 
IsNullOrEmpty
¬¬ $
(
¬¬$ %
id
¬¬% '
)
¬¬' (
)
¬¬( )
{
√√ 
return
ƒƒ 
HttpNotFound
ƒƒ #
(
ƒƒ# $
)
ƒƒ$ %
;
ƒƒ% &
}
≈≈ 
var
»» 
usuario
»» 
=
»» 
db
»» 
.
»» 
Registradoes
»» )
.
»») *
Where
»»* /
(
»»/ 0
u
»»0 1
=>
»»2 4
u
»»5 6
.
»»6 7$
CodigoCambioContrasena
»»7 M
==
»»N P
id
»»Q S
)
»»S T
.
»»T U
FirstOrDefault
»»U c
(
»»c d
)
»»d e
;
»»e f
if
…… 
(
…… 
usuario
…… 
!=
…… 
null
…… 
)
……  
{
   $
CambiarContrasenaModel
ÀÀ &
model
ÀÀ' ,
=
ÀÀ- .
new
ÀÀ/ 2$
CambiarContrasenaModel
ÀÀ3 I
(
ÀÀI J
)
ÀÀJ K
;
ÀÀK L
model
ÃÃ 
.
ÃÃ 
CodigoCambio
ÃÃ "
=
ÃÃ# $
id
ÃÃ% '
;
ÃÃ' (
return
ÕÕ 
View
ÕÕ 
(
ÕÕ 
model
ÕÕ !
)
ÕÕ! "
;
ÕÕ" #
}
ŒŒ 
else
œœ 
{
–– 
return
—— 
HttpNotFound
—— #
(
——# $
)
——$ %
;
——% &
}
““ 
}
‘‘ 	
[
÷÷ 	
HttpPost
÷÷	 
]
÷÷ 
public
ÿÿ 
ActionResult
ÿÿ 
CambiarContrasena
ÿÿ -
(
ÿÿ- .$
CambiarContrasenaModel
ÿÿ. D
model
ÿÿE J
)
ÿÿJ K
{
ŸŸ 	
string
⁄⁄ 
mensaje
⁄⁄ 
=
⁄⁄ 
$str
⁄⁄ 
;
⁄⁄  
if
‹‹ 
(
‹‹ 

ModelState
‹‹ 
.
‹‹ 
IsValid
‹‹ "
)
‹‹" #
{
›› 
var
ﬁﬁ 
usuario
ﬁﬁ 
=
ﬁﬁ 
db
ﬁﬁ  
.
ﬁﬁ  !
Registradoes
ﬁﬁ! -
.
ﬁﬁ- .
Where
ﬁﬁ. 3
(
ﬁﬁ3 4
u
ﬁﬁ4 5
=>
ﬁﬁ6 8
u
ﬁﬁ9 :
.
ﬁﬁ: ;$
CodigoCambioContrasena
ﬁﬁ; Q
==
ﬁﬁR T
model
ﬁﬁU Z
.
ﬁﬁZ [
CodigoCambio
ﬁﬁ[ g
)
ﬁﬁg h
.
ﬁﬁh i
FirstOrDefault
ﬁﬁi w
(
ﬁﬁw x
)
ﬁﬁx y
;
ﬁﬁy z
if
ﬂﬂ 
(
ﬂﬂ 
usuario
ﬂﬂ 
!=
ﬂﬂ 
null
ﬂﬂ #
)
ﬂﬂ# $
{
‡‡ 
ScryptEncoder
·· !
encoder
··" )
=
··* +
new
··, /
ScryptEncoder
··0 =
(
··= >
)
··> ?
;
··? @
string
‚‚ 
ContrasenaHashed
‚‚ +
=
‚‚, -
encoder
‚‚. 5
.
‚‚5 6
Encode
‚‚6 <
(
‚‚< =
model
‚‚= B
.
‚‚B C
NuevaContrasena
‚‚C R
)
‚‚R S
;
‚‚S T
usuario
„„ 
.
„„ 

Contrasena
„„ &
=
„„' (
ContrasenaHashed
„„) 9
;
„„9 :
usuario
‰‰ 
.
‰‰ $
CodigoCambioContrasena
‰‰ 2
=
‰‰3 4
$str
‰‰5 7
;
‰‰7 8
db
ÂÂ 
.
ÂÂ 
SaveChanges
ÂÂ "
(
ÂÂ" #
)
ÂÂ# $
;
ÂÂ$ %
return
ÊÊ 
View
ÊÊ 
(
ÊÊ  
$str
ÊÊ  ;
)
ÊÊ; <
;
ÊÊ< =
}
ÁÁ 
}
ËË 
mensaje
ÈÈ 
=
ÈÈ 
$str
ÈÈ .
;
ÈÈ. /
ViewBag
ÍÍ 
.
ÍÍ 
Messsage
ÍÍ 
=
ÍÍ 
mensaje
ÍÍ &
;
ÍÍ& '
return
ÎÎ 
View
ÎÎ 
(
ÎÎ 
model
ÎÎ 
)
ÎÎ 
;
ÎÎ 
}
ÏÏ 	
public
ÓÓ 
ActionResult
ÓÓ '
Cambio_Contrasena_Exitoso
ÓÓ 5
(
ÓÓ5 6
)
ÓÓ6 7
{
ÔÔ 	
return
 
View
 
(
 
$str
 *
)
* +
;
+ ,
}
ÒÒ 	
[
ˆˆ 	
HttpPost
ˆˆ	 
]
ˆˆ 
public
¯¯ 
ActionResult
¯¯ 
Edit
¯¯  
(
¯¯  !
[
¯¯! "
Bind
¯¯" &
(
¯¯& '
Include
¯¯' .
=
¯¯/ 0
$str
¯¯1 l
)
¯¯l m
]
¯¯m n

Registrado
¯¯o y

registrado¯¯z Ñ
)¯¯Ñ Ö
{
˘˘ 	
if
˙˙ 
(
˙˙ 

ModelState
˙˙ 
.
˙˙ 
IsValid
˙˙ "
)
˙˙" #
{
˚˚ 
db
˝˝ 
.
˝˝ 
Entry
˝˝ 
(
˝˝ 

registrado
˝˝ #
)
˝˝# $
.
˝˝$ %
State
˝˝% *
=
˝˝+ ,
EntityState
˝˝- 8
.
˝˝8 9
Modified
˝˝9 A
;
˝˝A B

registrado
˛˛ 
.
˛˛ 
EstadoCuenta
˛˛ '
=
˛˛( )
true
˛˛* .
;
˛˛. /
db
ˇˇ 
.
ˇˇ 
SaveChanges
ˇˇ 
(
ˇˇ 
)
ˇˇ  
;
ˇˇ  !
return
ÄÄ 
RedirectToAction
ÄÄ '
(
ÄÄ' (
$str
ÄÄ( /
)
ÄÄ/ 0
;
ÄÄ0 1
}
ÅÅ 
return
ÇÇ 
View
ÇÇ 
(
ÇÇ 

registrado
ÇÇ "
)
ÇÇ" #
;
ÇÇ# $
}
ÉÉ 	
public
ÜÜ 
ActionResult
ÜÜ 
Delete
ÜÜ "
(
ÜÜ" #
string
ÜÜ# )
Correo
ÜÜ* 0
)
ÜÜ0 1
{
áá 	
if
àà 
(
àà 
Correo
àà 
==
àà 
null
àà 
)
àà 
{
ââ 
return
ää 
new
ää "
HttpStatusCodeResult
ää /
(
ää/ 0
HttpStatusCode
ää0 >
.
ää> ?

BadRequest
ää? I
)
ääI J
;
ääJ K
}
ãã 

Registrado
åå 

registrado
åå !
=
åå" #
db
åå$ &
.
åå& '
Registradoes
åå' 3
.
åå3 4
Find
åå4 8
(
åå8 9
Correo
åå9 ?
)
åå? @
;
åå@ A
if
çç 
(
çç 

registrado
çç 
==
çç 
null
çç "
)
çç" #
{
éé 
return
èè 
HttpNotFound
èè #
(
èè# $
)
èè$ %
;
èè% &
}
êê 
return
ëë 
View
ëë 
(
ëë 

registrado
ëë "
)
ëë" #
;
ëë# $
}
íí 	
[
ïï 	
HttpPost
ïï	 
,
ïï 

ActionName
ïï 
(
ïï 
$str
ïï &
)
ïï& '
]
ïï' (
public
óó 
ActionResult
óó 
DeleteConfirmed
óó +
(
óó+ ,
string
óó, 2
Correo
óó3 9
)
óó9 :
{
òò 	

Registrado
ôô 

registrado
ôô !
=
ôô" #
db
ôô$ &
.
ôô& '
Registradoes
ôô' 3
.
ôô3 4
Find
ôô4 8
(
ôô8 9
Correo
ôô9 ?
)
ôô? @
;
ôô@ A
db
öö 
.
öö 
Registradoes
öö 
.
öö 
Remove
öö "
(
öö" #

registrado
öö# -
)
öö- .
;
öö. /
db
õõ 
.
õõ 
SaveChanges
õõ 
(
õõ 
)
õõ 
;
õõ 
return
úú 
RedirectToAction
úú #
(
úú# $
$str
úú$ +
)
úú+ ,
;
úú, -
}
ùù 	
public
üü 
ActionResult
üü 
ReactivarCuenta
üü +
(
üü+ ,
)
üü, -
{
†† 	
return
°° 
View
°° 
(
°° 
$str
°° )
)
°°) *
;
°°* +
}
¢¢ 	
public
§§ 
ActionResult
§§ #
ReactivarProcRegistro
§§ 1
(
§§1 2
)
§§2 3
{
•• 	
return
¶¶ 
View
¶¶ 
(
¶¶ 
$str
¶¶ /
)
¶¶/ 0
;
¶¶0 1
}
ßß 	
public
©© 
ActionResult
©© %
ReactivarBloqPermanente
©© 3
(
©©3 4
)
©©4 5
{
™™ 	
return
´´ 
View
´´ 
(
´´ 
$str
´´ 1
)
´´1 2
;
´´2 3
}
¨¨ 	
public
ÆÆ 
ActionResult
ÆÆ  
ReactivarCuentaAct
ÆÆ .
(
ÆÆ. /
)
ÆÆ/ 0
{
ØØ 	
return
∞∞ 
View
∞∞ 
(
∞∞ 
$str
∞∞ ,
)
∞∞, -
;
∞∞- .
}
±± 	
public
≥≥ 
ActionResult
≥≥ (
ReactivarCuentaInexistente
≥≥ 6
(
≥≥6 7
)
≥≥7 8
{
¥¥ 	
return
µµ 
View
µµ 
(
µµ 
$str
µµ 4
)
µµ4 5
;
µµ5 6
}
∂∂ 	
	protected
∏∏ 
override
∏∏ 
void
∏∏ 
Dispose
∏∏  '
(
∏∏' (
bool
∏∏( ,
	disposing
∏∏- 6
)
∏∏6 7
{
ππ 	
if
∫∫ 
(
∫∫ 
	disposing
∫∫ 
)
∫∫ 
{
ªª 
db
ºº 
.
ºº 
Dispose
ºº 
(
ºº 
)
ºº 
;
ºº 
}
ΩΩ 
base
ææ 
.
ææ 
Dispose
ææ 
(
ææ 
	disposing
ææ "
)
ææ" #
;
ææ# $
}
øø 	
}
¿¿ 
}¡¡ ÿ
}C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\SolicitudController.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Controllers" -
{ 
public		 

class		 
SolicitudController		 $
:		% &

Controller		' 1
{

 
public 
ActionResult 
Index !
(! "
)" #
{ 	
return 
View 
( 
) 
; 
} 	
} 
} õ—
|C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\SubastasController.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Controllers" -
{ 
public 

class 
SubastasController #
:$ %

Controller& 0
{ 
private 
TempPIEntities 
db !
=" #
new$ '
TempPIEntities( 6
(6 7
)7 8
;8 9
public 
ActionResult 
Index !
(! "
)" #
{   	
var!! 
cookiecorreo!! 
=!! 
ControllerContext!! 0
.!!0 1
HttpContext!!1 <
.!!< =
Request!!= D
.!!D E
Cookies!!E L
[!!L M
$str!!M S
]!!S T
;!!T U
string"" 
correoActual"" 
=""  !
(""" #
string""# )
)"") *
HttpContext""* 5
.""5 6
Session""6 =
[""= >
$str""> H
]""H I
;""I J
var## 
subastas## 
=## 
db## 
.## 
sp_Subasta_Select## /
(##/ 0
correoActual##0 <
)##< =
;##= >
List$$ 
<$$ 
int$$ 
>$$ 
visualizaciones$$ %
=$$& '
new$$( +
List$$, 0
<$$0 1
int$$1 4
>$$4 5
($$5 6
)$$6 7
;$$7 8
foreach%% 
(%% 
var%% 
item%% 
in%%  
subastas%%! )
)%%) *
{&& 
if'' 
('' 
item'' 
.'' 
PublicoEspecial'' (
=='') +
$num'', -
)''- .
visualizaciones(( #
.((# $
Add(($ '
(((' (
-((( )
$num(() *
)((* +
;((+ ,
if)) 
()) 
item)) 
.)) 
PublicoEspecial)) (
==))) +
$num)), -
)))- .
visualizaciones** #
.**# $
Add**$ '
(**' (
db**( *
.*** +"
spSubasta_ContarAmigos**+ A
(**A B
item**B F
.**F G
ProductoIDSubastado**G Z
,**Z [
item**\ `
.**` a
CorreoSubastador**a q
,**q r
item**s w
.**w x
FechaPublicado	**x Ü
)
**Ü á
.
**á à
Count
**à ç
(
**ç é
)
**é è
)
**è ê
;
**ê ë
if++ 
(++ 
item++ 
.++ 
PublicoEspecial++ (
==++) +
$num++, -
)++- .
visualizaciones,, #
.,,# $
Add,,$ '
(,,' (
-,,( )
$num,,) *
),,* +
;,,+ ,
}// 
ViewBag00 
.00 
visualizaciones00 #
=00$ %
visualizaciones00& 5
;005 6
subastas22 
=22 
db22 
.22 
sp_Subasta_Select22 +
(22+ ,
correoActual22, 8
)228 9
;229 :
if44 
(44 
correoActual44 
!=44 
null44  $
)44$ %
return55 
View55 
(55 
subastas55 $
.55$ %
ToList55% +
(55+ ,
)55, -
)55- .
;55. /
else66 
return77 
RedirectToAction77 '
(77' (
$str77( 7
,777 8
$str779 E
)77E F
;77F G
}99 	
public<< 
ActionResult<< 
Details<< #
(<<# $
int<<$ '
?<<' (

idProducto<<) 3
,<<3 4
string<<5 ;
correo<<< B
,<<B C
DateTime<<D L
?<<L M
fecha<<N S
)<<S T
{== 	
var?? 
cookiecorreo?? 
=?? 
ControllerContext?? 0
.??0 1
HttpContext??1 <
.??< =
Request??= D
.??D E
Cookies??E L
[??L M
$str??M S
]??S T
;??T U
string@@ 
correoActual@@ 
=@@  !
(@@" #
string@@# )
)@@) *
HttpContext@@* 5
.@@5 6
Session@@6 =
[@@= >
$str@@> H
]@@H I
;@@I J
ifAA 
(AA 
correoActualAA 
==AA 
nullAA  $
)AA$ %
{BB 
returnCC 
RedirectToActionCC '
(CC' (
$strCC( 7
,CC7 8
$strCC9 E
)CCE F
;CCF G
}DD 
ifEE 
(EE 

idProductoEE 
==EE 
nullEE "
)EE" #
{FF 
returnGG 
newGG  
HttpStatusCodeResultGG /
(GG/ 0
HttpStatusCodeGG0 >
.GG> ?

BadRequestGG? I
)GGI J
;GGJ K
}HH 
SubastaJJ 
subastaJJ 
=JJ 
dbJJ  
.JJ  !
SubastasJJ! )
.JJ) *
FindJJ* .
(JJ. /

idProductoJJ/ 9
,JJ9 :
correoJJ; A
,JJA B
fechaJJC H
)JJH I
;JJI J
ifKK 
(KK 
subastaKK 
==KK 
nullKK 
)KK  
{LL 
returnMM 
RedirectToActionMM '
(MM' (
$strMM( =
,MM= >
$strMM? I
)MMI J
;MMJ K
}NN +
Relacion_ClienteOfertaEnSubastaOO +
ofertaMayorOO, 7
;OO7 8
varPP 
ofertaPP 
=PP 
fromPP 
pPP 
inPP  "
dbPP# %
.PP% &+
Relacion_ClienteOfertaEnSubastaPP& E
selectQQ 
pQQ  !
;QQ! "
varRR 
oferta2RR 
=RR 
fromRR 
mRR  
inRR! #
dbRR$ &
.RR& '+
Relacion_ClienteOfertaEnSubastaRR' F
selectSS  
mSS! "
;SS" #
ofertaTT 
=TT 
ofertaTT 
.TT 
WhereTT !
(TT! "
pTT" #
=>TT$ &
pTT' (
.TT( )
ProductoIDSubastadoTT) <
==TT= ?

idProductoTT@ J
)TTJ K
;TTK L
intUU 
difUU 
=UU 
DateTimeUU 
.UU 
CompareUU &
(UU& '
subastaUU' .
.UU. /
FechaFinUU/ 7
,UU7 8
DateTimeUU9 A
.UUA B
NowUUB E
)UUE F
;UUF G
ifXX 
(XX 
difXX 
<XX 
$numXX 
)XX 
{YY 
ifZZ 
(ZZ 
ofertaZZ 
.ZZ 
AnyZZ 
(ZZ 
)ZZ  
)ZZ  !
{[[ 
double\\ 
pre\\ 
=\\  
oferta\\! '
.\\' (
Max\\( +
(\\+ ,
o\\, -
=>\\. 0
o\\1 2
.\\2 3
PrecioOfrecido\\3 A
)\\A B
;\\B C
oferta2]] 
=]] 
oferta2]] %
.]]% &
Where]]& +
(]]+ ,
m]], -
=>]]. 0
m]]1 2
.]]2 3
PrecioOfrecido]]3 A
==]]B D
pre]]E H
&&]]I K
m]]L M
.]]M N
ProductoIDSubastado]]N a
==]]b d

idProducto]]e o
)]]o p
;]]p q
ofertaMayor^^ 
=^^  !
db^^" $
.^^$ %+
Relacion_ClienteOfertaEnSubasta^^% D
.^^D E
SingleOrDefault^^E T
(^^T U
x^^U V
=>^^W Y
x^^Z [
.^^[ \
ProductoIDSubastado^^\ o
==^^p r

idProducto^^s }
&&	^^~ Ä
x
^^Å Ç
.
^^Ç É
PrecioOfrecido
^^É ë
==
^^í î
pre
^^ï ò
)
^^ò ô
;
^^ô ö
ViewBag__ 
.__ 
OfertaMaxima__ (
=__) *
pre__+ .
;__. /
ViewBag`` 
.`` 
Persona`` #
=``$ %
ofertaMayor``& 1
.``1 2
CorreoOfertador``2 A
;``A B
}cc 
elsedd 
{ee 
ViewBagff 
.ff 
Personaff #
=ff$ %
$strff& 9
;ff9 :
ViewBaggg 
.gg 
OfertaMaximagg (
=gg) *
$numgg+ ,
;gg, -
}hh 
}ii 
returnmm 
Viewmm 
(mm 
subastamm 
)mm  
;mm  !
}nn 	
publicss 
ActionResultss 
Createss "
(ss" #
intss# &
?ss& '

idProductoss( 2
,ss2 3
stringss4 :
correoss; A
)ssA B
{tt 	
stringuu 
correoActualuu 
=uu  !
(uu" #
stringuu# )
)uu) *
HttpContextuu* 5
.uu5 6
Sessionuu6 =
[uu= >
$struu> H
]uuH I
;uuI J
ifvv 
(vv 
correoActualvv 
==vv 
nullvv  $
)vv$ %
{ww 
returnxx 
RedirectToActionxx '
(xx' (
$strxx( 7
,xx7 8
$strxx9 E
)xxE F
;xxF G
}yy 
Subastazz 
subastazz 
=zz 
newzz !
Subastazz" )
(zz) *
)zz* +
;zz+ ,
Producto{{ 
prod{{ 
={{ 
new{{ 
Producto{{  (
({{( )
){{) *
;{{* +
Producto|| 
pro|| 
=|| 
db|| 
.|| 

Productoes|| (
.||( )
Find||) -
(||- .

idProducto||. 8
,||8 9
correo||: @
)||@ A
;||A B
if}} 
(}} 
pro}} 
==}} 
null}} 
)}} 
{~~ 
return 
RedirectToAction '
(' (
$str( =
,= >
$str? I
)I J
;J K
}
ÄÄ 
subasta
ÅÅ 
.
ÅÅ !
ProductoIDSubastado
ÅÅ '
=
ÅÅ( )
(
ÅÅ* +
int
ÅÅ+ .
)
ÅÅ. /

idProducto
ÅÅ/ 9
;
ÅÅ9 :
subasta
ÇÇ 
.
ÇÇ 
CorreoSubastador
ÇÇ $
=
ÇÇ% &
correo
ÇÇ' -
;
ÇÇ- .
SubastaViewModel
ÑÑ 
tmodel
ÑÑ #
=
ÑÑ$ %
new
ÑÑ& )
SubastaViewModel
ÑÑ* :
(
ÑÑ: ;
)
ÑÑ; <
;
ÑÑ< =
var
ÖÖ 
subastaB
ÖÖ 
=
ÖÖ 
from
ÖÖ 
p
ÖÖ  !
in
ÖÖ" $
db
ÖÖ% '
.
ÖÖ' (
Subastas
ÖÖ( 0
select
ÜÜ !
p
ÜÜ" #
;
ÜÜ# $
var
áá 
	productoB
áá 
=
áá 
from
áá  
ps
áá! #
in
áá$ &
db
áá' )
.
áá) *

Productoes
áá* 4
select
àà "
ps
àà# %
;
àà% &
var
ãã 
	sublistas
ãã 
=
ãã 
from
ãã  
s
ãã! "
in
ãã# %
db
ãã& (
.
ãã( )
	Sublistas
ãã) 2
select
åå "
s
åå# $
;
åå$ %
	sublistas
çç 
=
çç 
	sublistas
çç !
.
çç! "
Where
çç" '
(
çç' (
s
çç( )
=>
çç* ,
s
çç- .
.
çç. /
CorreoDueno
çç/ :
==
çç; =
correoActual
çç> J
)
ççJ K
;
ççK L
tmodel
èè 
.
èè 
	sublistas
èè 
=
èè 
new
èè "
List
èè# '
<
èè' (
SelectListItem
èè( 6
>
èè6 7
(
èè7 8
)
èè8 9
;
èè9 :
tmodel
êê 
.
êê 
	sublistas
êê 
.
êê 
Add
êê  
(
êê  !
new
êê! $
SelectListItem
êê% 3
{
êê4 5
Text
êê6 :
=
êê; <
$str
êê= @
,
êê@ A
Value
êêB G
=
êêH I
$str
êêJ S
}
êêT U
)
êêU V
;
êêV W
tmodel
ëë 
.
ëë 
	sublistas
ëë 
.
ëë 
Add
ëë  
(
ëë  !
new
ëë! $
SelectListItem
ëë% 3
{
ëë4 5
Text
ëë6 :
=
ëë; <
$str
ëë= @
,
ëë@ A
Value
ëëB G
=
ëëH I
$str
ëëJ V
}
ëëW X
)
ëëX Y
;
ëëY Z
foreach
íí 
(
íí 
var
íí 
item
íí 
in
íí  
	sublistas
íí! *
)
íí* +
{
íí, -
tmodel
ìì 
.
ìì 
	sublistas
ìì  
.
ìì  !
Add
ìì! $
(
ìì$ %
new
ìì% (
SelectListItem
ìì) 7
{
ìì8 9
Text
ìì: >
=
ìì? @
item
ììA E
.
ììE F
id
ììF H
.
ììH I
ToString
ììI Q
(
ììQ R
)
ììR S
,
ììS T
Value
ììU Z
=
ìì[ \
item
ìì] a
.
ììa b
NombreSublista
ììb p
}
ììq r
)
ììr s
;
ììs t
}
îî 
tmodel
ññ 
.
ññ 
	Productos
ññ 
=
ññ 
pro
ññ "
;
ññ" #
tmodel
óó 
.
óó 
Subastas
óó 
=
óó 
subasta
óó %
;
óó% &
return
òò 
View
òò 
(
òò 
tmodel
òò 
)
òò 
;
òò  
}
öö 	
[
üü 	
HttpPost
üü	 
]
üü 
public
°° 
ActionResult
°° 
Create
°° "
(
°°" #
[
°°# $
Bind
°°$ (
(
°°( )
Include
°°) 0
=
°°1 2
$str°°3 ‡
)°°‡ ·
]°°· ‚ 
SubastaViewModel°°„ Û
subasta°°Ù ˚
)°°˚ ¸
{
¢¢ 	
string
§§ 
fecha
§§ 
=
§§ 
DateTime
§§ #
.
§§# $
Now
§§$ '
.
§§' (
ToString
§§( 0
(
§§0 1
$str
§§1 F
)
§§F G
;
§§G H
CultureInfo
•• 
provider
••  
=
••! "
CultureInfo
••# .
.
••. /
InvariantCulture
••/ ?
;
••? @
string
¶¶ 
format
¶¶ 
=
¶¶ 
$str
¶¶ 1
;
¶¶1 2
DateTime
ßß 
FechaI
ßß 
=
ßß 
DateTime
ßß &
.
ßß& '

ParseExact
ßß' 1
(
ßß1 2
fecha
ßß2 7
,
ßß7 8
format
ßß9 ?
,
ßß? @
provider
ßßA I
)
ßßI J
;
ßßJ K
TimeSpan
™™ 
tiempo
™™ 
=
™™ 
TimeSpan
™™ &
.
™™& '
Parse
™™' ,
(
™™, -
subasta
™™- 4
.
™™4 5

HoraInicio
™™5 ?
)
™™? @
;
™™@ A
fecha
´´ 
=
´´ 
subasta
´´ 
.
´´ 

FechInicio
´´ &
+
´´' (
$str
´´) ,
+
´´- .
subasta
´´/ 6
.
´´6 7

HoraInicio
´´7 A
+
´´B C
$str
´´D I
;
´´I J
DateTime
¨¨  
fechaInicioSubasta
¨¨ '
=
¨¨( )
DateTime
¨¨* 2
.
¨¨2 3

ParseExact
¨¨3 =
(
¨¨= >
fecha
¨¨> C
,
¨¨C D
format
¨¨E K
,
¨¨K L
provider
¨¨M U
)
¨¨U V
;
¨¨V W
fecha
ØØ 
=
ØØ 
subasta
ØØ 
.
ØØ 
FechFin
ØØ #
+
ØØ$ %
$str
ØØ& )
+
ØØ* +
subasta
ØØ, 3
.
ØØ3 4
HoraFin
ØØ4 ;
+
ØØ< =
$str
ØØ> C
;
ØØC D
DateTime
∞∞ 
fechaFinSubasta
∞∞ $
=
∞∞% &
DateTime
∞∞' /
.
∞∞/ 0

ParseExact
∞∞0 :
(
∞∞: ;
fecha
∞∞; @
,
∞∞@ A
format
∞∞A G
,
∞∞G H
provider
∞∞I Q
)
∞∞Q R
;
∞∞R S
string
≥≥ 
correoActual
≥≥ 
=
≥≥  !
(
≥≥" #
string
≥≥# )
)
≥≥) *
HttpContext
≥≥* 5
.
≥≥5 6
Session
≥≥6 =
[
≥≥= >
$str
≥≥> H
]
≥≥H I
;
≥≥I J
Subasta
¥¥ 
subastaPrueba
¥¥ !
=
¥¥" #
new
¥¥$ '
Subasta
¥¥( /
(
¥¥/ 0
)
¥¥0 1
;
¥¥1 2
if
µµ 
(
µµ 
subasta
µµ 
.
µµ 
	sublistas
µµ !
!=
µµ" $
null
µµ% )
)
µµ) *
{
µµ+ ,
if
∂∂ 
(
∂∂ 

ModelState
∂∂ 
.
∂∂ 
IsValid
∂∂ &
)
∂∂& '
{
∑∑ 
subastaPrueba
∏∏ !
.
∏∏! "!
ProductoIDSubastado
∏∏" 5
=
∏∏6 7
subasta
∏∏8 ?
.
∏∏? @!
ProductoIDSubastado
∏∏@ S
;
∏∏S T
subastaPrueba
ππ !
.
ππ! "
CorreoSubastador
ππ" 2
=
ππ3 4
correoActual
ππ5 A
;
ππA B
subastaPrueba
∫∫ !
.
∫∫! "
FechaPublicado
∫∫" 0
=
∫∫1 2
FechaI
∫∫3 9
;
∫∫9 :
subastaPrueba
ªª !
.
ªª! "
FechaInicio
ªª" -
=
ªª. / 
fechaInicioSubasta
ªª0 B
;
ªªB C
subastaPrueba
ºº !
.
ºº! "
FechaFin
ºº" *
=
ºº+ ,
fechaFinSubasta
ºº- <
;
ºº< =
subastaPrueba
ΩΩ !
.
ΩΩ! "
PrecioMinimo
ΩΩ" .
=
ΩΩ/ 0
subasta
ΩΩ1 8
.
ΩΩ8 9
PrecioMinimo
ΩΩ9 E
;
ΩΩE F
if
ææ 
(
ææ 
subasta
ææ 
.
ææ  
	sublistas
ææ  )
[
ææ) *
$num
ææ* +
]
ææ+ ,
.
ææ, -
Selected
ææ- 5
)
ææ5 6
{
øø 
subastaPrueba
¿¿ %
.
¿¿% &
PublicoEspecial
¿¿& 5
=
¿¿6 7
$num
¿¿8 9
;
¿¿9 :
}
¡¡ 
else
¬¬ 
{
¬¬ 
if
√√ 
(
√√ 
!
√√ 
subasta
√√ $
.
√√$ %
	sublistas
√√% .
[
√√. /
$num
√√/ 0
]
√√0 1
.
√√1 2
Selected
√√2 :
&&
√√; =
!
√√> ?
subasta
√√? F
.
√√F G
	sublistas
√√G P
[
√√P Q
$num
√√Q R
]
√√R S
.
√√S T
Selected
√√T \
)
√√\ ]
{
√√^ _
subastaPrueba
ƒƒ )
.
ƒƒ) *
PublicoEspecial
ƒƒ* 9
=
ƒƒ: ;
$num
ƒƒ< =
;
ƒƒ= >
}
≈≈ 
}
∆∆ 
subastaPrueba
»» !
.
»»! "
Mensaje
»»" )
=
»»* +
subasta
»», 3
.
»»3 4
Mensaje
»»4 ;
;
»»; <
db
…… 
.
…… 
Subastas
…… 
.
……  
Add
……  #
(
……# $
subastaPrueba
……$ 1
)
……1 2
;
……2 3
db
   
.
   
SaveChanges
   "
(
  " #
)
  # $
;
  $ %
}
ÀÀ 
ViewBag
ÃÃ 
.
ÃÃ 
Hola
ÃÃ 
=
ÃÃ 
$str
ÃÃ %
;
ÃÃ% &
var
ŒŒ 
listas
ŒŒ 
=
ŒŒ 
from
ŒŒ !
s
ŒŒ" #
in
ŒŒ$ &
db
ŒŒ' )
.
ŒŒ) *
	Sublistas
ŒŒ* 3
select
œœ #
s
œœ$ %
;
œœ% &
listas
–– 
=
–– 
listas
–– 
.
––  
Where
––  %
(
––% &
s
––& '
=>
––( *
s
––+ ,
.
––, -
CorreoDueno
––- 8
==
––9 ;
correoActual
––< H
)
––H I
;
––I J
if
““ 
(
““ 
!
““ 
subasta
““ 
.
““ 
	sublistas
““ &
[
““& '
$num
““' (
]
““( )
.
““) *
Selected
““* 2
&&
““3 5
!
““6 7
subasta
““7 >
.
““> ?
	sublistas
““? H
[
““H I
$num
““I J
]
““J K
.
““K L
Selected
““L T
)
““T U
{
”” 
for
‘‘ 
(
‘‘ 
int
‘‘ 
i
‘‘ 
=
‘‘  
$num
‘‘! "
;
‘‘" #
i
‘‘$ %
<
‘‘& '
subasta
‘‘( /
.
‘‘/ 0
	sublistas
‘‘0 9
.
‘‘9 :
Count
‘‘: ?
(
‘‘? @
)
‘‘@ A
;
‘‘A B
++
‘‘C E
i
‘‘E F
)
‘‘F G
{
’’ 
if
÷÷ 
(
÷÷ 
subasta
÷÷ #
.
÷÷# $
	sublistas
÷÷$ -
[
÷÷- .
i
÷÷. /
]
÷÷/ 0
.
÷÷0 1
Selected
÷÷1 9
)
÷÷9 :
{
◊◊ 
foreach
ÿÿ #
(
ÿÿ$ %
var
ÿÿ% (
item
ÿÿ) -
in
ÿÿ. 0
listas
ÿÿ1 7
)
ÿÿ7 8
{
ŸŸ 
if
⁄⁄  "
(
⁄⁄# $
item
⁄⁄$ (
.
⁄⁄( )
id
⁄⁄) +
==
⁄⁄, .
Int32
⁄⁄/ 4
.
⁄⁄4 5
Parse
⁄⁄5 :
(
⁄⁄: ;
subasta
⁄⁄; B
.
⁄⁄B C
	sublistas
⁄⁄C L
[
⁄⁄L M
i
⁄⁄M N
]
⁄⁄N O
.
⁄⁄O P
Text
⁄⁄P T
)
⁄⁄T U
)
⁄⁄U V
{
€€  !
subastaPrueba
››$ 1
.
››1 23
%spRelacion_Subasta_Visible_A_Insertar
››2 W
(
››W X
item
››X \
.
››\ ]
CorreoDueno
››] h
,
››h i
item
››j n
.
››n o
id
››o q
,
››q r
subastaPrueba››s Ä
.››Ä Å#
ProductoIDSubastado››Å î
,››î ï
subastaPrueba››ñ £
.››£ § 
CorreoSubastador››§ ¥
,››¥ µ
subastaPrueba››∂ √
.››√ ƒ
FechaPublicado››ƒ “
)››“ ”
;››” ‘
}
ﬁﬁ  !
}
ﬂﬂ 
}
‡‡ 
}
·· 
}
‚‚ 
return
„„ 
RedirectToAction
„„ '
(
„„' (
$str
„„( /
)
„„/ 0
;
„„0 1
}
‰‰ 
return
ÁÁ 
View
ÁÁ 
(
ÁÁ 
)
ÁÁ 
;
ÁÁ 
}
ËË 	
public
ÍÍ 
ActionResult
ÍÍ 
misSubastas
ÍÍ '
(
ÍÍ' (
)
ÍÍ( )
{
ÎÎ 	
var
ÏÏ 
cookiecorreo
ÏÏ 
=
ÏÏ 
ControllerContext
ÏÏ 0
.
ÏÏ0 1
HttpContext
ÏÏ1 <
.
ÏÏ< =
Request
ÏÏ= D
.
ÏÏD E
Cookies
ÏÏE L
[
ÏÏL M
$str
ÏÏM S
]
ÏÏS T
;
ÏÏT U
string
ÌÌ 
correoActual
ÌÌ 
=
ÌÌ  !
(
ÌÌ" #
string
ÌÌ# )
)
ÌÌ) *
HttpContext
ÌÌ* 5
.
ÌÌ5 6
Session
ÌÌ6 =
[
ÌÌ= >
$str
ÌÌ> H
]
ÌÌH I
;
ÌÌI J
if
ÓÓ 
(
ÓÓ 
correoActual
ÓÓ 
==
ÓÓ 
null
ÓÓ  $
)
ÓÓ$ %
{
ÔÔ 
return
 
RedirectToAction
 '
(
' (
$str
( 7
,
7 8
$str
9 E
)
E F
;
F G
}
ÒÒ 
var
ÚÚ 
subastas
ÚÚ 
=
ÚÚ 
db
ÚÚ 
.
ÚÚ 
Subastas
ÚÚ &
.
ÚÚ& '
Include
ÚÚ' .
(
ÚÚ. /
s
ÚÚ/ 0
=>
ÚÚ1 3
s
ÚÚ4 5
.
ÚÚ5 6
Producto
ÚÚ6 >
)
ÚÚ> ?
;
ÚÚ? @
if
ÛÛ 
(
ÛÛ 
correoActual
ÛÛ 
!=
ÛÛ 
null
ÛÛ  $
)
ÛÛ$ %
return
ÙÙ 
View
ÙÙ 
(
ÙÙ 
subastas
ÙÙ $
.
ÙÙ$ %
ToList
ÙÙ% +
(
ÙÙ+ ,
)
ÙÙ, -
)
ÙÙ- .
;
ÙÙ. /
else
ıı 
return
ˆˆ 
RedirectToAction
ˆˆ '
(
ˆˆ' (
$str
ˆˆ( 7
,
ˆˆ7 8
$str
ˆˆ9 E
)
ˆˆE F
;
ˆˆF G
}
˜˜ 	
public
˘˘ 
ActionResult
˘˘ 
OfertarEnSubasta
˘˘ ,
(
˘˘, -
int
˘˘- 0
?
˘˘0 1

idProducto
˘˘2 <
,
˘˘< =
string
˘˘> D
correo
˘˘E K
,
˘˘K L
DateTime
˘˘M U
fechaPublicado
˘˘V d
)
˘˘d e
{
˙˙ 	
string
˚˚ 
correoActual
˚˚ 
=
˚˚  !
(
˚˚" #
string
˚˚# )
)
˚˚) *
HttpContext
˚˚* 5
.
˚˚5 6
Session
˚˚6 =
[
˚˚= >
$str
˚˚> H
]
˚˚H I
;
˚˚I J
if
¸¸ 
(
¸¸ 
correoActual
¸¸ 
==
¸¸ 
null
¸¸  $
)
¸¸$ %
{
˝˝ 
return
˛˛ 
RedirectToAction
˛˛ '
(
˛˛' (
$str
˛˛( 7
,
˛˛7 8
$str
˛˛9 E
)
˛˛E F
;
˛˛F G
}
ˇˇ 
string
ÅÅ 
fecha
ÅÅ 
=
ÅÅ 
fechaPublicado
ÅÅ )
.
ÅÅ) *
ToString
ÅÅ* 2
(
ÅÅ2 3
$str
ÅÅ3 H
)
ÅÅH I
;
ÅÅI J
CultureInfo
ÇÇ 
provider
ÇÇ  
=
ÇÇ! "
CultureInfo
ÇÇ# .
.
ÇÇ. /
InvariantCulture
ÇÇ/ ?
;
ÇÇ? @
string
ÉÉ 
format
ÉÉ 
=
ÉÉ 
$str
ÉÉ 1
;
ÉÉ1 2
DateTime
ÑÑ 
FechaI
ÑÑ 
=
ÑÑ 
DateTime
ÑÑ &
.
ÑÑ& '

ParseExact
ÑÑ' 1
(
ÑÑ1 2
fecha
ÑÑ2 7
,
ÑÑ7 8
format
ÑÑ9 ?
,
ÑÑ? @
provider
ÑÑA I
)
ÑÑI J
;
ÑÑJ K
Subasta
ÜÜ 
subast
ÜÜ 
=
ÜÜ 
db
ÜÜ 
.
ÜÜ  
Subastas
ÜÜ  (
.
ÜÜ( )
Find
ÜÜ) -
(
ÜÜ- .

idProducto
ÜÜ. 8
,
ÜÜ8 9
correo
ÜÜ: @
,
ÜÜ@ A
FechaI
ÜÜA G
)
ÜÜG H
;
ÜÜH I
if
áá 
(
áá 
subast
áá 
==
áá 
null
áá 
)
áá 
{
àà 
return
ââ 
RedirectToAction
ââ '
(
ââ' (
$str
ââ( =
,
ââ= >
$str
ââ? I
)
ââI J
;
ââJ K
}
ää 
subast
ãã 
.
ãã 
FechaPublicado
ãã !
=
ãã" #
FechaI
ãã$ *
;
ãã* +
SubastaViewModel
åå 
tmodel
åå #
=
åå$ %
new
åå& )
SubastaViewModel
åå* :
(
åå: ;
)
åå; <
;
åå< =-
Relacion_ClienteOfertaEnSubasta
èè +
ofertarSubasta
èè, :
=
èè; <
new
èè= @-
Relacion_ClienteOfertaEnSubasta
èèA `
(
èè` a
)
èèa b
;
èèb c
ofertarSubasta
êê 
.
êê !
ProductoIDSubastado
êê .
=
êê/ 0
(
êê1 2
int
êê2 5
)
êê5 6

idProducto
êê6 @
;
êê@ A
ofertarSubasta
ëë 
.
ëë 
CorreoSubastador
ëë +
=
ëë, -
correo
ëë. 4
;
ëë4 5
ofertarSubasta
íí 
.
íí 
FechaPublicado
íí )
=
íí* +
FechaI
íí, 2
;
íí2 3
tmodel
ìì 
.
ìì 
Subastas
ìì 
=
ìì 
subast
ìì $
;
ìì$ %
tmodel
îî 
.
îî .
 relacion_ClienteOfertaEnSubastas
îî 3
=
îî4 5
ofertarSubasta
îî6 D
;
îîD E
var
óó 
ofertas
óó 
=
óó 
db
óó 
.
óó -
Relacion_ClienteOfertaEnSubasta
óó <
.
óó< =
Include
óó= D
(
óóD E
c
óóE F
=>
óóG I
c
óóJ K
.
óóK L
Subasta
óóL S
)
óóS T
;
óóT U
var
òò 
oferta
òò 
=
òò 
from
òò 
p
òò 
in
òò  "
db
òò# %
.
òò% &-
Relacion_ClienteOfertaEnSubasta
òò& E
select
ôô 
p
ôô  !
;
ôô! "
oferta
öö 
=
öö 
oferta
öö 
.
öö 
Where
öö !
(
öö! "
p
öö" #
=>
öö$ &
p
öö' (
.
öö( )!
ProductoIDSubastado
öö) <
==
öö= ?

idProducto
öö@ J
)
ööJ K
;
ööK L
if
ùù 
(
ùù 
oferta
ùù 
.
ùù 
Any
ùù 
(
ùù 
)
ùù 
)
ùù 
{
ûû 
ViewBag
üü 
.
üü 
OfertaMaxima
üü $
=
üü% &
oferta
üü' -
.
üü- .
Max
üü. 1
(
üü1 2
o
üü2 3
=>
üü4 6
o
üü7 8
.
üü8 9
PrecioOfrecido
üü9 G
)
üüG H
;
üüH I
}
†† 
else
°° 
{
¢¢ 
ViewBag
££ 
.
££ 
OfertaMaxima
££ $
=
££% &
$num
££' (
;
££( )
}
§§ 
return
´´ 
View
´´ 
(
´´ 
tmodel
´´ 
)
´´ 
;
´´  
}
ØØ 	
[
±± 	
HttpPost
±±	 
]
±± 
public
≥≥ 
ActionResult
≥≥ 
OfertarEnSubasta
≥≥ ,
(
≥≥, -
[
≥≥- .
Bind
≥≥. 2
(
≥≥2 3
Include
≥≥3 :
=
≥≥; <
$str≥≥= ï
)≥≥ï ñ
]≥≥ñ ó 
SubastaViewModel≥≥ò ®
ofertaSubasta≥≥© ∂
)≥≥∂ ∑
{
¥¥ 	
DateTime
µµ 
var
µµ 
=
µµ 
ofertaSubasta
µµ (
.
µµ( )
FechaPublicado
µµ) 7
;
µµ7 8
string
∂∂ 
fecha
∂∂ 
=
∂∂ 
ofertaSubasta
∂∂ (
.
∂∂( )
FechaPublicado
∂∂) 7
.
∂∂7 8
ToString
∂∂8 @
(
∂∂@ A
$str
∂∂A V
)
∂∂V W
;
∂∂W X
CultureInfo
∑∑ 
provider
∑∑  
=
∑∑! "
CultureInfo
∑∑# .
.
∑∑. /
InvariantCulture
∑∑/ ?
;
∑∑? @
string
∏∏ 
format
∏∏ 
=
∏∏ 
$str
∏∏ 1
;
∏∏1 2
DateTime
ππ 
FechaI
ππ 
=
ππ 
DateTime
ππ &
.
ππ& '

ParseExact
ππ' 1
(
ππ1 2
fecha
ππ2 7
,
ππ7 8
format
ππ9 ?
,
ππ? @
provider
ππA I
)
ππI J
;
ππJ K
ofertaSubasta
ªª 
.
ªª 
FechaPublicado
ªª (
=
ªª) *
FechaI
ªª+ 1
;
ªª1 2
string
ΩΩ 
correoActual
ΩΩ 
=
ΩΩ  !
(
ΩΩ" #
string
ΩΩ# )
)
ΩΩ) *
HttpContext
ΩΩ* 5
.
ΩΩ5 6
Session
ΩΩ6 =
[
ΩΩ= >
$str
ΩΩ> H
]
ΩΩH I
;
ΩΩI J
var
øø 
oferta
øø 
=
øø 
from
øø 
p
øø 
in
øø  "
db
øø# %
.
øø% &-
Relacion_ClienteOfertaEnSubasta
øø& E
select
¿¿ 
p
¿¿  !
;
¿¿! "
oferta
¡¡ 
=
¡¡ 
oferta
¡¡ 
.
¡¡ 
Where
¡¡ !
(
¡¡! "
p
¡¡" #
=>
¡¡$ &
p
¡¡' (
.
¡¡( )!
ProductoIDSubastado
¡¡) <
==
¡¡= ?
ofertaSubasta
¡¡@ M
.
¡¡M N!
ProductoIDSubastado
¡¡N a
)
¡¡a b
;
¡¡b c-
Relacion_ClienteOfertaEnSubasta
¬¬ +
ofertar
¬¬, 3
=
¬¬4 5
new
¬¬6 9-
Relacion_ClienteOfertaEnSubasta
¬¬: Y
(
¬¬Y Z
)
¬¬Z [
;
¬¬[ \
Producto
∆∆ 
prod
∆∆ 
=
∆∆ 
db
∆∆ 
.
∆∆ 

Productoes
∆∆ )
.
∆∆) *
Find
∆∆* .
(
∆∆. /
ofertaSubasta
∆∆/ <
.
∆∆< =!
ProductoIDSubastado
∆∆= P
,
∆∆P Q
ofertaSubasta
∆∆R _
.
∆∆_ `
CorreoSubastador
∆∆` p
)
∆∆p q
;
∆∆q r
Subasta
«« 
sub
«« 
=
«« 
db
«« 
.
«« 
Subastas
«« %
.
««% &
Find
««& *
(
««* +
ofertaSubasta
««+ 8
.
««8 9!
ProductoIDSubastado
««9 L
,
««L M
ofertaSubasta
««N [
.
««[ \
CorreoSubastador
««\ l
,
««l m
ofertaSubasta
««n {
.
««{ |
FechaPublicado««| ä
)««ä ã
;««ã å
ofertar
»» 
.
»» !
ProductoIDSubastado
»» '
=
»»( )
ofertaSubasta
»»* 7
.
»»7 8!
ProductoIDSubastado
»»8 K
;
»»K L
ofertar
…… 
.
…… 
CorreoOfertador
…… #
=
……$ %
correoActual
……& 2
;
……2 3
ofertar
   
.
   
CorreoSubastador
   $
=
  % &
ofertaSubasta
  ' 4
.
  4 5
CorreoSubastador
  5 E
;
  E F
ofertar
ÀÀ 
.
ÀÀ 
FechaPublicado
ÀÀ "
=
ÀÀ# $
FechaI
ÀÀ% +
;
ÀÀ+ ,
ofertar
ÃÃ 
.
ÃÃ 
PrecioOfrecido
ÃÃ "
=
ÃÃ# $
ofertaSubasta
ÃÃ% 2
.
ÃÃ2 3
PrecioOfrecido
ÃÃ3 A
;
ÃÃA B
var
◊◊ 
body1
◊◊ 
=
◊◊ 
$"
◊◊ 
$str
◊◊ >
{
◊◊> ?
ofertar
◊◊? F
.
◊◊F G
CorreoOfertador
◊◊G V
}
◊◊V W
$str
◊◊W e
{
◊◊e f
ofertar
◊◊f m
.
◊◊m n
PrecioOfrecido
◊◊n |
}
◊◊| }
$str◊◊} ù
{◊◊ù û
prod◊◊û ¢
.◊◊¢ £
Nombre◊◊£ ©
}◊◊© ™
"◊◊™ ´
;◊◊´ ¨
body1
ÿÿ 
.
ÿÿ 
Replace
ÿÿ 
(
ÿÿ 
$str
ÿÿ 
,
ÿÿ  
Environment
ÿÿ! ,
.
ÿÿ, -
NewLine
ÿÿ- 4
)
ÿÿ4 5
;
ÿÿ5 6
if
ËË 
(
ËË 
db
ËË 
.
ËË -
Relacion_ClienteOfertaEnSubasta
ËË 2
.
ËË2 3
Find
ËË3 7
(
ËË7 8
correoActual
ËË8 D
,
ËËD E
ofertaSubasta
ËËF S
.
ËËS T!
ProductoIDSubastado
ËËT g
,
ËËg h
ofertaSubasta
ËËi v
.
ËËv w
CorreoSubastadorËËw á
,ËËá à
FechaIËËâ è
)ËËè ê
!=ËËë ì
nullËËî ò
)ËËò ô
{
ÈÈ 
editarOferta
ÍÍ 
(
ÍÍ 
ofertar
ÍÍ $
)
ÍÍ$ %
;
ÍÍ% &
return
ÎÎ 
RedirectToAction
ÎÎ '
(
ÎÎ' (
$str
ÎÎ( /
)
ÎÎ/ 0
;
ÎÎ0 1
}
ÏÏ 
else
ÌÌ 
if
ÓÓ 
(
ÓÓ 

ModelState
ÓÓ 
.
ÓÓ 
IsValid
ÓÓ "
)
ÓÓ" #
{
ÔÔ 
db
ÒÒ 
.
ÒÒ -
Relacion_ClienteOfertaEnSubasta
ÒÒ 2
.
ÒÒ2 3
Add
ÒÒ3 6
(
ÒÒ6 7
ofertar
ÒÒ7 >
)
ÒÒ> ?
;
ÒÒ? @
db
ÚÚ 
.
ÚÚ 
SaveChanges
ÚÚ 
(
ÚÚ 
)
ÚÚ  
;
ÚÚ  !
EnviarCorreo
ÛÛ 
(
ÛÛ 
ofertaSubasta
ÛÛ *
.
ÛÛ* +
CorreoSubastador
ÛÛ+ ;
,
ÛÛ; <
body1
ÛÛ= B
)
ÛÛB C
;
ÛÛC D
return
ıı 
RedirectToAction
ıı '
(
ıı' (
$str
ıı( /
)
ıı/ 0
;
ıı0 1
}
ˆˆ 
else
˜˜ 
{
¯¯ 
return
˘˘ 
HttpNotFound
˘˘ #
(
˘˘# $
)
˘˘$ %
;
˘˘% &
}
˙˙ 
}
˛˛ 	
[
ÄÄ 	
HttpPost
ÄÄ	 
]
ÄÄ 
public
ÇÇ 
ActionResult
ÇÇ 
editarOferta
ÇÇ (
(
ÇÇ( )
[
ÇÇ) *
Bind
ÇÇ* .
(
ÇÇ. /
Include
ÇÇ/ 6
=
ÇÇ7 8
$strÇÇ9 ë
)ÇÇë í
]ÇÇí ì/
Relacion_ClienteOfertaEnSubastaÇÇî ≥
ofertaSubastaÇÇ¥ ¡
)ÇÇ¡ ¬
{
ÉÉ 	
Producto
ÑÑ 
prod
ÑÑ 
=
ÑÑ 
db
ÑÑ 
.
ÑÑ 

Productoes
ÑÑ )
.
ÑÑ) *
Find
ÑÑ* .
(
ÑÑ. /
ofertaSubasta
ÑÑ/ <
.
ÑÑ< =!
ProductoIDSubastado
ÑÑ= P
,
ÑÑP Q
ofertaSubasta
ÑÑR _
.
ÑÑ_ `
CorreoSubastador
ÑÑ` p
)
ÑÑp q
;
ÑÑq r
var
ÖÖ 
body1
ÖÖ 
=
ÖÖ 
$"
ÖÖ 
$str
ÖÖ =
{
ÖÖ= >
ofertaSubasta
ÖÖ> K
.
ÖÖK L
CorreoOfertador
ÖÖL [
}
ÖÖ[ \
$str
ÖÖ\ j
{
ÖÖj k
ofertaSubasta
ÖÖk x
.
ÖÖx y
PrecioOfrecidoÖÖy á
}ÖÖá à
$strÖÖà ®
{ÖÖ® ©
prodÖÖ© ≠
.ÖÖ≠ Æ
NombreÖÖÆ ¥
}ÖÖ¥ µ
"ÖÖµ ∂
;ÖÖ∂ ∑
body1
ÜÜ 
.
ÜÜ 
Replace
ÜÜ 
(
ÜÜ 
$str
ÜÜ 
,
ÜÜ 
Environment
ÜÜ  +
.
ÜÜ+ ,
NewLine
ÜÜ, 3
)
ÜÜ3 4
;
ÜÜ4 5
if
ââ 
(
ââ 

ModelState
ââ 
.
ââ 
IsValid
ââ "
)
ââ" #
{
ää 
db
åå 
.
åå 
Set
åå 
<
åå -
Relacion_ClienteOfertaEnSubasta
åå 6
>
åå6 7
(
åå7 8
)
åå8 9
.
åå9 :
AddOrUpdate
åå: E
(
ååE F
ofertaSubasta
ååF S
)
ååS T
;
ååT U
EnviarCorreo
çç 
(
çç 
ofertaSubasta
çç *
.
çç* +
CorreoSubastador
çç+ ;
,
çç; <
body1
çç= B
)
ççB C
;
ççC D
db
èè 
.
èè 
SaveChanges
èè 
(
èè 
)
èè  
;
èè  !
return
êê 
RedirectToAction
êê '
(
êê' (
$str
êê( /
)
êê/ 0
;
êê0 1
}
íí 
else
ìì 
{
îî 
return
ïï 
HttpNotFound
ïï #
(
ïï# $
)
ïï$ %
;
ïï% &
}
ññ 
}
óó 	
public
öö 
ActionResult
öö 
Edit
öö  
(
öö  !
int
öö! $
?
öö$ %

idProducto
öö& 0
,
öö0 1
string
öö2 8
correo
öö9 ?
,
öö? @
DateTime
ööA I
?
ööI J
fecha
ööK P
)
ööP Q
{
õõ 	
string
úú 
correoActual
úú 
=
úú  !
(
úú" #
string
úú# )
)
úú) *
HttpContext
úú* 5
.
úú5 6
Session
úú6 =
[
úú= >
$str
úú> H
]
úúH I
;
úúI J
if
ùù 
(
ùù 
correoActual
ùù 
==
ùù 
null
ùù  $
)
ùù$ %
{
ûû 
return
üü 
RedirectToAction
üü '
(
üü' (
$str
üü( 7
,
üü7 8
$str
üü9 E
)
üüE F
;
üüF G
}
†† 
Subasta
°° 
subasta
°° 
=
°° 
db
°°  
.
°°  !
Subastas
°°! )
.
°°) *
Find
°°* .
(
°°. /

idProducto
°°/ 9
,
°°9 :
correo
°°; A
,
°°A B
fecha
°°B G
)
°°G H
;
°°H I
Producto
¢¢ 
pro
¢¢ 
=
¢¢ 
db
¢¢ 
.
¢¢ 

Productoes
¢¢ (
.
¢¢( )
Find
¢¢) -
(
¢¢- .

idProducto
¢¢. 8
,
¢¢8 9
correo
¢¢: @
)
¢¢@ A
;
¢¢A B
if
££ 
(
££ 
pro
££ 
==
££ 
null
££ 
)
££ 
{
§§ 
return
•• 
RedirectToAction
•• '
(
••' (
$str
••( =
,
••= >
$str
••? I
)
••I J
;
••J K
}
¶¶ 
if
ßß 
(
ßß 
subasta
ßß 
==
ßß 
null
ßß 
)
ßß  
{
®® 
return
©© 
RedirectToAction
©© '
(
©©' (
$str
©©( =
,
©©= >
$str
©©? I
)
©©I J
;
©©J K
}
™™ 
SubastaViewModel
´´ 
tmodel
´´ #
=
´´$ %
new
´´& )
SubastaViewModel
´´* :
(
´´: ;
)
´´; <
;
´´< =
tmodel
¨¨ 
.
¨¨ 
	Productos
¨¨ 
=
¨¨ 
pro
¨¨ "
;
¨¨" #
tmodel
≠≠ 
.
≠≠ 
Subastas
≠≠ 
=
≠≠ 
subasta
≠≠ %
;
≠≠% &
return
ÆÆ 
View
ÆÆ 
(
ÆÆ 
tmodel
ÆÆ 
)
ÆÆ 
;
ÆÆ  
}
ØØ 	
[
¥¥ 	
HttpPost
¥¥	 
]
¥¥ 
public
∂∂ 
ActionResult
∂∂ 
Edit
∂∂  
(
∂∂  !
[
∂∂! "
Bind
∂∂" &
(
∂∂& '
Include
∂∂' .
=
∂∂/ 0
$str∂∂1 º
)∂∂º Ω
]∂∂Ω æ 
SubastaViewModel∂∂ø œ
subasta∂∂– ◊
)∂∂◊ ÿ
{
∑∑ 	
string
∏∏ 
correoActual
∏∏ 
=
∏∏  !
(
∏∏" #
string
∏∏# )
)
∏∏) *
HttpContext
∏∏* 5
.
∏∏5 6
Session
∏∏6 =
[
∏∏= >
$str
∏∏> H
]
∏∏H I
;
∏∏I J
CultureInfo
ππ 
provider
ππ  
=
ππ! "
CultureInfo
ππ# .
.
ππ. /
InvariantCulture
ππ/ ?
;
ππ? @
string
∫∫ 
format
∫∫ 
=
∫∫ 
$str
∫∫ 1
;
∫∫1 2
Subasta
ªª 
subast
ªª 
=
ªª 
new
ªª  
Subasta
ªª! (
(
ªª( )
)
ªª) *
;
ªª* +
TimeSpan
ΩΩ 
tiempo
ΩΩ 
=
ΩΩ 
TimeSpan
ΩΩ &
.
ΩΩ& '
Parse
ΩΩ' ,
(
ΩΩ, -
subasta
ΩΩ- 4
.
ΩΩ4 5

HoraInicio
ΩΩ5 ?
)
ΩΩ? @
;
ΩΩ@ A
string
ææ 
fecha
ææ 
=
ææ 
subasta
ææ "
.
ææ" #

FechInicio
ææ# -
+
ææ. /
$str
ææ0 3
+
ææ4 5
subasta
ææ6 =
.
ææ= >

HoraInicio
ææ> H
+
ææI J
$str
ææK P
;
ææP Q
DateTime
øø  
fechaInicioSubasta
øø '
=
øø( )
DateTime
øø* 2
.
øø2 3

ParseExact
øø3 =
(
øø= >
fecha
øø> C
,
øøC D
format
øøE K
,
øøK L
provider
øøM U
)
øøU V
;
øøV W
fecha
¬¬ 
=
¬¬ 
subasta
¬¬ 
.
¬¬ 
FechFin
¬¬ #
+
¬¬$ %
$str
¬¬& )
+
¬¬* +
subasta
¬¬, 3
.
¬¬3 4
HoraFin
¬¬4 ;
+
¬¬< =
$str
¬¬> C
;
¬¬C D
DateTime
√√ 
fechaFinSubasta
√√ $
=
√√% &
DateTime
√√' /
.
√√/ 0

ParseExact
√√0 :
(
√√: ;
fecha
√√; @
,
√√@ A
format
√√B H
,
√√H I
provider
√√J R
)
√√R S
;
√√S T
if
ƒƒ 
(
ƒƒ 

ModelState
ƒƒ 
.
ƒƒ 
IsValid
ƒƒ "
)
ƒƒ" #
{
≈≈ 
subast
∆∆ 
.
∆∆ !
ProductoIDSubastado
∆∆ *
=
∆∆+ ,
subasta
∆∆- 4
.
∆∆4 5!
ProductoIDSubastado
∆∆5 H
;
∆∆H I
subast
«« 
.
«« 
CorreoSubastador
«« '
=
««( )
correoActual
««* 6
;
««6 7
subast
»» 
.
»» 
PrecioMinimo
»» #
=
»»$ %
subasta
»»& -
.
»»- .
PrecioMinimo
»». :
;
»»: ;
subast
…… 
.
…… 
FechaPublicado
…… %
=
……& '
subasta
……( /
.
……/ 0
FechaPublicado
……0 >
;
……> ?
subast
   
.
   
FechaInicio
   "
=
  # $ 
fechaInicioSubasta
  % 7
;
  7 8
subast
ÀÀ 
.
ÀÀ 
FechaFin
ÀÀ 
=
ÀÀ  !
fechaFinSubasta
ÀÀ" 1
;
ÀÀ1 2
db
ÃÃ 
.
ÃÃ 
Entry
ÃÃ 
(
ÃÃ 
subast
ÃÃ 
)
ÃÃ  
.
ÃÃ  !
State
ÃÃ! &
=
ÃÃ' (
EntityState
ÃÃ) 4
.
ÃÃ4 5
Modified
ÃÃ5 =
;
ÃÃ= >
db
ÕÕ 
.
ÕÕ 
SaveChanges
ÕÕ 
(
ÕÕ 
)
ÕÕ  
;
ÕÕ  !
return
ŒŒ 
RedirectToAction
ŒŒ '
(
ŒŒ' (
$str
ŒŒ( /
)
ŒŒ/ 0
;
ŒŒ0 1
}
œœ 
return
—— 
View
—— 
(
—— 
subasta
—— 
)
——  
;
——  !
}
““ 	
public
’’ 
ActionResult
’’ 
Delete
’’ "
(
’’" #
int
’’# &
?
’’& '

idProducto
’’( 2
,
’’2 3
string
’’4 :
correo
’’; A
,
’’A B
DateTime
’’C K
?
’’K L
fecha
’’M R
)
’’R S
{
÷÷ 	
string
◊◊ 
correoActual
◊◊ 
=
◊◊  !
(
◊◊" #
string
◊◊# )
)
◊◊) *
HttpContext
◊◊* 5
.
◊◊5 6
Session
◊◊6 =
[
◊◊= >
$str
◊◊> H
]
◊◊H I
;
◊◊I J
if
ÿÿ 
(
ÿÿ 
correoActual
ÿÿ 
==
ÿÿ 
null
ÿÿ  $
)
ÿÿ$ %
{
ŸŸ 
return
⁄⁄ 
RedirectToAction
⁄⁄ '
(
⁄⁄' (
$str
⁄⁄( 7
,
⁄⁄7 8
$str
⁄⁄9 E
)
⁄⁄E F
;
⁄⁄F G
}
€€ 
if
‹‹ 
(
‹‹ 

idProducto
‹‹ 
==
‹‹ 
null
‹‹ "
)
‹‹" #
{
›› 
return
ﬁﬁ 
new
ﬁﬁ "
HttpStatusCodeResult
ﬁﬁ /
(
ﬁﬁ/ 0
HttpStatusCode
ﬁﬁ0 >
.
ﬁﬁ> ?

BadRequest
ﬁﬁ? I
)
ﬁﬁI J
;
ﬁﬁJ K
}
ﬂﬂ 
Subasta
‡‡ 
subasta
‡‡ 
=
‡‡ 
db
‡‡  
.
‡‡  !
Subastas
‡‡! )
.
‡‡) *
Find
‡‡* .
(
‡‡. /

idProducto
‡‡/ 9
,
‡‡9 :
correo
‡‡; A
,
‡‡A B
fecha
‡‡C H
)
‡‡H I
;
‡‡I J
if
·· 
(
·· 
subasta
·· 
==
·· 
null
·· 
)
··  
{
‚‚ 
return
„„ 
RedirectToAction
„„ '
(
„„' (
$str
„„( =
,
„„= >
$str
„„? I
)
„„I J
;
„„J K
}
‰‰ 
return
ÂÂ 
View
ÂÂ 
(
ÂÂ 
subasta
ÂÂ 
)
ÂÂ  
;
ÂÂ  !
}
ÊÊ 	
[
ÈÈ 	
HttpPost
ÈÈ	 
,
ÈÈ 

ActionName
ÈÈ 
(
ÈÈ 
$str
ÈÈ &
)
ÈÈ& '
]
ÈÈ' (
public
ÎÎ 
ActionResult
ÎÎ 
DeleteConfirmed
ÎÎ +
(
ÎÎ+ ,
int
ÎÎ, /
?
ÎÎ/ 0

idProducto
ÎÎ1 ;
,
ÎÎ; <
string
ÎÎ= C
correo
ÎÎD J
,
ÎÎJ K
DateTime
ÎÎL T
fecha
ÎÎU Z
)
ÎÎZ [
{
ÏÏ 	
var
ÌÌ 
cookiecorreo
ÌÌ 
=
ÌÌ 
ControllerContext
ÌÌ 0
.
ÌÌ0 1
HttpContext
ÌÌ1 <
.
ÌÌ< =
Request
ÌÌ= D
.
ÌÌD E
Cookies
ÌÌE L
[
ÌÌL M
$str
ÌÌM S
]
ÌÌS T
;
ÌÌT U
Subasta
ÓÓ 
subasta
ÓÓ 
=
ÓÓ 
db
ÓÓ  
.
ÓÓ  !
Subastas
ÓÓ! )
.
ÓÓ) *
Find
ÓÓ* .
(
ÓÓ. /

idProducto
ÓÓ/ 9
,
ÓÓ9 :
correo
ÓÓ; A
,
ÓÓA B
fecha
ÓÓC H
)
ÓÓH I
;
ÓÓI J
subasta
ÔÔ 
.
ÔÔ 
Estado
ÔÔ 
=
ÔÔ 
false
ÔÔ "
;
ÔÔ" #
db
 
.
 
SaveChanges
 
(
 
)
 
;
 
return
ÒÒ 
RedirectToAction
ÒÒ #
(
ÒÒ# $
$str
ÒÒ$ +
)
ÒÒ+ ,
;
ÒÒ, -
}
ÛÛ 	
	protected
ıı 
override
ıı 
void
ıı 
Dispose
ıı  '
(
ıı' (
bool
ıı( ,
	disposing
ıı- 6
)
ıı6 7
{
ˆˆ 	
if
˜˜ 
(
˜˜ 
	disposing
˜˜ 
)
˜˜ 
{
¯¯ 
db
˘˘ 
.
˘˘ 
Dispose
˘˘ 
(
˘˘ 
)
˘˘ 
;
˘˘ 
}
˙˙ 
base
˚˚ 
.
˚˚ 
Dispose
˚˚ 
(
˚˚ 
	disposing
˚˚ "
)
˚˚" #
;
˚˚# $
}
¸¸ 	
public
˛˛ 
ActionResult
˛˛ 
ListaProductos
˛˛ *
(
˛˛* +
string
˛˛+ 1
searchBy
˛˛2 :
,
˛˛: ;
string
˛˛< B
currentFilter
˛˛C P
,
˛˛P Q
string
˛˛R X
searchString
˛˛Y e
,
˛˛e f
int
˛˛g j
?
˛˛j k
page
˛˛l p
)
˛˛p q
{
ˇˇ 	
string
ÅÅ 
correoActual
ÅÅ 
=
ÅÅ  !
(
ÅÅ" #
string
ÅÅ# )
)
ÅÅ) *
HttpContext
ÅÅ* 5
.
ÅÅ5 6
Session
ÅÅ6 =
[
ÅÅ= >
$str
ÅÅ> H
]
ÅÅH I
;
ÅÅI J
if
ÇÇ 
(
ÇÇ 
correoActual
ÇÇ 
==
ÇÇ 
null
ÇÇ  $
)
ÇÇ$ %
{
ÉÉ 
return
ÑÑ 
RedirectToAction
ÑÑ '
(
ÑÑ' (
$str
ÑÑ( 7
,
ÑÑ7 8
$str
ÑÑ9 E
)
ÑÑE F
;
ÑÑF G
}
ÖÖ 
ViewBag
ÜÜ 
.
ÜÜ 
CurrentSort
ÜÜ 
=
ÜÜ  !
searchBy
ÜÜ" *
;
ÜÜ* +
ViewBag
áá 
.
áá 
NameSortParm
áá  
=
áá! "
String
áá# )
.
áá) *
IsNullOrEmpty
áá* 7
(
áá7 8
searchBy
áá8 @
)
áá@ A
?
ááB C
$str
ááD O
:
ááP Q
$str
ááR T
;
ááT U
ViewBag
àà 
.
àà 
SortPriceParm
àà !
=
àà" #
searchBy
àà$ ,
==
àà- /
$str
àà0 7
?
àà8 9
$str
àà: F
:
ààG H
$str
ààI P
;
ààP Q
if
ää 
(
ää 
searchString
ää 
!=
ää 
null
ää  $
)
ää$ %
{
ãã 
page
åå 
=
åå 
$num
åå 
;
åå 
}
çç 
else
éé 
{
èè 
searchString
êê 
=
êê 
currentFilter
êê ,
;
êê, -
}
ëë 
var
ïï 
	productos
ïï 
=
ïï 
from
ïï  
pr
ïï! #
in
ïï$ &
db
ïï' )
.
ïï) *

Productoes
ïï* 4
select
ññ "
pr
ññ# %
;
ññ% &
	productos
óó 
=
óó 
	productos
óó !
.
óó! "
Where
óó" '
(
óó' (
pr
óó( *
=>
óó+ -
pr
óó. 0
.
óó0 1
CorreoCliente
óó1 >
==
óó? A
correoActual
óóB N
)
óóN O
;
óóO P
	productos
òò 
=
òò 
from
òò 
l
òò 
in
òò !
	productos
òò" +
where
ôô 
(
ôô 
db
ôô !
.
ôô! "
Subastas
ôô" *
.
ôô* +
Any
ôô+ .
(
ôô. /
item
ôô/ 3
=>
ôô4 6
item
ôô7 ;
.
ôô; <!
ProductoIDSubastado
ôô< O
==
ôôP R
l
ôôS T
.
ôôT U

ProductoID
ôôU _
&&
ôô` b
DateTime
ôôc k
.
ôôk l
Compare
ôôl s
(
ôôs t
item
ôôt x
.
ôôx y
FechaFinôôy Å
,ôôÅ Ç
DateTimeôôÉ ã
.ôôã å
Nowôôå è
)ôôè ê
<ôôë í
$numôôì î
)ôôî ï
||
öö  "
!
öö# $
(
öö$ %
db
öö% '
.
öö' (
Subastas
öö( 0
.
öö0 1
Any
öö1 4
(
öö4 5
item
öö5 9
=>
öö: <
item
öö= A
.
ööA B!
ProductoIDSubastado
ööB U
==
ööV X
l
ööY Z
.
ööZ [

ProductoID
öö[ e
)
ööe f
)
ööf g
)
öög h
select
õõ 
l
õõ  
;
õõ  !
var
ùù 
subastas
ùù 
=
ùù 
from
ùù 
s
ùù  !
in
ùù" $
db
ùù% '
.
ùù' (
Subastas
ùù( 0
select
ûû !
s
ûû" #
;
ûû# $
if
¢¢ 
(
¢¢ 
!
¢¢ 
String
¢¢ 
.
¢¢ 
IsNullOrEmpty
¢¢ %
(
¢¢% &
searchString
¢¢& 2
)
¢¢2 3
)
¢¢3 4
{
££ 
	productos
§§ 
=
§§ 
	productos
§§ %
.
§§% &
Where
§§& +
(
§§+ ,
p
§§, -
=>
§§. 0
p
§§1 2
.
§§2 3
Nombre
§§3 9
.
§§9 :
Contains
§§: B
(
§§B C
searchString
§§C O
)
§§O P
)
§§P Q
;
§§Q R
}
•• 
switch
®® 
(
®® 
searchBy
®® 
)
®® 
{
©© 
case
™™ 
$str
™™ 
:
™™  
	productos
´´ 
=
´´ 
	productos
´´  )
.
´´) *
OrderBy
´´* 1
(
´´1 2
p
´´2 3
=>
´´4 6
p
´´7 8
.
´´8 9
Nombre
´´9 ?
)
´´? @
;
´´@ A
break
¨¨ 
;
¨¨ 
case
≠≠ 
$str
≠≠  
:
≠≠  !
	productos
ÆÆ 
=
ÆÆ 
	productos
ÆÆ  )
.
ÆÆ) *
OrderByDescending
ÆÆ* ;
(
ÆÆ; <
p
ÆÆ< =
=>
ÆÆ> @
p
ÆÆA B
.
ÆÆB C
Nombre
ÆÆC I
)
ÆÆI J
;
ÆÆJ K
break
ØØ 
;
ØØ 
case
±± 
$str
±± !
:
±±! "
	productos
≤≤ 
=
≤≤ 
	productos
≤≤  )
.
≤≤) *
OrderByDescending
≤≤* ;
(
≤≤; <
p
≤≤< =
=>
≤≤> @
p
≤≤A B
.
≤≤B C
PrecioEstimado
≤≤C Q
)
≤≤Q R
;
≤≤R S
break
≥≥ 
;
≥≥ 
case
¥¥ 
$str
¥¥ 
:
¥¥ 
	productos
µµ 
=
µµ 
	productos
µµ  )
.
µµ) *
OrderBy
µµ* 1
(
µµ1 2
p
µµ2 3
=>
µµ4 6
p
µµ7 8
.
µµ8 9
PrecioEstimado
µµ9 G
)
µµG H
;
µµH I
break
∂∂ 
;
∂∂ 
default
∑∑ 
:
∑∑ 
	productos
∏∏ 
=
∏∏ 
	productos
∏∏  )
.
∏∏) *
OrderBy
∏∏* 1
(
∏∏1 2
p
∏∏2 3
=>
∏∏4 6
p
∏∏7 8
.
∏∏8 9
Nombre
∏∏9 ?
)
∏∏? @
;
∏∏@ A
break
ππ 
;
ππ 
}
∫∫ 
int
ºº 
pageSize
ºº 
=
ºº 
$num
ºº 
;
ºº 
int
ΩΩ 

pageNumber
ΩΩ 
=
ΩΩ 
(
ΩΩ 
page
ΩΩ "
??
ΩΩ# %
$num
ΩΩ& '
)
ΩΩ' (
;
ΩΩ( )
return
ææ 
View
ææ 
(
ææ 
	productos
ææ !
.
ææ! "
ToPagedList
ææ" -
(
ææ- .

pageNumber
ææ. 8
,
ææ8 9
pageSize
ææ: B
)
ææB C
)
ææC D
;
ææD E
}
øø 	
[
¡¡ 	
HttpPost
¡¡	 
]
¡¡ 
public
¬¬ 
ActionResult
¬¬ 
EnviarCorreo
¬¬ (
(
¬¬( )
string
¬¬) /
correo
¬¬0 6
,
¬¬6 7
string
¬¬8 >
bodyMessage
¬¬? J
)
¬¬J K
{
√√ 	
var
ƒƒ 
fromAddress
ƒƒ 
=
ƒƒ 
new
ƒƒ !
MailAddress
ƒƒ" -
(
ƒƒ- .
$str
ƒƒ. J
,
ƒƒJ K
$str
ƒƒL Z
)
ƒƒZ [
;
ƒƒ[ \
var
≈≈ 
	toAddress
≈≈ 
=
≈≈ 
new
≈≈ 
MailAddress
≈≈  +
(
≈≈+ ,
correo
≈≈, 2
,
≈≈2 3
$str
≈≈4 F
)
≈≈F G
;
≈≈G H
const
∆∆ 
string
∆∆ 
fromPassword
∆∆ %
=
∆∆& '
$str
∆∆( 3
;
∆∆3 4
const
«« 
string
«« 
subject
««  
=
««! "
$str
««# P
;
««P Q
string
»» 
body
»» 
=
»» 
bodyMessage
»» %
;
»»% &
var
   
smtp
   
=
   
new
   

SmtpClient
   %
{
ÀÀ 
Host
ÃÃ 
=
ÃÃ 
$str
ÃÃ '
,
ÃÃ' (
Port
ÕÕ 
=
ÕÕ 
$num
ÕÕ 
,
ÕÕ 
	EnableSsl
ŒŒ 
=
ŒŒ 
true
ŒŒ  
,
ŒŒ  !
DeliveryMethod
œœ 
=
œœ   
SmtpDeliveryMethod
œœ! 3
.
œœ3 4
Network
œœ4 ;
,
œœ; <
Credentials
–– 
=
–– 
new
–– !
NetworkCredential
––" 3
(
––3 4
fromAddress
––4 ?
.
––? @
Address
––@ G
,
––G H
fromPassword
––I U
)
––U V
,
––V W
Timeout
““ 
=
““ 
$num
““ 
}
”” 
;
”” 
using
‘‘ 
(
‘‘ 
var
‘‘ 
message
‘‘ 
=
‘‘  
new
‘‘! $
MailMessage
‘‘% 0
(
‘‘0 1
fromAddress
‘‘1 <
,
‘‘< =
	toAddress
‘‘> G
)
‘‘G H
{
’’ 
Subject
÷÷ 
=
÷÷ 
subject
÷÷ !
,
÷÷! "
Body
◊◊ 
=
◊◊ 
body
◊◊ 
}
ÿÿ 
)
ÿÿ 
{
ŸŸ 
smtp
⁄⁄ 
.
⁄⁄ 
Send
⁄⁄ 
(
⁄⁄ 
message
⁄⁄ !
)
⁄⁄! "
;
⁄⁄" #
}
€€ 
return
‹‹ 
View
‹‹ 
(
‹‹ 
)
‹‹ 
;
‹‹ 
}
›› 	
public
ﬂﬂ 
ActionResult
ﬂﬂ !
RecursoNoEncontrado
ﬂﬂ /
(
ﬂﬂ/ 0
)
ﬂﬂ0 1
{
‡‡ 	
return
·· 
View
·· 
(
·· 
)
·· 
;
·· 
}
‚‚ 	
}
„„ 
}‰‰ ‹
|C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Controllers\TruequesController.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Controllers" -
{ 
public 

class 
TruequesController #
:$ %

Controller& 0
{ 
private 
TempPIEntities 
db !
=" #
new$ '
TempPIEntities( 6
(6 7
)7 8
;8 9
public 
ActionResult 
Index !
(! "
)" #
{ 	
var 
trueques 
= 
db 
. 
Trueques &
.& '
Include' .
(. /
t/ 0
=>1 3
t4 5
.5 6
Producto6 >
)> ?
.? @
Include@ G
(G H
tH I
=>J L
tM N
.N O
	Producto1O X
)X Y
;Y Z
return 
View 
( 
trueques  
.  !
ToList! '
(' (
)( )
)) *
;* +
} 	
public 
ActionResult 
Details #
(# $
int$ '
?' (
p1) +
,+ ,
string- 3
c14 6
,6 7
int8 ;
p2< >
,> ?
string@ F
c2G I
)I J
{ 	
if 
( 
p1 
== 
null 
) 
{ 
return 
new  
HttpStatusCodeResult /
(/ 0
HttpStatusCode0 >
.> ?

BadRequest? I
)I J
;J K
} 
Trueque 
trueque 
= 
db  
.  !
Trueques! )
.) *
Find* .
(. /
p1/ 1
,1 2
c13 5
,5 6
p27 9
,9 :
c2; =
)= >
;> ?
if   
(   
trueque   
==   
null   
)    
{!! 
return"" 
HttpNotFound"" #
(""# $
)""$ %
;""% &
}## 
return$$ 
View$$ 
($$ 
trueque$$ 
)$$  
;$$  !
}%% 	
	protected&& 
override&& 
void&& 
Dispose&&  '
(&&' (
bool&&( ,
	disposing&&- 6
)&&6 7
{'' 	
if(( 
((( 
	disposing(( 
)(( 
{)) 
db** 
.** 
Dispose** 
(** 
)** 
;** 
}++ 
base,, 
.,, 
Dispose,, 
(,, 
	disposing,, "
),," #
;,,# $
}-- 	
}.. 
}// ü	
iC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Global.asax.cs
	namespace		 	#
Proyecto_Inge_Bases_Web		
 !
{

 
public 

class 
MvcApplication 
:  !
System" (
.( )
Web) ,
., -
HttpApplication- <
{ 
	protected 
void 
Application_Start (
(( )
)) *
{ 	
AreaRegistration 
. 
RegisterAllAreas -
(- .
). /
;/ 0
FilterConfig 
. !
RegisterGlobalFilters .
(. /
GlobalFilters/ <
.< =
Filters= D
)D E
;E F
RouteConfig 
. 
RegisterRoutes &
(& '

RouteTable' 1
.1 2
Routes2 8
)8 9
;9 :
BundleConfig 
. 
RegisterBundles (
(( )
BundleTable) 4
.4 5
Bundles5 <
)< =
;= >
} 	
} 
} €
{C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\CambiarContrasenaModel.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{ 
public		 

class		 "
CambiarContrasenaModel		 '
{

 
[ 	
Required	 
( 
ErrorMessage 
=  
$str! =
,= >
AllowEmptyStrings? P
=Q R
falseS X
)X Y
]Y Z
[ 	
RegularExpression	 
( 
$str E
,E F
ErrorMessageG S
=T U
$str	V  
)
  À
]
À Ã
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
public 
string 
NuevaContrasena %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
[ 	
Compare	 
( 
$str "
," #
ErrorMessage$ 0
=1 2
$str3 Y
)Y Z
]Z [
public 
string 
ConfirmarContrasena )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
[ 	
Required	 
] 
public 
string 
CodigoCambio "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} ◊
nC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\FisicoOOP.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{ 
[		 
Table		 

(		
 
$str		 
)		 
]		 
public

 

class

 
	FisicoOOP

 
:

 
ProductoOOP

 (
{ 
public 
override 
string 
FullIdentificacion 1
{ 	
get 
{ 
return 
Identificacion %
+& '
$str( >
;> ?
} 
}!! 	
}## 
}$$ “
rC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\ListaNoAmigos.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{		 
public 

partial 
class 
ListaNoAmigos &
{ 
public 
string 
Correo 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
	Apellido1 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
	Apellido2 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	

DbFunction	 
( 
$str 
, 
$str +
)+ ,
], -
public 
virtual 

IQueryable !
<! ""
funcionNoAmigos_Result" 8
>8 9
FuncionNoAmigos: I
(I J
stringJ P
correoQ W
)W X
{ 	
var 
correoParameter 
=  !
correo" (
!=) +
null, 0
?1 2
new 
ObjectParameter #
(# $
$str$ ,
,, -
correo. 4
)4 5
:6 7
new 
ObjectParameter #
(# $
$str$ ,
,, -
typeof. 4
(4 5
string5 ;
); <
)< =
;= >
return 
( 
( 
System 
. 
Data  
.  !
Entity! '
.' (
Infrastructure( 6
.6 7!
IObjectContextAdapter7 L
)L M
thisM Q
)Q R
.R S
ObjectContextS `
.` a
CreateQuerya l
<l m#
funcionNoAmigos_Result	m É
>
É Ñ
(
Ñ Ö
$str
Ö ¶
,
¶ ß
correoParameter
® ∑
)
∑ ∏
;
∏ π
} 	
} 
}!! Ñ
}C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\Metadata\ClienteMetadata.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{ 
public 

partial 
class 
ClienteMetadata (
{ 
[ 	
DataType	 
( 
DataType 
. 
EmailAddress '
)' (
]( )
[ 	
Required	 
] 
public 
string 
Correo 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
DataType	 
( 
DataType 
. 
DateTime #
)# $
]$ %
public 
Nullable 
< 
System 
. 
DateTime '
>' (
FechaNacimiento) 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 
Nullable 
< 
int 
> 
Canton #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
DireccionExacta %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
byte 
[ 
] 

FotoPerfil  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	
DataType	 
( 
DataType 
. 
DateTime #
)# $
]$ %
public 
Nullable 
< 
System 
. 
DateTime '
>' (
FechaCierre) 4
{5 6
get7 :
;: ;
set< ?
;? @
}A B
public   
Nullable   
<   
byte   
>    
CalificacionPromedio   2
{  3 4
get  5 8
;  8 9
set  : =
;  = >
}  ? @
public"" 
bool"" "
BloquearNotificaciones"" *
{""+ ,
get""- 0
;""0 1
set""2 5
;""5 6
}""7 8
}## 
}$$ ˇ
~C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\Metadata\ProductoMetadata.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{ 
public 

partial 
class 
ProductoMetadata )
{ 
[ 	
Display	 
( 
Name 
= 
$str /
)/ 0
]0 1
[ 	
Required	 
( 
ErrorMessage 
=  
$str! A
)A B
]B C
public 
string 
Nombre 
; 
[ 	
RegularExpression	 
( 
$str 2
,2 3
ErrorMessage4 @
=A B
$strC q
)q r
]r s
[ 	
Range	 
( 
$num 
, 
$num 
, 
ErrorMessage +
=, -
$str. \
)\ ]
]] ^
[ 	
Required	 
( 
ErrorMessage 
=  
$str! A
)A B
]B C
[ 	
Display	 
( 
Name 
= 
$str +
)+ ,
], -
public 
double 
PrecioEstimado $
;$ %
[ 	
Required	 
( 
ErrorMessage 
=  
$str! A
)A B
]B C
[ 	
Display	 
( 
Name 
= 
$str %
)% &
]& '
public 
string 
	Condicion 
;  
[   	
DataType  	 
(   
DataType   
.   
MultilineText   (
)  ( )
]  ) *
[!! 	
Display!!	 
(!! 
Name!! 
=!! 
$str!! %
)!!% &
]!!& '
public"" 
string"" 
Descripcion"" !
;""! "
[$$ 	
Display$$	 
($$ 
Name$$ 
=$$ 
$str$$ "
)$$" #
]$$# $
public%% 
string%% 
ProductoImagen1%% %
;%%% &
['' 	
Display''	 
('' 
Name'' 
='' 
$str'' "
)''" #
]''# $
public(( 
string(( 
ProductoImagen2(( %
;((% &
[** 	
Display**	 
(** 
Name** 
=** 
$str** "
)**" #
]**# $
public++ 
string++ 
ProductoImagen3++ %
;++% &
},, 
}-- ˘

ÄC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\Metadata\RegistradoMetadata.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{ 
public 

partial 
class 
RegistradoMetadata +
{ 
[ 	
DataType	 
( 
DataType 
. 
EmailAddress '
)' (
]( )
[ 	
Required	 
] 
public 
string 
Correo 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
] 
public 
string 

Contrasena  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
	Apellido1 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
	Apellido2 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} Œ
}C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\Metadata\SubastaMetadata.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{ 
public 

partial 
class 
SubastaMetadata (
{ 
public 
int 
ProductoIDSubastado &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
CorreoSubastador &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
System 
. 
DateTime 
FechaPublicado -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
[ 	
Required	 
( 
ErrorMessage 
=  
$str! A
)A B
]B C
public 
double 
PrecioMinimo "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
Required	 
( 
ErrorMessage 
=  
$str! A
)A B
]B C
public 
System 
. 
DateTime 
FechaInicio *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
[ 	
Required	 
( 
ErrorMessage 
=  
$str! A
)A B
]B C
public 
System 
. 
DateTime 
FechaFin '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
Nullable 
< 
short 
> 
Calificacion +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
virtual 
Producto 
Producto  (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
} 
}   à
}C:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\Metadata\VirtualMetadata.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{ 
public 

partial 
class 
VirtualMetadata (
{ 
[ 	
Required	 
( 
ErrorMessage 
=  
$str! V
)V W
]W X
public 
int 

ProductoID 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Required	 
( 
ErrorMessage 
=  
$str! a
)a b
]b c
public 
string 
CorreoCliente #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 	
Required	 
( 
ErrorMessage 
=  
$str! O
)O P
]P Q
public 
string 
TipoDeArchivo #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 	
Required	 
( 
ErrorMessage 
=  
$str! Q
)Q R
]R S
public 
string 
DerechosDeProducto (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
[ 	
Required	 
( 
ErrorMessage 
=  
$str! D
)D E
]E F
public 
string 
Fuentes 
{ 
get  #
;# $
set% (
;( )
}* +
public   
Nullable   
<   
System   
.   
DateTime   '
>  ' (
FechaExpiracion  ) 8
{  9 :
get  ; >
;  > ?
set  @ C
;  C D
}  E F
[## 	
Required##	 
(## 
ErrorMessage## 
=##  
$str##! V
)##V W
]##W X
public$$ 
virtual$$ 
Producto$$ 
Producto$$  (
{$$) *
get$$+ .
;$$. /
set$$0 3
;$$3 4
}$$5 6
}%% 
}&& ◊
rC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\Model1Context.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{		 
public 

class 
Model1Context 
:  
	DbContext! *
{ 
public 
Model1Context 
( 
) 
: 	
base
 
( 
$str %
)% &
{ 	
} 	
	protected&& 
override&& 
void&& 
OnModelCreating&&  /
(&&/ 0
DbModelBuilder&&0 >
modelBuilder&&? K
)&&K L
{'' 	
modelBuilder(( 
.(( 
Entity(( 
<((  
ProductoOOP((  +
>((+ ,
(((, -
)((- .
.((. /
ToTable((/ 6
(((6 7
$str((7 D
)((D E
;((E F
modelBuilder)) 
.)) 
Entity)) 
<))  
	FisicoOOP))  )
>))) *
())* +
)))+ ,
.)), -
ToTable))- 4
())4 5
$str))5 @
)))@ A
;))A B
modelBuilder** 
.** 
Entity** 
<**  

VirtualOOP**  *
>*** +
(**+ ,
)**, -
.**- .
ToTable**. 5
(**5 6
$str**6 B
)**B C
;**C D
}++ 	
}// 
}00 ˆ

rC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\MostrarListas.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{ 
public 

class 
MostrarListas 
{		 
public

 
List

 
<

 

VistaAmigo

 
>

 
Amigos

 %
{

& '
get

( +
;

+ ,
set

- 0
;

0 1
}

2 3
public 
List 
< 
VistaNoAmigo  
>  !
NoAmigos" *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
List 
< 
PanelSublista !
>! "
	Sublistas# ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
List 
< 
VistaEstaEnSublista '
>' (
EstaEnSublistas) 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 
List 
< 
VistaEstaEnSublista '
>' (
NoEsta) /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
} 
} ÿ
sC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\PartialClasses.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{ 
[ 
MetadataType 
( 
typeof 
( 
ProductoMetadata )
)) *
)* +
]+ ,
public 

partial 
class 
Producto !
{" #
}$ %
[		 
MetadataType		 
(		 
typeof		 
(		 
VirtualMetadata		 (
)		( )
)		) *
]		* +
public

 

partial

 
class

 
Virtual

  
{

! "
}

# $
[ 
MetadataType 
( 
typeof 
( 
SubastaMetadata (
)( )
)) *
]* +
public 

partial 
class 
Subasta  
{! "
}# $
[ 
MetadataType 
( 
typeof 
( 
RegistradoMetadata +
)+ ,
), -
]- .
public 

partial 
class 

Registrado #
{$ %
}& '
[ 
MetadataType 
( 
typeof 
( 
ClienteMetadata (
)( )
)) *
]* +
public 

partial 
class 
Cliente  
{! "
}# $
} Ô!
pC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\ProductoOOP.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{ 
[ 
Table 
( 
$str 
) 
] 
public 

abstract 
class 
ProductoOOP %
{ 
[ 
System 
. 
Diagnostics 
.  
CodeAnalysis  ,
., -
SuppressMessage- <
(< =
$str= N
,N O
$str	P Ç
)
Ç É
]
É Ñ
public 
ProductoOOP 
( 
)  
{ 
} 
public 
int 

ProductoID !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CorreoCliente '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
Nombre  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
double 
PrecioEstimado (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
string 
	Condicion #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
Descripcion %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
bool 
	Publicado !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
System 
. 
DateTime "
FechaRegistrado# 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
public 
Nullable 
< 
System "
." #
DateTime# +
>+ ,
FechaPublicado- ;
{< =
get> A
;A B
setC F
;F G
}H I
public   
Nullable   
<   
short   !
>  ! "
Calificacion  # /
{  0 1
get  2 5
;  5 6
set  7 :
;  : ;
}  < =
public!! 
Nullable!! 
<!! 
bool!!  
>!!  !
Estado!!" (
{!!) *
get!!+ .
;!!. /
set!!0 3
;!!3 4
}!!5 6
public"" 
bool"" 
Seleccionado"" $
{""% &
get""' *
;""* +
set"", /
;""/ 0
}""1 2
public## 
byte## 
[## 
]## 
ProductoImagen1## )
{##* +
get##, /
;##/ 0
set##1 4
;##4 5
}##6 7
public$$ 
byte$$ 
[$$ 
]$$ 
ProductoImagen2$$ )
{$$* +
get$$, /
;$$/ 0
set$$1 4
;$$4 5
}$$6 7
public%% 
byte%% 
[%% 
]%% 
ProductoImagen3%% )
{%%* +
get%%, /
;%%/ 0
set%%1 4
;%%4 5
}%%6 7
public&& 
virtual&& 
Cliente&& "
Cliente&&# *
{&&+ ,
get&&- 0
;&&0 1
set&&2 5
;&&5 6
}&&7 8
public00 
string00 
Identificacion00 $
{00% &
get33 
{44 
return66 
$str66 !
+66" #

ProductoID66$ .
+66/ 0
$str661 @
+66A B
Nombre66C I
+66J K
$str66L Z
+66[ \
CorreoCliente66] j
;66j k
}:: 
}== 	
public?? 
virtual?? 
string?? 
FullIdentificacion?? 0
{@@ 	
getCC 
{DD 
returnFF 
$strFF 0
+FF1 2
IdentificacionFF3 A
;FFA B
}HH 
}KK 	
}MM 
}NN ∑
oC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Models\VirtualOOP.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Models" (
{ 
[		 
Table		 

(		
 
$str		 
)		 
]		 
public

 

class

 

VirtualOOP

 
:

 
ProductoOOP

 )
{ 
public 
string 
TipoDeArchivo #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
DerechosDeProducto (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
string 
Fuentes 
{ 
get  #
;# $
set% (
;( )
}* +
public 
Nullable 
< 
System 
. 
DateTime '
>' (
FechaExpiracion) 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 
override 
string 
FullIdentificacion 1
{ 	
get 
{ 
return 
Identificacion %
+& '
$str( ?
;? @
}   
}## 	
}%% 
}&& †
uC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 2
)2 3
]3 4
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 4
)4 5
]5 6
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
["" 
assembly"" 	
:""	 

AssemblyVersion"" 
("" 
$str"" $
)""$ %
]""% &
[## 
assembly## 	
:##	 

AssemblyFileVersion## 
(## 
$str## (
)##( )
]##) *ı
ÄC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\ViewModels\ProductoCreateViewModel.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "

ViewModels" ,
{		 
public

 

class

 #
ProductoCreateViewModel

 (
{ 
public 
Producto 
Producto  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
List 
< 
	Categoria 
> 
	Categoria (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
List 
< 
bool 
> 
selected "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
List 
< 
SelectListItem "
>" #
	sublistas$ -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
} 
} €
zC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\ViewModels\PublicarViewModel.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "

ViewModels" ,
{		 
public

 

class

 
PublicarViewModel

 "
{ 
} 
} ¡
yC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\ViewModels\SubastaViewModel.cs
	namespace		 	#
Proyecto_Inge_Bases_Web		
 !
.		! "

ViewModels		" ,
{

 
public 

class 
SubastaViewModel !
{ 
public 
Producto 
	Productos !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
Subasta 
Subastas 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
ProductoIDSubastado &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
CorreoSubastador &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
System 
. 
DateTime 
FechaPublicado -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
[ 	
Required	 
( 
ErrorMessage 
=  
$str! A
)A B
]B C
public 
double 
PrecioMinimo "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
Required	 
( 
ErrorMessage 
=  
$str! A
)A B
]B C
public 
System 
. 
DateTime 
FechaInicio *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
[ 	
Required	 
( 
ErrorMessage 
=  
$str! A
)A B
]B C
public 
System 
. 
DateTime 
FechaFin '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
FechFin 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 

FechInicio  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 

HoraInicio  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
HoraFin 
{ 
get  #
;# $
set% (
;( )
}* +
public   
string   
Mensaje   
{   
get    #
;  # $
set  % (
;  ( )
}  * +
public!! 
double!! 
PrecioOfrecido!! $
{!!% &
get!!' *
;!!* +
set!!, /
;!!/ 0
}!!1 2
public"" +
Relacion_ClienteOfertaEnSubasta"" .,
 relacion_ClienteOfertaEnSubastas""/ O
{""P Q
get""R U
;""U V
set""W Z
;""Z [
}""\ ]
public## 
List## 
<## 
SelectListItem## "
>##" #
	sublistas##$ -
{##. /
get##0 3
;##3 4
set##5 8
;##8 9
}##: ;
}$$ 
}%% ç
àC:\Users\royam\source\repos\roymm\Subastas\Proyecto_Inge_Bases_Web\Proyecto_Inge_Bases_Web\ViewModels\TruequeViewModels\TruequeModels.cs
	namespace 	#
Proyecto_Inge_Bases_Web
 !
.! "
Views" '
.' (
TruequeViewModels( 9
{ 
public

 

class

 
TruequeModels

 
{ 
public 
IEnumerable 
< 
Trueque "
>" #
Trueques$ ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
IEnumerable 
< 
Producto #
># $
	Productos% .
{/ 0
get1 4
;4 5
set5 8
;8 9
}: ;
public 
IEnumerable 
< 
Cliente "
>" #
Clientes$ ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
} 
} 